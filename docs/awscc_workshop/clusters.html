<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-awscc_workshop/clusters" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">2. From Pairs to Crystals: Many-Body Effects | Peter R. Spackman</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.prs.wiki/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.prs.wiki/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.prs.wiki/docs/awscc_workshop/clusters"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="2. From Pairs to Crystals: Many-Body Effects | Peter R. Spackman"><meta data-rh="true" name="description" content="Moving from isolated pairs to clusters and crystals reveals fundamental challenges in computational chemistry. The total energy is not simply the sum of pairwise interactions. This section explores how to calculate lattice energies using the occ elat command and estimate energies with fast semi-empirical methods like xTB."><meta data-rh="true" property="og:description" content="Moving from isolated pairs to clusters and crystals reveals fundamental challenges in computational chemistry. The total energy is not simply the sum of pairwise interactions. This section explores how to calculate lattice energies using the occ elat command and estimate energies with fast semi-empirical methods like xTB."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.prs.wiki/docs/awscc_workshop/clusters"><link data-rh="true" rel="alternate" href="https://www.prs.wiki/docs/awscc_workshop/clusters" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.prs.wiki/docs/awscc_workshop/clusters" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Intermolecular Interactions Workshop","item":"https://www.prs.wiki/docs/awscc_workshop/"},{"@type":"ListItem","position":2,"name":"2. From Pairs to Crystals: Many-Body Effects","item":"https://www.prs.wiki/docs/awscc_workshop/clusters"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Peter R. Spackman RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Peter R. Spackman Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-W51GMN2E4G"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-W51GMN2E4G",{anonymize_ip:!0})</script>




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.cb8e9b06.css">
<script src="/assets/js/runtime~main.72ad6d57.js" defer="defer"></script>
<script src="/assets/js/main.d176d038.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/prs.png"><link rel="preload" as="image" href="/img/awscc_workshop/pbc.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/prs.png" alt="Peter R. Spackman" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/prs.png" alt="Peter R. Spackman" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/software">software</a><a class="navbar__item navbar__link" href="/publications">papers</a><a class="navbar__item navbar__link" href="/blog">blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">utilities</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/utilities">All Utilities</a></li><li><a class="dropdown__link" href="/utilities/wavefunction-calculator">Wavefunction Calculator</a></li><li><a class="dropdown__link" href="/utilities/xyz-trajectory">XYZ Trajectory Viewer</a></li><li><a class="dropdown__link" href="/utilities/elastic-tensor">Elastic Tensor Analysis</a></li><li><a class="dropdown__link" href="/utilities/smiles-viewer">SMILES Viewer</a></li><li><a class="dropdown__link" href="/utilities/lammps-interface">LAMMPS Interface</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">visualisations</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/bragg">Bragg&#x27;s Law</a></li><li><a class="dropdown__link" href="/qm1d">QM 1D</a></li><li><a class="dropdown__link" href="/qm2d">QM 2D</a></li><li><a class="dropdown__link" href="/spherical-harmonics">Spherical Harmonics</a></li><li><a class="dropdown__link" href="/md">Molecular Dynamics</a></li><li><a class="dropdown__link" href="/crystals">Crystal Structures</a></li><li><a class="dropdown__link" href="/wulff">Wulff Construction 2D</a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/peterspackman" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">github<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://scholar.google.com.au/citations?user=GmSR9oIAAAAJ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">google scholar<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://orcid.org/0000-0002-6532-8571" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">orcid<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/crystals">Crystal Structure Fundamentals</a><button aria-label="Expand sidebar category &#x27;Crystal Structure Fundamentals&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Quantum Chemistry/Density Functional Theory">Quantum Chemistry</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/awscc_workshop">Intermolecular Interactions Workshop</a><button aria-label="Collapse sidebar category &#x27;Intermolecular Interactions Workshop&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/awscc_workshop/setup">0. Setup (10 minutes)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/awscc_workshop/pair-energies">1. Intermolecular Interactions: From Theory to Practice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/awscc_workshop/clusters">2. From Pairs to Crystals: Many-Body Effects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/awscc_workshop/crystal-growth">3. Crystal Growth: Putting It All Together</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/awscc_workshop/ce-1p">Appendix: CE-1p</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/awscc_workshop/cg-theory">Appendix: Crystal Growth Theory and Computational Protocol</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/awscc_workshop"><span>Intermolecular Interactions Workshop</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">2. From Pairs to Crystals: Many-Body Effects</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>2. From Pairs to Crystals: Many-Body Effects</h1></header>
<p>Moving from isolated pairs to clusters and crystals reveals fundamental challenges in computational chemistry. The total energy is not simply the sum of pairwise interactions. This section explores how to calculate lattice energies using the <code>occ elat</code> command and estimate energies with fast semi-empirical methods like xTB.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-many-body-problem">The Many-Body Problem<a href="#the-many-body-problem" class="hash-link" aria-label="Direct link to The Many-Body Problem" title="Direct link to The Many-Body Problem">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-pairs-dont-tell-the-whole-story">Why Pairs Don&#x27;t Tell the Whole Story<a href="#why-pairs-dont-tell-the-whole-story" class="hash-link" aria-label="Direct link to Why Pairs Don&#x27;t Tell the Whole Story" title="Direct link to Why Pairs Don&#x27;t Tell the Whole Story">​</a></h3>
<p>Consider three water molecules A, B, and C. The total interaction energy is:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>A</mi><mi>B</mi><mi>C</mi></mrow></msub><mo>=</mo><msub><mi>E</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mo>+</mo><msub><mi>E</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo>+</mo><msub><mi>E</mi><mrow><mi>B</mi><mi>C</mi></mrow></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><msub><mi>E</mi><mrow><mn>3</mn><mo>−</mo><mi>b</mi><mi>o</mi><mi>d</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E_{ABC} = E_{AB} + E_{AC} + E_{BC} + \Delta E_{3-body}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">BC</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">BC</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></p></div>
<p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>E</mi><mrow><mn>3</mn><mo>−</mo><mi>b</mi><mi>o</mi><mi>d</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta E_{3-body}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> is the non-additive three-body term. This arises from:</p>
<ol>
<li><strong>Polarization effects</strong>: A polarizes B, which affects how B interacts with C</li>
<li><strong>Charge transfer</strong>: Electron density redistributes across all three molecules</li>
<li><strong>Exchange repulsion</strong>: Overlapping electron clouds of all three molecules</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="energy-hierarchy-in-clusters">Energy Hierarchy in Clusters<a href="#energy-hierarchy-in-clusters" class="hash-link" aria-label="Direct link to Energy Hierarchy in Clusters" title="Direct link to Energy Hierarchy in Clusters">​</a></h3>
<p>For a cluster of N molecules, the many-body expansion is:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow></msub><msubsup><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>&lt;</mo><mi>k</mi></mrow></msub><msubsup><mi>E</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow><mrow><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>&lt;</mo><mi>k</mi><mo>&lt;</mo><mi>l</mi></mrow></msub><msubsup><mi>E</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi><mi>l</mi></mrow><mrow><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></msubsup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">E_{total} = \sum_{i&lt;j} E_{ij}^{(2)} + \sum_{i&lt;j&lt;k} E_{ijk}^{(3)} + \sum_{i&lt;j&lt;k&lt;l} E_{ijkl}^{(4)} + ...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.4806em;vertical-align:-0.4358em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">ij</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.4822em;vertical-align:-0.4374em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.3987em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">ijk</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4374em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.4822em;vertical-align:-0.4374em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.3987em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">ijk</span><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">4</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4374em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.1056em"></span><span class="mord">...</span></span></span></span></p></div>
<p>Where:</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">E_{ij}^{(2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4578em;vertical-align:-0.413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">ij</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span></span></span></span> = pairwise interactions (typically 85-95% of total)</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>E</mi><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow><mrow><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">E_{ijk}^{(3)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4822em;vertical-align:-0.4374em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.3987em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">ijk</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4374em"><span></span></span></span></span></span></span></span></span></span> = three-body corrections (5-15%)</li>
<li>Higher terms usually &lt; 1%</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="physical-origins-of-many-body-effects">Physical Origins of Many-Body Effects<a href="#physical-origins-of-many-body-effects" class="hash-link" aria-label="Direct link to Physical Origins of Many-Body Effects" title="Direct link to Physical Origins of Many-Body Effects">​</a></h3>
<p>The breakdown of pairwise additivity occurs because molecular environments are not independent. When molecule A interacts with molecule B, it changes how A can subsequently interact with molecule C. This leads to several physical effects:</p>
<p><strong>1. Cooperative Effects (Negative 3-body terms)</strong></p>
<ul>
<li><strong>Polarization enhancement</strong>: A polarizes B, making B a better hydrogen bond partner for C</li>
<li><strong>Charge transfer cascades</strong>: Electrons flow A→B→C, strengthening all interactions</li>
<li><strong>Common in</strong>: π-stacking, metal coordination, extended conjugated systems</li>
</ul>
<p><strong>2. Anti-cooperative Effects (Positive 3-body terms)</strong></p>
<ul>
<li><strong>Polarization saturation</strong>: A polarizes B, leaving B less able to interact with C</li>
<li><strong>Electrostatic screening</strong>: Charges reorganize to minimize unfavorable interactions</li>
<li><strong>Common in</strong>: Hydrogen bonding networks, ionic solutions</li>
</ul>
<p><strong>3. Mixed Effects</strong></p>
<ul>
<li><strong>Real systems</strong> often show both types depending on geometry and chemical environment</li>
<li><strong>Water clusters</strong> typically show weak anti-cooperativity (~5% of binding)</li>
<li><strong>Overall magnitude</strong> determines whether pairwise models are adequate</li>
</ul>
<p>The key insight is that <strong>many-body effects are not just corrections - they reveal fundamental physics</strong> about how molecular interactions depend on chemical environment.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-crystal-challenge">The Crystal Challenge<a href="#the-crystal-challenge" class="hash-link" aria-label="Direct link to The Crystal Challenge" title="Direct link to The Crystal Challenge">​</a></h3>
<figure class="figure_peCb" style="width:300px;float:right;margin-left:1rem;margin-bottom:1rem;clear:both"><img src="/img/awscc_workshop/pbc.png" alt="Periodic boundary conditions in crystals" style="width:100%;height:auto;display:block"><figcaption class="caption_gnEO">Infinite crystal represented by periodic unit cells</figcaption></figure>
<p>In a crystal, we face additional complexity:</p>
<ol>
<li><strong>Infinite interactions</strong>: Each molecule interacts with infinite neighbors</li>
<li><strong>Long-range electrostatics</strong>: Decay as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">r^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>, requiring special summation techniques</li>
<li><strong>Periodic boundary conditions</strong>: The unit cell represents infinite repetition</li>
</ol>
<p>The lattice energy is:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi>e</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo mathvariant="normal">≠</mo><mi>i</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E_{lattice} = \frac{1}{2} \sum_{i=1}^{N} \sum_{j \neq i}^{\infty} E_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">tt</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ce</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.417em;vertical-align:-0.4358em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></p></div>
<p>The factor of 1/2 avoids double counting. The sum converges because:</p>
<ul>
<li>Electrostatic: Conditionally convergent (depends on summation order)</li>
<li>Dispersion: Converges as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><mrow><mo>−</mo><mn>6</mn></mrow></msup></mrow><annotation encoding="application/x-tex">r^{-6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li>Total molecules within sphere of radius R: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∝</mo><msup><mi>R</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">\propto R^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></li>
<li>Total dispersion energy: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∝</mo><msup><mi>R</mi><mn>3</mn></msup><mo>×</mo><msup><mi>r</mi><mrow><mo>−</mo><mn>6</mn></mrow></msup><mo>=</mo><msup><mi>R</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\propto R^3 \times r^{-6} = R^{-3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mrel">∝</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span> → converges</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="computational-exercises">Computational Exercises<a href="#computational-exercises" class="hash-link" aria-label="Direct link to Computational Exercises" title="Direct link to Computational Exercises">​</a></h2>
<p>The exercises below demonstrate the concepts outlined above using real calculations. We&#x27;ll progress from small clusters (where we can calculate everything exactly) to larger systems (where approximations become necessary) to infinite crystals (where pairwise models excel).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-1-many-body-effects-in-water-trimers">Exercise 1: Many-Body Effects in Water Trimers<a href="#exercise-1-many-body-effects-in-water-trimers" class="hash-link" aria-label="Direct link to Exercise 1: Many-Body Effects in Water Trimers" title="Direct link to Exercise 1: Many-Body Effects in Water Trimers">​</a></h3>
<p>This exercise quantifies the breakdown of pairwise additivity for a realistic water trimer extracted from ice crystal structure. We&#x27;ll calculate all the individual components of the many-body expansion to see how significant three-body effects really are.</p>
<div class="handsOnExample_Ozx4"><div class="header_xRx8"><div class="titleSection_k_XQ"><h3 class="title_M3Yu">Many-Body Effects in Water Trimers<span class="toggleIcon_ILqK expanded_htPj">▼</span></h3><p class="description_QkX2">Calculate three-body contributions to water trimer interaction energy to understand the limitations of pairwise additivity.</p></div><div class="progressSection_zFVW"><div class="progressBar_iGzv"><div class="progressFill_zqkZ" style="width:0%"></div></div><span class="progressText_A2yl">0<!-- -->/<!-- -->6<!-- --> completed</span><button class="resetButton__OuT" title="Reset progress">↻</button></div></div><div class="content_Wem2"><div class="timelineTabs_KrSD"><div class="timelineContainer_j3YK"><button class="timelineTab_PSf_ active_YRSG"><div class="stepCircle_zTU7">1</div><span class="stepLabel__Iy9">Navigate to water trimers directory</span></button><div class="connectionLine_BrSn"></div><button class="timelineTab_PSf_ disabled_ohey" disabled=""><div class="stepCircle_zTU7">2</div><span class="stepLabel__Iy9">Visualize the trimer structure</span></button><div class="connectionLine_BrSn"></div><button class="timelineTab_PSf_ disabled_ohey" disabled=""><div class="stepCircle_zTU7">3</div><span class="stepLabel__Iy9">Run trimer calculation</span></button><div class="connectionLine_BrSn"></div><button class="timelineTab_PSf_ disabled_ohey" disabled=""><div class="stepCircle_zTU7">4</div><span class="stepLabel__Iy9">Run trimer calculation with wb97x/def2-tzvpp</span></button><div class="connectionLine_BrSn"></div><button class="timelineTab_PSf_ disabled_ohey" disabled=""><div class="stepCircle_zTU7">5</div><span class="stepLabel__Iy9">Understand pairwise contributions</span></button><div class="connectionLine_BrSn"></div><button class="timelineTab_PSf_ disabled_ohey" disabled=""><div class="stepCircle_zTU7">6</div><span class="stepLabel__Iy9">Implications for simulations</span></button></div></div><div class="stepContent_oO1R"><div class="stepPanel_dvOp"><div class="stepHeader_YWI1"><h4 class="stepTitle_hvps">Step <!-- -->1<!-- -->: <!-- -->Navigate to water trimers directory</h4></div><div class="stepSections_GPbU"><div class="section__bYy"><div class="alert alert--secondary"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Instructions</h4><p>Navigate to the water trimers directory and examine the molecular structures extracted from ice crystal.</p></div></div><div class="section__bYy"><div class="alert alert--warning"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Commands</h4><pre><code>cd awscc_workshop_2025/02_pairwise_sums/water_trimers/
ls -la *.xyz
echo &quot;---&quot;
echo &quot;Number of atoms in each file:&quot;
wc -l *.xyz | grep -v total</code></pre></div></div><div class="section__bYy"><div class="alert alert--success"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Expected Output</h4><pre><code>A.xyz  B.xyz  C.xyz  AB.xyz  AC.xyz  BC.xyz  ABC.xyz
---
Number of atoms in each file:
 3 A.xyz
 3 B.xyz  
 3 C.xyz
 6 AB.xyz
 6 AC.xyz
 6 BC.xyz
 9 ABC.xyz</code></pre></div></div><div class="section__bYy"><div class="alert alert--info"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Notes</h4><p>We have 3 monomers (A, B, C), 3 dimers (AB, AC, BC), and 1 trimer (ABC) from ice structure.</p></div></div></div><div class="stepNavigation_pIT2"><button class="navButton_XL1R" disabled="">← Previous</button><button class="navButton_XL1R nextButton_UMBu">Next →</button></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-2-convergence-of-interaction-energy-with-cluster-size">Exercise 2: Convergence of Interaction Energy with Cluster Size<a href="#exercise-2-convergence-of-interaction-energy-with-cluster-size" class="hash-link" aria-label="Direct link to Exercise 2: Convergence of Interaction Energy with Cluster Size" title="Direct link to Exercise 2: Convergence of Interaction Energy with Cluster Size">​</a></h3>
<p>Moving from trimers to larger clusters, we need to understand how interaction energies converge with system size. This is crucial for simulation cutoffs and for understanding when finite cluster calculations approximate bulk behavior. We&#x27;ll use fast semi-empirical xTB calculations to study clusters with dozens of molecules.</p>
<div class="handsOnExample_Ozx4"><div class="header_xRx8"><div class="titleSection_k_XQ"><h3 class="title_M3Yu">Ice Cluster Convergence Study<span class="toggleIcon_ILqK expanded_htPj">▼</span></h3><p class="description_QkX2">Calculate interaction energies for ice clusters with 4 and 8 neighbor shells to understand the range of intermolecular interactions.</p></div><div class="progressSection_zFVW"><div class="progressBar_iGzv"><div class="progressFill_zqkZ" style="width:0%"></div></div><span class="progressText_A2yl">0<!-- -->/<!-- -->2<!-- --> completed</span><button class="resetButton__OuT" title="Reset progress">↻</button></div></div><div class="content_Wem2"><div class="timelineTabs_KrSD"><div class="timelineContainer_j3YK"><button class="timelineTab_PSf_ active_YRSG"><div class="stepCircle_zTU7">1</div><span class="stepLabel__Iy9">Navigate to ice clusters directory</span></button><div class="connectionLine_BrSn"></div><button class="timelineTab_PSf_ disabled_ohey" disabled=""><div class="stepCircle_zTU7">2</div><span class="stepLabel__Iy9">Run cluster calculations</span></button></div></div><div class="stepContent_oO1R"><div class="stepPanel_dvOp"><div class="stepHeader_YWI1"><h4 class="stepTitle_hvps">Step <!-- -->1<!-- -->: <!-- -->Navigate to ice clusters directory</h4></div><div class="stepSections_GPbU"><div class="section__bYy"><div class="alert alert--secondary"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Instructions</h4><p>Navigate to the ice clusters directory and examine the pre-built cluster structures from ice crystal.</p></div></div><div class="section__bYy"><div class="alert alert--warning"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Commands</h4><pre><code>cd ../ice_clusters/
ls -la *.xyz
echo &quot;---&quot;
echo &quot;Number of water molecules in each file:&quot;
for f in *.xyz; do echo &quot;$f: $(head -1 $f) molecules&quot;; done</code></pre></div></div><div class="section__bYy"><div class="alert alert--success"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Expected Output</h4><pre><code>ice_central_molecule.xyz  ice_cluster_4.xyz  ice_cluster_8.xyz  
ice_neighbors_4.xyz  ice_neighbors_8.xyz  ice_cluster_12.xyz  ice_cluster_16.xyz
---
Number of water molecules in each file:
ice_central_molecule.xyz: 3 molecules
ice_cluster_4.xyz: 15 molecules  
ice_cluster_8.xyz: 27 molecules
ice_neighbors_4.xyz: 12 molecules
ice_neighbors_8.xyz: 24 molecules
ice_cluster_12.xyz: 45 molecules
ice_cluster_16.xyz: 65 molecules</code></pre></div></div><div class="section__bYy"><div class="alert alert--info"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Notes</h4><p>Clusters are built with a central molecule plus neighbor shells. E_interaction = E_cluster - E_central - E_neighbors.</p></div></div></div><div class="stepNavigation_pIT2"><button class="navButton_XL1R" disabled="">← Previous</button><button class="navButton_XL1R nextButton_UMBu">Next →</button></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-energy-units-in-crystals">Understanding Energy Units in Crystals<a href="#understanding-energy-units-in-crystals" class="hash-link" aria-label="Direct link to Understanding Energy Units in Crystals" title="Direct link to Understanding Energy Units in Crystals">​</a></h2>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Critical Concept</div><div class="admonitionContent_BuS1"><p>Always specify what your energy is <strong>per unit of</strong>. This is one of the most common sources of error in computational crystal studies!</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="different-ways-to-report-crystal-energies">Different Ways to Report Crystal Energies<a href="#different-ways-to-report-crystal-energies" class="hash-link" aria-label="Direct link to Different Ways to Report Crystal Energies" title="Direct link to Different Ways to Report Crystal Energies">​</a></h3>
<ul>
<li><strong>Per molecule</strong>: Energy to remove one molecule from crystal</li>
<li><strong>Per unit cell</strong>: Energy for the entire repeating unit</li>
<li><strong>Per asymmetric unit</strong>: Energy for symmetry-unique part</li>
<li><strong>Per formula unit</strong>: Energy for the simplest stoichiometric unit</li>
<li><strong>Per atom</strong>: Often used in benchmarking studies for fair comparison</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-mistakes-and-how-to-avoid-them">Common Mistakes and How to Avoid Them<a href="#common-mistakes-and-how-to-avoid-them" class="hash-link" aria-label="Direct link to Common Mistakes and How to Avoid Them" title="Direct link to Common Mistakes and How to Avoid Them">​</a></h3>
<p><strong>Example 1: Ice vs. Salt</strong></p>
<ul>
<li>Ice: H₂O → 1 molecule per formula unit</li>
<li>NaCl: Na⁺ + Cl⁻ → 2 ions per formula unit</li>
<li>Comparing &quot;-800 kJ/mol&quot; for NaCl vs &quot;-63 kJ/mol&quot; for ice is meaningless!</li>
<li>Must compare: NaCl (-400 kJ/mol per ion) vs H₂O (-63 kJ/mol per molecule)</li>
</ul>
<p><strong>Example 2: Co-crystals and Solvates</strong></p>
<ul>
<li>Paracetamol monohydrate: (C₈H₉NO₂)·(H₂O) → 2 molecules per formula unit</li>
<li>Pure paracetamol: C₈H₉NO₂ → 1 molecule per formula unit</li>
<li>To compare stability, normalize per paracetamol molecule, not per formula unit</li>
</ul>
<p><strong>Example 3: Polymorphs</strong></p>
<ul>
<li>Form I: 2 molecules in asymmetric unit → divide by 2 for per-molecule energy</li>
<li>Form II: 4 molecules in asymmetric unit → divide by 4 for per-molecule energy</li>
<li>Only then can you compare which polymorph is more stable</li>
</ul>
<p>For ice example:</p>
<ul>
<li>Asymmetric unit energy: -125.6 kJ/mol (contains 2 H₂O)</li>
<li>Per formula unit (H₂O): <strong>-62.8 kJ/mol per molecule</strong></li>
<li>Experimental sublimation: <strong>+54.1 kJ/mol per molecule</strong> (opposite sign)</li>
</ul>
<p><strong>Why benchmarking studies use &quot;per atom&quot; units:</strong>
Many computational method comparisons report errors in <strong>meV/atom</strong> rather than per unit cell or per molecule. This allows fair comparison across:</p>
<ul>
<li>Small molecules (few atoms) vs. large molecules (many atoms)</li>
<li>Different crystal packing (1 vs. 8 molecules per unit cell)</li>
<li>Various stoichiometries (AB vs. A₂B₃ compounds)</li>
</ul>
<p>For example, a state-of-the-art method like <a href="https://arxiv.org/pdf/2503.14118" target="_blank" rel="noopener noreferrer">PET-MAD</a> achieves ~20 meV/atom error:</p>
<ul>
<li>H₂O (3 atoms): 60 meV = 5.8 kJ/mol of water molecules</li>
<li>Paracetamol (20 atoms): 400 meV = 38.6 kJ/mol of paracetamol molecules</li>
</ul>
<p>For the most accurate bespoke dataset, errors can be as low as 3 meV/atom:</p>
<ul>
<li>H₂O (3 atoms): 9 meV = 0.9 kJ/mol of water molecules</li>
<li>Paracetamol (20 atoms): 60 meV = 5.8 kJ/mol of paracetamol molecules</li>
<li>Both represent the same <strong>relative accuracy per atom</strong></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-experiments-sublimation-thermodynamics">Connecting to Experiments: Sublimation Thermodynamics<a href="#connecting-to-experiments-sublimation-thermodynamics" class="hash-link" aria-label="Direct link to Connecting to Experiments: Sublimation Thermodynamics" title="Direct link to Connecting to Experiments: Sublimation Thermodynamics">​</a></h2>
<p>For molecular crystals, the experimental sublimation enthalpy relates to our calculated lattice energy:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>H</mi><mrow><mi>s</mi><mi>u</mi><mi>b</mi></mrow></msub><mo>=</mo><mo>−</mo><msub><mi>E</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi>e</mi></mrow></msub><mo>+</mo><mn>2</mn><mi>R</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">\Delta H_{sub} = -E_{lattice} + 2RT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">tt</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ce</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.13889em">RT</span></span></span></span></p></div>
<p>The 2RT term (~5 kJ/mol at 298K) accounts for the difference between constrained vibrations in the crystal and free translation/rotation in the gas phase. For ice:</p>
<ul>
<li>Calculated <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>l</mi><mi>a</mi><mi>t</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E_{lattice}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">tt</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ce</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> = -62.8 kJ/mol</li>
<li>Predicted <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>H</mi><mrow><mi>s</mi><mi>u</mi><mi>b</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta H_{sub}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> = 62.8 - 4.96 = 57.8 kJ/mol</li>
<li>Experimental = 54.1 kJ/mol (7% error)</li>
</ul>
<p>This excellent agreement validates the CE-1p approach for molecular crystals.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-3-lattice-energy-and-crystal-cohesion">Exercise 3: Lattice Energy and Crystal Cohesion<a href="#exercise-3-lattice-energy-and-crystal-cohesion" class="hash-link" aria-label="Direct link to Exercise 3: Lattice Energy and Crystal Cohesion" title="Direct link to Exercise 3: Lattice Energy and Crystal Cohesion">​</a></h3>
<p>Finally, we tackle crystals using the CE-1P pairwise summation approach. This exercise demonstrates how pairwise models can work surprisingly well for molecular crystals, despite the many-body effects we&#x27;ve just studied. The key insight is that while individual three-body terms matter, their collective effect in crystals may well cancel and is often well-approximated by pairwise models.</p>
<div class="handsOnExample_Ozx4"><div class="header_xRx8"><div class="titleSection_k_XQ"><h3 class="title_M3Yu">Ice Lattice Energy Calculation<span class="toggleIcon_ILqK expanded_htPj">▼</span></h3><p class="description_QkX2">Calculate the lattice energy of ice Ih crystal using pairwise CE-1P interactions to understand crystal cohesion and predict sublimation enthalpy.</p></div><div class="progressSection_zFVW"><div class="progressBar_iGzv"><div class="progressFill_zqkZ" style="width:0%"></div></div><span class="progressText_A2yl">0<!-- -->/<!-- -->2<!-- --> completed</span><button class="resetButton__OuT" title="Reset progress">↻</button></div></div><div class="content_Wem2"><div class="timelineTabs_KrSD"><div class="timelineContainer_j3YK"><button class="timelineTab_PSf_ active_YRSG"><div class="stepCircle_zTU7">1</div><span class="stepLabel__Iy9">Navigate to ice lattice energy directory</span></button><div class="connectionLine_BrSn"></div><button class="timelineTab_PSf_ disabled_ohey" disabled=""><div class="stepCircle_zTU7">2</div><span class="stepLabel__Iy9">Run lattice energy calculation</span></button></div></div><div class="stepContent_oO1R"><div class="stepPanel_dvOp"><div class="stepHeader_YWI1"><h4 class="stepTitle_hvps">Step <!-- -->1<!-- -->: <!-- -->Navigate to ice lattice energy directory</h4></div><div class="stepSections_GPbU"><div class="section__bYy"><div class="alert alert--secondary"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Instructions</h4><p>Navigate to the ice_elat directory containing the crystal structure file and examine the setup.</p></div></div><div class="section__bYy"><div class="alert alert--warning"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Commands</h4><pre><code>cd ../ice_elat/
ls -la
head -20 ice.cif&quot;</code></pre></div></div><div class="section__bYy"><div class="alert alert--success"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Expected Output</h4><pre><code>ice.cif run_ice_elat.sh  example_ice_stdout

data_H2O
_symmetry_space_group_name_H-M   P6_3cm
_cell_length_a   7.60356630
_cell_length_b   7.60356630
_cell_length_c   7.14296200
_cell_angle_alpha   90.00000000
_cell_angle_beta   90.00000000
_cell_angle_gamma   120.00000000
_symmetry_Int_Tables_number   185
_chemical_formula_structural   H2O
_chemical_formula_sum   &#x27;H24 O12&#x27;
_cell_volume   357.63798996</code></pre></div></div><div class="section__bYy"><div class="alert alert--info"><h4 style="text-transform:uppercase;letter-spacing:0.5px;font-size:0.9rem;font-weight:700;margin:0 0 0.75rem 0">Notes</h4><p>Ice Ih has hexagonal symmetry (space group P6_3cm) with a ≈ 7.6 Å and c ≈ 7.14 Å.</p></div></div></div><div class="stepNavigation_pIT2"><button class="navButton_XL1R" disabled="">← Previous</button><button class="navButton_XL1R nextButton_UMBu">Next →</button></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-theory-to-practice-what-weve-learned">Connecting Theory to Practice: What We&#x27;ve Learned<a href="#connecting-theory-to-practice-what-weve-learned" class="hash-link" aria-label="Direct link to Connecting Theory to Practice: What We&#x27;ve Learned" title="Direct link to Connecting Theory to Practice: What We&#x27;ve Learned">​</a></h2>
<p>The three exercises above demonstrate key principles of many-body interactions and crystal energetics:</p>
<p><strong>From Exercise 1 (Water Trimers):</strong></p>
<ul>
<li>Many-body effects are real but modest (~5%) for hydrogen-bonded systems, trimers, quatermers etc. are still probably not representative of a bulk...</li>
<li>Individual three-body terms can be calculated exactly for small systems</li>
</ul>
<p><strong>From Exercise 2 (Cluster Convergence):</strong></p>
<ul>
<li>Simulation cutoffs represent accuracy vs. cost tradeoffs</li>
<li>Different properties (energies vs. forces vs. phase behavior) may require different cutoffs</li>
</ul>
<p><strong>From Exercise 3 (Crystal Lattice Energies):</strong></p>
<ul>
<li>Pairwise models can work remarkably well (~7% error) for molecular crystals</li>
<li>This success occurs despite measurable many-body effects in small clusters</li>
</ul>
<p>How can pairwise models work so well for crystals when we just showed many-body effects are important? The answer lies in <strong>error cancellation</strong>, and the nature of crystals vs. trimers:</p>
<ol>
<li><strong>Many-body effects may cancel</strong> - e.g. while the net polarisation of a molecule from 3 molecules might be very different than 2, it may be that for a full crystal these largely cancel... so:</li>
<li><strong>Collective effects average out</strong> - individual cooperative/anti-cooperative terms partially cancel</li>
</ol>
<p>This is why <strong>understanding fundamentals matters</strong> - it helps you recognize when approximations will work and when they&#x27;ll fail. More importantly, testing and benchmarking accuracy is fundamental to understanding the success and potential failures of different models!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-ce-1p-model-for-crystals">The CE-1p Model for Crystals<a href="#the-ce-1p-model-for-crystals" class="hash-link" aria-label="Direct link to The CE-1p Model for Crystals" title="Direct link to The CE-1p Model for Crystals">​</a></h2>
<p>The CE-1p model extends naturally from dimers to crystals by summing pairwise interactions. It captures the essential physics while remaining computationally efficient:</p>
<ul>
<li><strong>Input</strong>: Crystal structure + monomer wavefunctions</li>
<li><strong>Output</strong>: Lattice energy with physical decomposition</li>
<li><strong>Speed</strong>: much much cheaper computationally than e.g. full periodic DFT</li>
<li><strong>Accuracy</strong>: MAD of 3.3 kJ/mol error for molecular crystals (X23 set)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="practical-considerations-and-challenges">Practical Considerations and Challenges<a href="#practical-considerations-and-challenges" class="hash-link" aria-label="Direct link to Practical Considerations and Challenges" title="Direct link to Practical Considerations and Challenges">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="convergence-issues-with-ionic-crystals">Convergence Issues with Ionic Crystals<a href="#convergence-issues-with-ionic-crystals" class="hash-link" aria-label="Direct link to Convergence Issues with Ionic Crystals" title="Direct link to Convergence Issues with Ionic Crystals">​</a></h3>
<p>The NaCl example demonstrates why simple cutoff-based summation fails for ionic systems. The long-range <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">r^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> electrostatics lead to:</p>
<ul>
<li>Wild energy oscillations with cutoff radius</li>
<li>Dependence on summation order</li>
<li>Need for Ewald summation or similar techniques</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="polymorphism-when-small-differences-matter">Polymorphism: When Small Differences Matter<a href="#polymorphism-when-small-differences-matter" class="hash-link" aria-label="Direct link to Polymorphism: When Small Differences Matter" title="Direct link to Polymorphism: When Small Differences Matter">​</a></h3>
<p>Many pharmaceutical compounds have multiple crystal forms (polymorphs) with energy differences &lt; 5 kJ/mol. Since RT ≈ 2.5 kJ/mol at room temperature, thermal effects can reverse stability rankings. This is why:</p>
<ul>
<li>Temperature-dependent studies are crucial, and vibrational enthalpy contributions are important.</li>
<li>Actual growth conditions (nucleation), kinetic factors often control which form crystallizes</li>
<li>Computational predictions need ~1 kJ/mol accuracy</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="visualizing-crystal-energetics">Visualizing Crystal Energetics<a href="#visualizing-crystal-energetics" class="hash-link" aria-label="Direct link to Visualizing Crystal Energetics" title="Direct link to Visualizing Crystal Energetics">​</a></h3>
<p>Tools like CrystalExplorer can generate &quot;energy frameworks&quot; - 3D visualizations where tube thickness represents interaction strength. This reveals:</p>
<ul>
<li>Hydrogen bonding networks</li>
<li>π-π stacking columns</li>
<li>Mechanical anisotropy origins</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-takeaways">Key Takeaways<a href="#key-takeaways" class="hash-link" aria-label="Direct link to Key Takeaways" title="Direct link to Key Takeaways">​</a></h2>
<p>✓ <strong>Energy units matter</strong> - always specify per molecule, per formula unit, or per atom</p>
<p>✓ <strong>Pairwise models can work surprisingly well</strong> - CE-1p achieves ~10% accuracy by smart parameterization</p>
<p>✓ <strong>Convergence differs by system</strong> - molecular crystals converge smoothly, ionic crystals oscillate wildly</p>
<p>✓ <strong>Small energy differences</strong> have big consequences - polymorphs often differ by &lt; RT</p>
<p>✓ <strong>Connect to experiment</strong> through proper thermodynamics - don&#x27;t forget the 2RT term!</p>
<p>Ready to see how crystals actually grow? Let&#x27;s explore nucleation and growth mechanisms!</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/awscc_workshop/pair-energies"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">1. Intermolecular Interactions: From Theory to Practice</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/awscc_workshop/crystal-growth"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3. Crystal Growth: Putting It All Together</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-many-body-problem" class="table-of-contents__link toc-highlight">The Many-Body Problem</a><ul><li><a href="#why-pairs-dont-tell-the-whole-story" class="table-of-contents__link toc-highlight">Why Pairs Don&#39;t Tell the Whole Story</a></li><li><a href="#energy-hierarchy-in-clusters" class="table-of-contents__link toc-highlight">Energy Hierarchy in Clusters</a></li><li><a href="#physical-origins-of-many-body-effects" class="table-of-contents__link toc-highlight">Physical Origins of Many-Body Effects</a></li><li><a href="#the-crystal-challenge" class="table-of-contents__link toc-highlight">The Crystal Challenge</a></li></ul></li><li><a href="#computational-exercises" class="table-of-contents__link toc-highlight">Computational Exercises</a><ul><li><a href="#exercise-1-many-body-effects-in-water-trimers" class="table-of-contents__link toc-highlight">Exercise 1: Many-Body Effects in Water Trimers</a></li><li><a href="#exercise-2-convergence-of-interaction-energy-with-cluster-size" class="table-of-contents__link toc-highlight">Exercise 2: Convergence of Interaction Energy with Cluster Size</a></li></ul></li><li><a href="#understanding-energy-units-in-crystals" class="table-of-contents__link toc-highlight">Understanding Energy Units in Crystals</a><ul><li><a href="#different-ways-to-report-crystal-energies" class="table-of-contents__link toc-highlight">Different Ways to Report Crystal Energies</a></li><li><a href="#common-mistakes-and-how-to-avoid-them" class="table-of-contents__link toc-highlight">Common Mistakes and How to Avoid Them</a></li></ul></li><li><a href="#connecting-to-experiments-sublimation-thermodynamics" class="table-of-contents__link toc-highlight">Connecting to Experiments: Sublimation Thermodynamics</a><ul><li><a href="#exercise-3-lattice-energy-and-crystal-cohesion" class="table-of-contents__link toc-highlight">Exercise 3: Lattice Energy and Crystal Cohesion</a></li></ul></li><li><a href="#connecting-theory-to-practice-what-weve-learned" class="table-of-contents__link toc-highlight">Connecting Theory to Practice: What We&#39;ve Learned</a></li><li><a href="#the-ce-1p-model-for-crystals" class="table-of-contents__link toc-highlight">The CE-1p Model for Crystals</a></li><li><a href="#practical-considerations-and-challenges" class="table-of-contents__link toc-highlight">Practical Considerations and Challenges</a><ul><li><a href="#convergence-issues-with-ionic-crystals" class="table-of-contents__link toc-highlight">Convergence Issues with Ionic Crystals</a></li><li><a href="#polymorphism-when-small-differences-matter" class="table-of-contents__link toc-highlight">Polymorphism: When Small Differences Matter</a></li><li><a href="#visualizing-crystal-energetics" class="table-of-contents__link toc-highlight">Visualizing Crystal Energetics</a></li></ul></li><li><a href="#key-takeaways" class="table-of-contents__link toc-highlight">Key Takeaways</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Software</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://crystalexplorer.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">crystalexplorer</a></li><li class="footer__item"><a href="https://github.com/peterspackman/chmpy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">chmpy</a></li><li class="footer__item"><a href="https://github.com/peterspackman/occ" target="_blank" rel="noopener noreferrer" class="footer__link-item">occ</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://bsky.app/profile/crystalexplorer.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">bluesky<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/peterspackman" target="_blank" rel="noopener noreferrer" class="footer__link-item">github<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">blog</a></li><li class="footer__item"><a href="https://scholar.google.com.au/citations?user=GmSR9oIAAAAJ" target="_blank" rel="noopener noreferrer" class="footer__link-item">google scholar<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://orcid.org/0000-0002-6532-8571" target="_blank" rel="noopener noreferrer" class="footer__link-item">orcid<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://publons.com/researcher/AAA-2424-2020/" target="_blank" rel="noopener noreferrer" class="footer__link-item">publons<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Peter R. Spackman</div></div></div></footer></div>
</body>
</html>