---
sidebar_position: 4
---

import Figure from '@site/src/components/Figure';
import { Tutorial, Step, Instructions, Commands, Output, Notes } from '@site/src/components/HandsOnExample';

# 3. Crystal Growth: Putting It All Together

<Figure 
  src="/img/awscc_workshop/growth.png" 
  alt="Crystal growth mechanisms showing terrace-step-kink model" 
  caption="Terrace-step-kink model of crystal growth showing molecular attachment sites"
  width="50%"
  float="right"
/>

How do molecules assemble into crystals? This final section combines our understanding of intermolecular interactions and crystal energetics to predict how crystals grow, what shapes they form, and how solvents affect the process.

## From Molecules to Crystals: The Growth Process

Crystal growth involves several key steps, each governed by the intermolecular interactions we've studied:

1. **Nucleation**: Small molecular clusters form in solution - governed by dimer and trimer energies
2. **Attachment**: New molecules join crystal surfaces - attachment energy determines growth rate
3. **Surface integration**: Molecules find stable positions - surface energy controls final morphology
4. **Solvent competition**: Solvent molecules compete with crystal attachment - affects both growth rate and shape

The key insight is that **slow-growing faces dominate the final crystal morphology** because fast-growing faces quickly disappear. This is why attachment energies (how strongly molecules stick to different faces) directly determine crystal shape.

## Computational Exercises

We'll use paracetamol (acetaminophen) to demonstrate how our understanding of intermolecular interactions predicts crystal growth behavior.

### Exercise 1: Solvation Free Energy Calculations

Understanding how molecules interact with solvents is crucial for predicting solubility and crystal growth behavior. We'll calculate the solvation free energy of paracetamol in water using the SMD (Solvation Model based on Density) approach.

<Tutorial
  title="SMD Solvation Energy Calculation"
  description="Calculate the solvation free energy of paracetamol in water to understand solvent stabilization effects and their impact on drug solubility."
>
  <Step id="setup" title="Navigate to the SMD directory">
    <Instructions>
      <p>Navigate to the directory containing the prepared input files for gas-phase and solvated calculations.</p>
    </Instructions>
    
    <Commands>
      <pre><code>{`cd awscc_workshop_2025/03_crystal_growth/SMD/
ls -la
head -4 gas.inp smd.inp`}</code></pre>
    </Commands>
    
    <Output>
      <pre><code>{`gas.inp  smd.inp  paracetamol.xyz  run_smd.sh

==> gas.inp <==
! wB97M-V DEF2-SVP

* XYZFILE 0 1 paracetamol.xyz

==> smd.inp <==
! wB97M-V DEF2-SVP SMD(WATER)

* XYZFILE 0 1 paracetamol.xyz`}</code></pre>
    </Output>
    
    <Notes>
      <p>The only difference is SMD(WATER) in the solvated calculation input file. Note that the smd input file will be modified/regenerated by the script when run. </p>
    </Notes>
  </Step>

  <Step id="examine_molecule" title="Examine paracetamol structure">
    <Instructions>
      <p>Look at the paracetamol structure to understand its solvation properties.</p>
    </Instructions>
    
    <Commands>
      <pre><code>{`head -10 paracetamol.xyz`}</code></pre>
    </Commands>
    
    <Output>
      <pre><code>{`20
Paracetamol
C          1.84845        1.22940       -0.22252
C          0.66746        1.96704       -0.22252
C         -0.56848        1.32336       -0.22252
C         -0.62473       -0.06341       -0.22252
C          0.55625       -0.80105       -0.22252
C          1.79220       -0.15737       -0.22252
N          3.01319       -0.89501       -0.22252
C          4.21972       -0.30839       -0.22252
O          5.34071       -0.77603       -0.22252`}</code></pre>
    </Output>
    
    <Notes>
      <p>Paracetamol's mixed hydrophilic/hydrophobic character makes solvation modeling interesting.</p>
      <p>Paracetamol features relevant to solvation:</p>
      <ul>
        <li>Hydroxyl (-OH) group: hydrogen bond donor</li>
        <li>Amide (C=O, N-H): hydrogen bond acceptor/donor</li>
        <li>Benzene ring: hydrophobic, π-electron interactions</li>
        <li>Overall: amphiphilic (both hydrophilic and hydrophobic regions)</li>
      </ul>
    </Notes>
  </Step>

  <Step id="run_calculation" title="Run SMD solvation calculation">
    <Instructions>
      <p>Execute the script that calculates both gas-phase and solvated energies automatically.</p>
    </Instructions>
    
    <Commands>
      <pre><code>./run_smd.sh --method wb97m-v --basis def2-svp --threads 4</code></pre>
    </Commands>
    
    <Output>
      <pre><code>{`=========================================
SOLVATION FREE ENERGY ANALYSIS
=========================================

Total energies:
  Gas phase:      -515.075281 hartree
  Solution phase: -515.096639 hartree

Solvation free energy:
  ΔG_solv = -0.021358 hartree = -56.07 kJ/mol

Solubility analysis:
  Experimental solubility of paracetamol in water: ~15 g/L at 25°C

  Note: ΔG_solv relates to solubility through:
  log S = (ΔG_fusion - ΔG_solv) / (2.303 RT)

  A 5.7 kJ/mol error in ΔG corresponds to ~1 order of magnitude in solubility

  At 298K: RT = 2.48 kJ/mol
  For accurate solubility: need ΔG_fusion from crystal structure`}</code></pre>
    </Output>
    
    <Notes>
      <p>The negative ΔG_solv (-56.1 kJ/mol) indicates favorable solvation in water. But this is definitely not enough info to determine solubility!</p>
    </Notes>
  </Step>

  <Step id="different_solvents" title="Try different solvents">
    <Instructions>
      <p>Compare solvation free energyin different solvents to understand selectivity.</p>
    </Instructions>
    
    <Commands>
      <pre><code>{`# Try ethanol instead of water
./run_smd.sh --solvent ethanol --threads 4`}</code></pre>
    </Commands>
    
    <Notes>
      <p>More polar solvents generally solvate paracetamol better due to hydrogen bonding capability. But it should still be soluble in e.g. toluene</p>
    </Notes>
  </Step>
</Tutorial>

### Exercise 2: Crystal Growth and Morphology Prediction

Crystal morphology - the external shape of crystals - determines properties like dissolution rate, flowability, and bioavailability. We'll predict paracetamol crystal morphology using surface energy calculations and examine how solvents affect crystal growth.

<Tutorial
  title="Crystal Growth Morphology Prediction"
  description="Calculate surface energies for different crystal faces of paracetamol to predict crystal morphology and understand solvent effects on crystal growth."
>
  <Step id="setup" title="Navigate to crystal growth directory">
    <Instructions>
      <p>Navigate to the CG directory containing the crystal structure and examine the setup for morphology calculations.</p>
    </Instructions>
    
    <Commands>
      <pre><code>{`cd ../CG/
ls -la
head -20 paracetamol.cif`}</code></pre>
    </Commands>
    
    <Output>
      <pre><code>{`paracetamol.cif  paracetamol_dimers/  run_paracetamol_cg.sh

data_paracetamol
_chemical_name_common            Acetaminophen
_chemical_formula_moiety         'C8 H9 N1 O2'
_chemical_name_systematic        N-(4-Hydroxyphenyl)acetamide
_chemical_properties_biological  'antiinflammatory agent'
_diffrn_ambient_temperature      295
_exptl_crystal_density_diffrn    1.293
#These two values have been output from a single CSD field.
_refine_ls_R_factor_gt           0.072
_refine_ls_wR_factor_gt          0.072
_diffrn_radiation_probe          x-ray
_symmetry_cell_setting           monoclinic
_symmetry_space_group_name_H-M   'P 21/a'
_symmetry_Int_Tables_number      14
_space_group_name_Hall           '-P 2yab'
loop_
_symmetry_equiv_pos_site_id
_symmetry_equiv_pos_as_xyz
1 x,y,z
2 1/2-x,1/2+y,-z`}</code></pre>
    </Output>
    
    <Notes>
      <p>Paracetamol Form I has monoclinic symmetry (P21/a) with different a, b, and c dimensions.</p>
    </Notes>
  </Step>

  <Step id="run_cg_calculation" title="Run crystal growth calculation">
    <Instructions>
      <p>Run the crystal growth calculation which computes both vacuum and solvated surface energies in a single calculation.</p>
    </Instructions>
    
    <Commands>
      <pre><code>./run_paracetamol_cg.sh --solvent water --surface-energies 10 --threads 4</code></pre>
    </Commands>
    
    <Output>
      <pre><code>{`Running OCC paracetamol crystal growth calculation
  Model: ce-1p
  Solvent: water
  Radius: 4.1 Å
  CG Radius: 4.1 Å  
  Surface energies: 10
  Threads: 4

[... DFT calculations for gas and solution phases ...]

Free energy estimates at T = 298 K, P = 1 atm., units: kJ/mol
-------------------------------------------------------
lattice energy (crystal)              -124.260  (E_lat)
rotational free energy (molecule)      -32.477  (E_rot)
translational free energy (molecule)   -44.893  (E_trans)
solvation free energy (molecule)       -46.458  (E_solv)
dH sublimation                         119.304
dS sublimation                         -77.370
dG sublimation                          41.935
dG solution                             -4.523
equilibrium_constant                  6.21e+00
log S                                    0.793
solubility (g/L)                      9.38e+02

Crystal surface energies (solvated)
(1 0 0) spacing = 0.086 area = 66.740
(1 0 0) cut =  0.250, energy =  0.080976
(0 1 0) spacing = 0.106 area = 82.582
(0 1 0) cut =  0.250, energy =  0.095165
(1 1 0) spacing = 0.137 area = 106.179
(1 1 0) cut =  0.000, energy =  0.081307
(1 -1 0) spacing = 0.137 area = 106.179
(1 -1 0) cut =  0.000, energy =  0.081307
(0 0 1) spacing = 0.157 area = 121.542
(0 0 1) cut =  0.500, energy =  0.084410
(2 0 -1) spacing = 0.175 area = 135.707
(2 0 -1) cut =  0.500, energy =  0.052657
(0 1 1) spacing = 0.189 area = 146.943
(0 1 1) cut =  0.500, energy =  0.087449
(0 1 -1) spacing = 0.189 area = 146.943
(0 1 -1) cut =  0.000, energy =  0.087449
(2 1 0) spacing = 0.202 area = 156.961
(2 1 0) cut =  0.500, energy =  0.083637
(2 -1 0) spacing = 0.202 area = 156.961
(2 -1 0) cut =  0.000, energy =  0.083637

Crystal surface energies (vacuum)
(1 0 0) spacing = 0.086 area = 66.740
(1 0 0) cut =  0.250, energy =  0.203286
(0 1 0) spacing = 0.106 area = 82.582
(0 1 0) cut =  0.000, energy =  0.115813
(1 1 0) spacing = 0.137 area = 106.179
(1 1 0) cut =  0.000, energy =  0.153162
(1 -1 0) spacing = 0.137 area = 106.179
(1 -1 0) cut =  0.000, energy =  0.153162
(0 0 1) spacing = 0.157 area = 121.542
(0 0 1) cut =  0.500, energy =  0.187041
(2 0 -1) spacing = 0.175 area = 135.707
(2 0 -1) cut =  0.500, energy =  0.118593
(0 1 1) spacing = 0.189 area = 146.943
(0 1 1) cut =  0.500, energy =  0.158809
(0 1 -1) spacing = 0.189 area = 146.943
(0 1 -1) cut =  0.000, energy =  0.158809
(2 1 0) spacing = 0.202 area = 156.961
(2 1 0) cut =  0.500, energy =  0.189482
(2 -1 0) spacing = 0.202 area = 156.961
(2 -1 0) cut =  0.000, energy =  0.189482`}</code></pre>
    </Output>
    
    <Notes>
      <p>OCC calculates both vacuum and solvated surface energies in one run. The calculation also provides thermodynamic properties including solvation free energy (-46.5 kJ/mol) and predicted solubility (938 g/L). The predicted solubility significantly exceeds the experimental value (~15 g/L) as this simplified model focuses on surface energetics without accounting for the complex equilibrium between dissolved molecules and crystal packing effects.</p>
    </Notes>
  </Step>

  <Step id="explore_outputs" title="Analyze output files and visualize crystal morphology">
    <Instructions>
      <p>OCC generates several output files including 3D morphology models. Let's explore these files and visualize how water affects crystal shape.</p>
    </Instructions>
    
    <Commands>
      <pre><code>{`# List all output files
ls -la paracetamol*.ply paracetamol*.json paracetamol_cg.txt

# Quick analysis of surface energies
echo "Analyzing surface energy changes..."
echo "In vacuum, lowest energy face: (0 1 0) at 0.116 J/m²"
echo "In water, lowest energy face: (2 0 -1) at 0.053 J/m²"
echo ""
echo "Water changes which face dominates the morphology!"`}</code></pre>
    </Commands>
    
    <Output>
      <pre><code>{`-rw-r--r--  paracetamol_vacuum.ply
-rw-r--r--  paracetamol_water.ply
-rw-r--r--  paracetamol_0.owf.json
-rw-r--r--  paracetamol_0_water.owf.json
-rw-r--r--  paracetamol_water_cg_results.json
-rw-r--r--  paracetamol_cg.txt

Analyzing surface energy changes...
In vacuum, lowest energy face: (0 1 0) at 0.116 J/m²
In water, lowest energy face: (2 0 -1) at 0.053 J/m²

Water changes which face dominates the morphology!`}</code></pre>
    </Output>
    
    <Notes>
      <p><strong>Visualizing the Wulff construction morphologies:</strong></p>
      <ol>
        <li><strong>Quick visualization:</strong> Go to <a href="https://3dviewer.net">3dviewer.net</a> and drag-drop both <code>paracetamol_vacuum.ply</code> and <code>paracetamol_water.ply</code> files to compare the 3D crystal shapes side by side</li>
        <li>
          <strong>What to look for:</strong>
          <ul>
            <li>Which faces are largest (slowest growing)</li>
            <li>Overall crystal shape (plate-like, needle-like, block-like)</li>
            <li>How water changes the aspect ratio</li>
          </ul>
        </li>
        <li><strong>Advanced analysis:</strong> Import <code>paracetamol_water_cg_results.json</code> into CrystalExplorer to see surface properties mapped onto the morphology</li>
      </ol>
      <p><strong>Key insights from the surface energies:</strong></p>
      <ul>
        <li>Lower surface energy → slower growth → larger face in final crystal</li>
        <li>Water stabilizes all faces but by different amounts (18-60% reduction)</li>
        <li>This differential stabilization changes which faces dominate</li>
        <li>The PLY files show the Wulff construction based on these energies</li>
      </ul>
    </Notes>
  </Step>

</Tutorial>

## Understanding the Results

The crystal growth calculations demonstrate how molecular-level interactions determine macroscopic crystal properties. The OCC calculation provides both vacuum and solvated surface energies, showing how solvent dramatically affects which crystal faces dominate the final morphology.

<div style={{display: 'flex', justifyContent: 'center'}}>
<Figure 
  src="/img/awscc_workshop/surface_cuts.png" 
  alt="Different crystal surface cuts showing how the same face can be cleaved at different positions" 
  caption="Crystal surfaces can be cut at different positions along the unit cell, creating surfaces with different exposed functional groups and energies. OCC automatically finds the optimal cut position for each face."
  width="60%"
  float="none"
/>
</div>

Notice in the output that each surface has a "cut" parameter (e.g., `cut = 0.250` for the (1 0 0) face). This represents where along the unit cell the surface is cleaved, as different cut positions expose different molecular groups and have vastly different energies. Finding the optimal cut position for each face is computationally intensive but crucial for accurate morphology prediction.

The key insight is that faces with lower surface energies grow more slowly and therefore become the dominant faces in the final crystal. Water affects different faces differently - some are stabilized by 60% while others by only 18% - which explains why crystals grown from different solvents have different shapes.

### Computational Advantages

What we just accomplished in minutes would be extraordinarily challenging with traditional periodic DFT methods. Consider what periodic DFT would require:

1. **Surface slab construction**: Building periodic slabs with sufficient vacuum space and thickness to prevent artifacts
2. **Solvation modeling**: Explicit water molecules or implicit solvation models that work poorly with periodic boundaries
3. **Convergence challenges**: Solvated surfaces often require hundreds of optimization steps
4. **Computational cost**: Each surface would require hours to days of calculation time
5. **Multiple cut positions**: Testing different surface terminations multiplies the computational burden

In contrast, the OCC approach leverages accurate gas-phase molecular wavefunctions and well-validated solvation models to predict surface energies efficiently. The method handles both vacuum and solvated surfaces in a single calculation, automatically finding optimal cut positions and providing results in minutes rather than weeks.

## Applications and Real-World Impact

Understanding and predicting crystal morphology has profound implications for pharmaceutical development. The shape of drug crystals directly affects how quickly tablets dissolve in the body, how well powders flow during manufacturing, and even how stable the drug remains on the shelf. By using computational methods like those demonstrated here, pharmaceutical companies can predict these properties before synthesizing a single crystal.

The power of this approach lies in its ability to screen many different crystallization conditions rapidly. Rather than spending months growing crystals from dozens of solvents, researchers can computationally predict which conditions will produce crystals with desired properties. The surface energy calculations reveal not just what shape crystals will form, but why - providing the physical understanding needed to rationally design crystallization processes.

This same methodology extends beyond pharmaceuticals to any crystalline material where morphology matters: semiconductors for electronics, explosives for safety applications, and specialty chemicals where crystal shape affects performance. The computational approach provides both practical predictions and fundamental understanding of the crystal growth process.

## Key Takeaways

✓ Crystal faces with lower surface energies grow slowly and dominate the final morphology

✓ Solvents dramatically alter surface energies, changing crystal shape

✓ OCC efficiently predicts both vacuum and solvated morphologies in minutes

✓ The PLY output files provide 3D visualizations of predicted crystal shapes

For detailed information about the theoretical foundation and computational methodology behind crystal growth calculations, see the [Crystal Growth Theory appendix](cg-theory.md).
