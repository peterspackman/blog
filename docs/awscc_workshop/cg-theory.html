<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-awscc_workshop/cg-theory" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Appendix: Crystal Growth Theory and Computational Protocol | Peter R. Spackman</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.prs.wiki/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.prs.wiki/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.prs.wiki/docs/awscc_workshop/cg-theory"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Appendix: Crystal Growth Theory and Computational Protocol | Peter R. Spackman"><meta data-rh="true" name="description" content="Crystal growth is one of those areas where theory meets practice in fascinating (and often frustrating) ways. You can have the most beautiful theoretical understanding of molecular interactions, but when it comes to predicting what shape crystals will actually grow into, you quickly realize that the devil is in the details - and there are a lot of details."><meta data-rh="true" property="og:description" content="Crystal growth is one of those areas where theory meets practice in fascinating (and often frustrating) ways. You can have the most beautiful theoretical understanding of molecular interactions, but when it comes to predicting what shape crystals will actually grow into, you quickly realize that the devil is in the details - and there are a lot of details."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.prs.wiki/docs/awscc_workshop/cg-theory"><link data-rh="true" rel="alternate" href="https://www.prs.wiki/docs/awscc_workshop/cg-theory" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.prs.wiki/docs/awscc_workshop/cg-theory" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Intermolecular Interactions Workshop","item":"https://www.prs.wiki/docs/awscc_workshop/"},{"@type":"ListItem","position":2,"name":"Appendix: Crystal Growth Theory and Computational Protocol","item":"https://www.prs.wiki/docs/awscc_workshop/cg-theory"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Peter R. Spackman RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Peter R. Spackman Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-W51GMN2E4G"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-W51GMN2E4G",{anonymize_ip:!0})</script>




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.72799b08.css">
<script src="/assets/js/runtime~main.aa663e74.js" defer="defer"></script>
<script src="/assets/js/main.9857e4e0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/prs.png"><link rel="preload" as="image" href="/img/awscc_workshop/growth.png"><link rel="preload" as="image" href="/img/awscc_workshop/ibuprofen_acetonitrile_coulomb_surface.png"><link rel="preload" as="image" href="/img/awscc_workshop/ibuprofen_neighbours_a.png"><link rel="preload" as="image" href="/img/awscc_workshop/cg_energy_model.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/prs.png" alt="Peter R. Spackman" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/prs.png" alt="Peter R. Spackman" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/software">software</a><a class="navbar__item navbar__link" href="/publications">papers</a><a class="navbar__item navbar__link" href="/blog">blog</a><a class="navbar__item navbar__link" href="/utilities">utilities</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">visualisations</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/bragg">Bragg&#x27;s Law</a></li><li><a class="dropdown__link" href="/qm1d">QM 1D</a></li><li><a class="dropdown__link" href="/qm2d">QM 2D</a></li><li><a class="dropdown__link" href="/spherical-harmonics">Spherical Harmonics</a></li><li><a class="dropdown__link" href="/md">Molecular Dynamics</a></li><li><a class="dropdown__link" href="/crystals">Crystal Structures</a></li><li><a class="dropdown__link" href="/wulff">Wulff Construction 2D</a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/peterspackman" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">github<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://scholar.google.com.au/citations?user=GmSR9oIAAAAJ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">google scholar<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://orcid.org/0000-0002-6532-8571" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">orcid<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/crystals">Crystal Structure Fundamentals</a><button aria-label="Expand sidebar category &#x27;Crystal Structure Fundamentals&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Quantum Chemistry/Density Functional Theory">Quantum Chemistry</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/awscc_workshop">Intermolecular Interactions Workshop</a><button aria-label="Collapse sidebar category &#x27;Intermolecular Interactions Workshop&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/awscc_workshop/setup">0. Setup (10 minutes)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/awscc_workshop/pair-energies">1. Intermolecular Interactions: From Theory to Practice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/awscc_workshop/clusters">2. From Pairs to Crystals: Many-Body Effects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/awscc_workshop/crystal-growth">3. Crystal Growth: Putting It All Together</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/awscc_workshop/ce-1p">Appendix: CE-1p</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/awscc_workshop/cg-theory">Appendix: Crystal Growth Theory and Computational Protocol</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/awscc_workshop"><span>Intermolecular Interactions Workshop</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Appendix: Crystal Growth Theory and Computational Protocol</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Appendix: Crystal Growth Theory and Computational Protocol</h1></header>
<p>Crystal growth is one of those areas where theory meets practice in fascinating (and often frustrating) ways. You can have the most beautiful theoretical understanding of molecular interactions, but when it comes to predicting what shape crystals will actually grow into, you quickly realize that the devil is in the details - and there are a <em>lot</em> of details.</p>
<p>This appendix walks through the theory behind <code>occ cg</code> calculations, but more importantly, explains <em>why</em> we do things the way we do them and where the approximations might break down. If you&#x27;re going to use these methods in practice, you need to understand not just how they work, but when they&#x27;re likely to give you nonsense.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="crystal-growth-models-from-molecular-interactions-to-morphology">Crystal Growth Models: From Molecular Interactions to Morphology<a href="#crystal-growth-models-from-molecular-interactions-to-morphology" class="hash-link" aria-label="Direct link to Crystal Growth Models: From Molecular Interactions to Morphology" title="Direct link to Crystal Growth Models: From Molecular Interactions to Morphology">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-terrace-step-kink-model">The Terrace-Step-Kink Model<a href="#the-terrace-step-kink-model" class="hash-link" aria-label="Direct link to The Terrace-Step-Kink Model" title="Direct link to The Terrace-Step-Kink Model">​</a></h3>
<figure class="figure_peCb" style="width:60%;float:right;margin-left:1rem;margin-bottom:1rem;clear:both"><img src="/img/awscc_workshop/growth.png" alt="Crystal growth mechanisms showing terrace-step-kink model" style="width:100%;height:auto;display:block"><figcaption class="caption_gnEO">Terrace-step-kink model of crystal growth showing molecular attachment sites</figcaption></figure>
<p>Real crystal surfaces aren&#x27;t the perfect flat planes you see in textbook diagrams. They&#x27;re messy, with steps, kinks, and all sorts of irregularities. The terrace-step-kink (TSK) model is our way of making sense of this mess:</p>
<ul>
<li><strong>Terraces</strong>: The relatively flat bits - molecules here are well-coordinated but hard to access</li>
<li><strong>Steps</strong>: Where different terraces meet - linear defects that are somewhat exposed</li>
<li><strong>Kinks</strong>: The really interesting spots - corners along step edges where molecules can easily attach</li>
</ul>
<p>Here&#x27;s the key insight: crystals grow fastest at kink sites. Why? It&#x27;s a Goldilocks situation - kink sites provide enough coordination to bind strongly, but they&#x27;re still accessible enough for new molecules to actually reach them. A molecule trying to attach to the middle of a flat terrace has a much harder time because it can&#x27;t make as many contacts with its neighbors.</p>
<p>The attachment energy tells you how much a face wants to grow:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mtext>att</mtext></msub><mo>=</mo><msub><mo>∑</mo><mtext>neighbors</mtext></msub><mo stretchy="false">(</mo><msubsup><mi>E</mi><mtext>crystal</mtext><mrow><mi>A</mi><mi>B</mi></mrow></msubsup><mo>−</mo><msubsup><mi>E</mi><mtext>solvent</mtext><mrow><mi>A</mi><mi>B</mi></mrow></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{\text{att}} = \sum_{\text{neighbors}} (E_{\text{crystal}}^{AB} - E_{\text{solvent}}^{AB})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">att</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2771em;vertical-align:-0.4358em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">neighbors</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4169em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">crystal</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4192em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4169em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">solvent</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p></div>
<p>This is just saying: &quot;How much more stable is this molecule when it&#x27;s attached to the crystal versus when it&#x27;s dissolved in solution?&quot; If that number is large and negative (i.e., much more stable in the crystal), that face will grow fast. If it&#x27;s small, the face grows slowly and ends up dominating the final crystal shape.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Slow faces dominate morphology</div><div class="admonitionContent_BuS1"><p>This is counterintuitive! The faces that grow <em>slowly</em> are the ones you see on the final crystal, because the fast-growing faces quickly disappear. It&#x27;s like natural selection for crystal faces.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="thermodynamic-vs-kinetic-control">Thermodynamic vs. Kinetic Control<a href="#thermodynamic-vs-kinetic-control" class="hash-link" aria-label="Direct link to Thermodynamic vs. Kinetic Control" title="Direct link to Thermodynamic vs. Kinetic Control">​</a></h3>
<p>Here&#x27;s where things get philosophically interesting. Are crystals lazy or impatient?</p>
<p><strong>Thermodynamic control</strong>: The crystal is lazy - it takes its time and ends up in the most stable shape possible. Surface energies determine the final shape because everything has time to equilibrate. This gives you nice, well-formed crystals.</p>
<p><strong>Kinetic control</strong>: The crystal is impatient - it grows so fast that it gets trapped in whatever shape it happens to be forming. You get weird morphologies like needles, dendrites, or those snowflake patterns that form when water freezes quickly.</p>
<p>The methods we&#x27;re discussing here assume <strong>thermodynamic control</strong>. We&#x27;re basically saying that the activation barriers for attachment and detachment are similar for all the different surface sites, so the thermodynamic driving force (the attachment energy) is a good proxy for the relative growth rates.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>When kinetics matters</div><div class="admonitionContent_BuS1"><p>This assumption breaks down when:</p><ul>
<li>You&#x27;re growing very fast (high supersaturation)</li>
<li>Different faces have very different activation barriers</li>
<li>Solvent molecules get in the way differently on different faces</li>
<li>Mass transport becomes limiting</li>
</ul><p>If you see weird crystal shapes that don&#x27;t match your predictions, kinetics might be taking over.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="monte-carlo-crystal-growth-simulation">Monte Carlo Crystal Growth Simulation<a href="#monte-carlo-crystal-growth-simulation" class="hash-link" aria-label="Direct link to Monte Carlo Crystal Growth Simulation" title="Direct link to Monte Carlo Crystal Growth Simulation">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-crystalgrower-approach">The CrystalGrower Approach<a href="#the-crystalgrower-approach" class="hash-link" aria-label="Direct link to The CrystalGrower Approach" title="Direct link to The CrystalGrower Approach">​</a></h3>
<p>Monte Carlo simulation is perfect for crystal growth because, let&#x27;s face it, crystal growth is fundamentally a random process. Molecules are constantly bumping around in solution, occasionally sticking to or falling off the crystal surface. We can&#x27;t predict exactly when each molecule will attach, but we can predict the <em>probabilities</em>.</p>
<p>CrystalGrower treats the crystal as a 3D lattice where each site can either be occupied (molecule present) or empty. Then it plays a gigantic game of molecular roulette:</p>
<ol>
<li><strong>Pick a site</strong>: Randomly choose a surface site that could potentially change</li>
<li><strong>Pick an event</strong>: If it&#x27;s empty, try to stick a molecule there. If it&#x27;s occupied, try to remove it</li>
<li><strong>Calculate the energy</strong>: How much would this move cost or gain?</li>
<li><strong>Roll the dice</strong>: Accept or reject based on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>G</mi><mi mathvariant="normal">/</mi><msub><mi>k</mi><mi>B</mi></msub><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P = \exp(-\Delta G / k_B T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">−</span><span class="mord">Δ</span><span class="mord mathnormal">G</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mclose">)</span></span></span></span></li>
<li><strong>Repeat</strong>: Do this millions of times until you get bored (or the crystal reaches equilibrium)</li>
</ol>
<p>The beauty is that this automatically gives you the right equilibrium distribution without having to solve any complicated differential equations.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="supersaturation-the-driving-force">Supersaturation: The Driving Force<a href="#supersaturation-the-driving-force" class="hash-link" aria-label="Direct link to Supersaturation: The Driving Force" title="Direct link to Supersaturation: The Driving Force">​</a></h3>
<p>In real experiments, you don&#x27;t grow crystals from perfectly saturated solutions - that would take forever. You need supersaturation to provide the driving force. The chemical potential difference tells you how &quot;hungry&quot; the system is to form crystals:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>μ</mi><mo>=</mo><msub><mi>k</mi><mi>B</mi></msub><mi>T</mi><mi>ln</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Delta \mu = k_B T \ln(S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord">Δ</span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">ln</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mclose">)</span></span></span></span></p></div>
<p>Where S is the supersaturation ratio (how much more concentrated your solution is compared to the saturation concentration). This gets added to your attachment energy:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>G</mi><mtext>total</mtext></msub><mo>=</mo><mi mathvariant="normal">Δ</mi><msub><mi>G</mi><mtext>attachment</mtext></msub><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>μ</mi></mrow><annotation encoding="application/x-tex">\Delta G_{\text{total}} = \Delta G_{\text{attachment}} - \Delta \mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">total</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">attachment</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord">Δ</span><span class="mord mathnormal">μ</span></span></span></span></p></div>
<p>The trick is getting the supersaturation right. Too low and nothing happens. Too high and you get kinetic effects (or worse, you crash everything out at once in an amorphous mess).</p>
<p>A typical simulation recipe:</p>
<ul>
<li>Start with ridiculously high supersaturation (S ~ 100) to get nucleation going</li>
<li>Slowly dial it back to equilibrium over 100,000 steps</li>
<li>Let it cook for 4-5 million total steps until the morphology stabilizes</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Simulation time vs. real time</div><div class="admonitionContent_BuS1"><p>These Monte Carlo steps don&#x27;t correspond to real time - they&#x27;re just a way of sampling configuration space. Don&#x27;t try to convert them to actual growth rates without a lot more work.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-the-simulation-needs-from-you">What the Simulation Needs From You<a href="#what-the-simulation-needs-from-you" class="hash-link" aria-label="Direct link to What the Simulation Needs From You" title="Direct link to What the Simulation Needs From You">​</a></h3>
<p>Here&#x27;s the problem: the Monte Carlo simulation needs to know the energy for every possible way a molecule can attach to or detach from the crystal surface. And there are <em>a lot</em> of possible environments - corner sites, edge sites, different orientations, different local coordination numbers, etc.</p>
<p>Traditionally, people would just fit all these energies to match experimental crystal shapes. This works, but it&#x27;s a nightmare of parameter optimization, and you need experimental data for every system you want to study.</p>
<p>The <code>occ cg</code> approach tries to predict these energies from first principles, which sounds great in theory but requires some clever tricks to make it work in practice.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="computational-energy-protocol-the-how-and-why">Computational Energy Protocol: The &quot;How&quot; and &quot;Why&quot;<a href="#computational-energy-protocol-the-how-and-why" class="hash-link" aria-label="Direct link to Computational Energy Protocol: The &quot;How&quot; and &quot;Why&quot;" title="Direct link to Computational Energy Protocol: The &quot;How&quot; and &quot;Why&quot;">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-big-picture">The Big Picture<a href="#the-big-picture" class="hash-link" aria-label="Direct link to The Big Picture" title="Direct link to The Big Picture">​</a></h3>
<p>Here&#x27;s what we&#x27;re trying to do: start with just a crystal structure and a solvent choice, and end up with a predicted crystal morphology. The magic happens through a computational pipeline that combines several different methods:</p>
<ol>
<li><strong>CE-1p model</strong>: Get intermolecular interactions quickly (without breaking the bank)</li>
<li><strong>SMD solvation</strong>: Figure out how much the solvent likes each molecule</li>
<li><strong>Energy partitioning</strong>: Break everything down into bite-sized pieces for the simulation</li>
<li><strong>CrystalGrower</strong>: Run the actual growth simulation</li>
</ol>
<p>Each step has its own approximations and potential failure modes, so let&#x27;s dig into them.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-get-the-lattice-energies-without-going-broke">Step 1: Get the Lattice Energies (Without Going Broke)<a href="#step-1-get-the-lattice-energies-without-going-broke" class="hash-link" aria-label="Direct link to Step 1: Get the Lattice Energies (Without Going Broke)" title="Direct link to Step 1: Get the Lattice Energies (Without Going Broke)">​</a></h3>
<p>This is where CE-1p comes to the rescue. You need intermolecular interaction energies for all the molecular pairs in your crystal, but doing full quantum mechanical calculations for every dimer would take approximately forever.</p>
<p>CE-1p gives you quantum mechanical quality for the price of a force field calculation:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mtext>latt</mtext></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mo>∑</mo><mi>A</mi></msub><msub><mo>∑</mo><mrow><msubsup><mi>r</mi><mi>n</mi><mrow><mi>A</mi><mi>B</mi></mrow></msubsup><mo>&lt;</mo><msub><mi>r</mi><mtext>max</mtext></msub></mrow></msub><msubsup><mi>E</mi><mtext>CE-1p</mtext><mrow><mi>A</mi><mi>B</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">U_{\text{latt}} = \frac{1}{2} \sum_{A} \sum_{r_n^{AB} &lt; r_{\text{max}}} E^{AB}_{\text{CE-1p}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">latt</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.345em;vertical-align:-0.4999em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2422em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7741em"><span style="top:-2.214em;margin-left:-0.0278em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em"><span></span></span></span></span></span></span><span class="mrel mtight">&lt;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">max</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4999em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4247em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CE-1p</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4114em"><span></span></span></span></span></span></span></span></span></span></p></div>
<p>The factor of 1/2 is there because we&#x27;re double-counting pairs (A interacting with B is the same as B interacting with A).</p>
<p>Why CE-1p is brilliant:</p>
<ul>
<li><strong>No geometry optimization needed</strong>: Use the experimental crystal structure as-is</li>
<li><strong>~12x speed boost</strong>: Avoid the expensive dimer SCF calculation</li>
<li><strong>One parameter to rule them all</strong>: k = 0.78 works for basically everything</li>
<li><strong>Periodic table coverage</strong>: H to Rn (yes, even radioactive stuff)</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Distance matters</div><div class="admonitionContent_BuS1"><p>We use nearest atom-atom distance (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>r</mi><mi>n</mi><mrow><mi>A</mi><mi>B</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">r_n^{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0883em;vertical-align:-0.247em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span>), not center-of-mass distance. For weird-shaped molecules, the center of mass can be misleading - what matters is how close the electrons actually get to each other.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-long-range-interaction-assignment">Step 2: Long-Range Interaction Assignment<a href="#step-2-long-range-interaction-assignment" class="hash-link" aria-label="Direct link to Step 2: Long-Range Interaction Assignment" title="Direct link to Step 2: Long-Range Interaction Assignment">​</a></h3>
<p><strong>Challenge</strong>: CrystalGrower focuses on nearest-neighbor interactions, but long-range contributions can be significant, especially for polar molecules.</p>
<p><strong>Solution</strong>: Assign non-nearest neighbor interactions to nearest neighbors based on directional overlap:</p>
<p>For a non-nearest neighbor interaction AC, partition its energy among nearest neighbors AB:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>E</mi><mrow><mi>L</mi><mi>R</mi></mrow><mrow><mi>A</mi><mi>B</mi></mrow></msubsup><mo>=</mo><msub><mo>∑</mo><mrow><mi>A</mi><mi>C</mi><mo mathvariant="normal">∉</mo><mi>N</mi><mi>N</mi></mrow></msub><mfrac><mrow><msup><mover accent="true"><mi>r</mi><mo>⃗</mo></mover><mrow><mi>A</mi><mi>B</mi></mrow></msup><mo>⋅</mo><msup><mover accent="true"><mi>r</mi><mo>⃗</mo></mover><mrow><mi>A</mi><mi>C</mi></mrow></msup></mrow><msubsup><mi>w</mi><mtext>tot</mtext><mrow><mi>A</mi><mi>C</mi></mrow></msubsup></mfrac><msup><mi>E</mi><mrow><mi>A</mi><mi>C</mi></mrow></msup></mrow><annotation encoding="application/x-tex">E_{LR}^{AB} = \sum_{AC \notin NN} \frac{\vec{r}^{AB} \cdot \vec{r}^{AC}}{w_{\text{tot}}^{AC}} E^{AC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1167em;vertical-align:-0.2753em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4247em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right:0.00773em">R</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.6338em;vertical-align:-0.5964em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2253em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span><span class="mrel mtight"><span class="mord mtight"><span class="mrel mtight">∈</span></span><span class="mord vbox mtight"><span class="thinbox mtight"><span class="llap mtight"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="inner"><span class="mord mtight"><span class="mord mtight">/</span><span class="mspace mtight" style="margin-right:0.0651em"></span></span></span><span class="fix"></span></span></span></span></span><span class="mord mathnormal mtight" style="margin-right:0.10903em">NN</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4747em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0374em"><span style="top:-2.607em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8329em"><span style="top:-2.2095em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tot</span></span></span></span></span><span style="top:-2.8448em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2905em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em"><span style="top:-2.714em"><span class="pstrut" style="height:2.714em"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span style="top:-2.714em"><span class="pstrut" style="height:2.714em"></span><span class="accent-body" style="left:-0.1799em"><span class="overlay mtight" style="height:0.714em;width:0.471em"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9191em"><span style="top:-2.931em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span></span></span></span></span><span class="mbin mtight">⋅</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em"><span style="top:-2.714em"><span class="pstrut" style="height:2.714em"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span style="top:-2.714em"><span class="pstrut" style="height:2.714em"></span><span class="accent-body" style="left:-0.1799em"><span class="overlay mtight" style="height:0.714em;width:0.471em"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9191em"><span style="top:-2.931em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5964em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span></span></span></span></span></span></span></span></span></p></div>
<p>Where the total weight is: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>w</mi><mtext>tot</mtext><mrow><mi>A</mi><mi>C</mi></mrow></msubsup><mo>=</mo><msub><mo>∑</mo><mrow><mi>A</mi><mi>B</mi><mo>∈</mo><mi>N</mi><mi>N</mi></mrow></msub><msup><mover accent="true"><mi>r</mi><mo>⃗</mo></mover><mrow><mi>A</mi><mi>B</mi></mrow></msup><mo>⋅</mo><msup><mover accent="true"><mi>r</mi><mo>⃗</mo></mover><mrow><mi>A</mi><mi>C</mi></mrow></msup></mrow><annotation encoding="application/x-tex">w_{\text{tot}}^{AC} = \sum_{AB \in NN} \vec{r}^{AB} \cdot \vec{r}^{AC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0883em;vertical-align:-0.247em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.453em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tot</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1684em;vertical-align:-0.3271em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.10903em">NN</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3271em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1799em"><span class="overlay" style="height:0.714em;width:0.471em"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1799em"><span class="overlay" style="height:0.714em;width:0.471em"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>This preserves total energy while maintaining directional character of long-range interactions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-solvation-energy-calculation">Step 3: Solvation Energy Calculation<a href="#step-3-solvation-energy-calculation" class="hash-link" aria-label="Direct link to Step 3: Solvation Energy Calculation" title="Direct link to Step 3: Solvation Energy Calculation">​</a></h3>
<p><strong>SMD Continuum Model</strong>: Calculates solvation free energies using the Solvation Model based on Density:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>G</mi><mtext>solv</mtext></msub><mo>=</mo><mi mathvariant="normal">Δ</mi><msub><mi>G</mi><mtext>EP</mtext></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><msub><mi>G</mi><mtext>CDS</mtext></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><msub><mi>G</mi><mtext>std</mtext></msub></mrow><annotation encoding="application/x-tex">\Delta G_{\text{solv}} = \Delta G_{\text{EP}} + \Delta G_{\text{CDS}} + \Delta G_{\text{std}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">solv</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">EP</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CDS</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">std</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></p></div>
<p>Components:</p>
<ul>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>G</mi><mtext>EP</mtext></msub></mrow><annotation encoding="application/x-tex">\Delta G_{\text{EP}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">EP</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></strong>: Electronic polarization from self-consistent reaction field</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>G</mi><mtext>CDS</mtext></msub></mrow><annotation encoding="application/x-tex">\Delta G_{\text{CDS}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CDS</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></strong>: Cavitation, dispersion, and solvent structure effects</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>G</mi><mtext>std</mtext></msub></mrow><annotation encoding="application/x-tex">\Delta G_{\text{std}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">std</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></strong>: Standard state correction (7.91 kJ/mol)</li>
</ul>
<p><strong>Computational procedure</strong>:</p>
<ol>
<li>Gas-phase SCF calculation for isolated molecule</li>
<li>Solvated SCF calculation with continuum environment</li>
<li>Surface generation for cavitation/dispersion terms</li>
<li>Combine all contributions for total solvation free energy</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-solvation-energy-partitioning">Step 4: Solvation Energy Partitioning<a href="#step-4-solvation-energy-partitioning" class="hash-link" aria-label="Direct link to Step 4: Solvation Energy Partitioning" title="Direct link to Step 4: Solvation Energy Partitioning">​</a></h3>
<figure class="figure_peCb" style="width:50%;float:right;margin-left:1rem;margin-bottom:1rem;clear:both"><img src="/img/awscc_workshop/ibuprofen_acetonitrile_coulomb_surface.png" alt="Molecular surface colored by electrostatic potential" style="width:100%;height:auto;display:block"><figcaption class="caption_gnEO">SMD solvation surface with partitioning for neighboring interactions</figcaption></figure>
<p><strong>Innovation</strong>: Partition bulk solvation free energies into interaction-specific contributions based on molecular surface analysis.</p>
<p><strong>Procedure</strong>:</p>
<ol>
<li><strong>Surface orientation</strong>: Rotate continuum surface to match crystal environment</li>
<li><strong>Surface assignment</strong>: Assign each surface point to nearest neighboring molecule</li>
<li><strong>Energy partitioning</strong>: Use surface area weights to distribute solvation energy</li>
</ol>
<p>For asymmetric crystal-solution interfaces:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>G</mi><mtext>solv</mtext><mtext>total</mtext></msubsup><mo>=</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>G</mi><mtext>solv</mtext><mover accent="true"><mrow><mi>A</mi><mi>B</mi></mrow><mo stretchy="true">→</mo></mover></msubsup><mo>+</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>G</mi><mtext>solv</mtext><mover accent="true"><mrow><mi>B</mi><mi>A</mi></mrow><mo stretchy="true">→</mo></mover></msubsup><mo>+</mo><mfrac><mrow><mi mathvariant="normal">Δ</mi><msubsup><mi>G</mi><mtext>solv</mtext><mover accent="true"><mrow><mi>A</mi><mi>B</mi></mrow><mo stretchy="true">→</mo></mover></msubsup><mo>−</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>G</mi><mtext>solv</mtext><mover accent="true"><mrow><mi>B</mi><mi>A</mi></mrow><mo stretchy="true">→</mo></mover></msubsup></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\Delta G_{\text{solv}}^{\text{total}} = \Delta G_{\text{solv}}^{\overrightarrow{AB}} + \Delta G_{\text{solv}}^{\overrightarrow{BA}} + \frac{\Delta G_{\text{solv}}^{\overrightarrow{AB}} - \Delta G_{\text{solv}}^{\overrightarrow{BA}}}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1322em;vertical-align:-0.2831em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">solv</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">total</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.4898em;vertical-align:-0.2831em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2067em"><span style="top:-2.5606em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.8437em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">solv</span></span></span></span></span><span style="top:-3.2067em;margin-right:0.05em"><span class="pstrut" style="height:2.8437em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2053em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span><span class="svg-align" style="top:-3.3833em"><span class="pstrut" style="height:2.7em"></span><span class="hide-tail mtight" style="height:0.522em;min-width:0.888em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.4898em;vertical-align:-0.2831em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2067em"><span style="top:-2.5606em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.8437em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">solv</span></span></span></span></span><span style="top:-3.2067em;margin-right:0.05em"><span class="pstrut" style="height:2.8437em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2053em"><span style="top:-2.7em"><span class="pstrut" style="height:2.7em"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span><span class="mord mathnormal mtight">A</span></span></span><span class="svg-align" style="top:-3.3833em"><span class="pstrut" style="height:2.7em"></span><span class="hide-tail mtight" style="height:0.522em;min-width:0.888em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.7596em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4146em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.5102em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2919em"><span style="top:-2.5749em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.8609em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">solv</span></span></span></span></span><span style="top:-3.2919em;margin-right:0.0714em"><span class="pstrut" style="height:2.8609em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2053em"><span style="top:-2.6833em"><span class="pstrut" style="height:2.6833em"></span><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span><span class="svg-align" style="top:-3.3667em"><span class="pstrut" style="height:2.6833em"></span><span class="hide-tail mtight" style="height:0.522em;min-width:0.888em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">Δ</span><span class="mord mtight"><span class="mord mathnormal mtight">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2919em"><span style="top:-2.5749em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.8609em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">solv</span></span></span></span></span><span style="top:-3.2919em;margin-right:0.0714em"><span class="pstrut" style="height:2.8609em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2053em"><span style="top:-2.6833em"><span class="pstrut" style="height:2.6833em"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span><span class="mord mathnormal mtight">A</span></span></span><span class="svg-align" style="top:-3.3667em"><span class="pstrut" style="height:2.6833em"></span><span class="hide-tail mtight" style="height:0.522em;min-width:0.888em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p></div>
<p>This maintains energy conservation while preserving interface asymmetry.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-crystal-growth-simulation">Step 5: Crystal Growth Simulation<a href="#step-5-crystal-growth-simulation" class="hash-link" aria-label="Direct link to Step 5: Crystal Growth Simulation" title="Direct link to Step 5: Crystal Growth Simulation">​</a></h3>
<figure class="figure_peCb" style="width:50%;float:left;margin-right:1rem;margin-bottom:1rem;clear:both"><img src="/img/awscc_workshop/ibuprofen_neighbours_a.png" alt="Crystal surface showing molecular environment" style="width:100%;height:auto;display:block"><figcaption class="caption_gnEO">Crystal growth environment showing neighboring molecules and interaction assignment</figcaption></figure>
<p><strong>Final step</strong>: Use computed interaction energies in CrystalGrower Monte Carlo simulation.</p>
<p>Total attachment energy for each surface site:</p>
<div style="text-align:center"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mtext>attachment</mtext></msub><mo>=</mo><msub><mo>∑</mo><mtext>neighbors</mtext></msub><mo stretchy="false">(</mo><msubsup><mi>E</mi><mtext>CE-1p</mtext><mrow><mi>A</mi><mi>B</mi></mrow></msubsup><mo>+</mo><msubsup><mi>E</mi><mrow><mi>L</mi><mi>R</mi></mrow><mrow><mi>A</mi><mi>B</mi></mrow></msubsup><mo>+</mo><mi mathvariant="normal">Δ</mi><msubsup><mi>G</mi><mtext>solv</mtext><mrow><mi>A</mi><mi>B</mi></mrow></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{\text{attachment}} = \sum_{\text{neighbors}} (E_{\text{CE-1p}}^{AB} + E_{LR}^{AB} + \Delta G_{\text{solv}}^{AB})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">attachment</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.2771em;vertical-align:-0.4358em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">neighbors</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4247em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CE-1p</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4114em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1167em;vertical-align:-0.2753em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4247em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right:0.00773em">R</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4169em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">solv</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p></div>
<p>The simulation predicts:</p>
<ul>
<li><strong>Surface energies</strong>: Cost of creating crystal-solution interfaces</li>
<li><strong>Growth rates</strong>: Relative rates for different crystal faces</li>
<li><strong>Morphology</strong>: Final crystal shape from competition between faces</li>
<li><strong>Solvent effects</strong>: How different solvents modify crystal shape</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="physical-interpretation-and-applications">Physical Interpretation and Applications<a href="#physical-interpretation-and-applications" class="hash-link" aria-label="Direct link to Physical Interpretation and Applications" title="Direct link to Physical Interpretation and Applications">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="energy-landscape">Energy Landscape<a href="#energy-landscape" class="hash-link" aria-label="Direct link to Energy Landscape" title="Direct link to Energy Landscape">​</a></h3>
<figure class="figure_peCb" style="width:85%;margin-bottom:1rem"><img src="/img/awscc_workshop/cg_energy_model.png" alt="Complete thermodynamic cycle for crystal growth" style="width:100%;height:auto;display:block"><figcaption class="caption_gnEO">Thermodynamic cycle connecting crystal lattice energy, solvation energy, and surface site energies</figcaption></figure>
<p>The complete thermodynamic description connects molecular interactions to macroscopic properties:</p>
<ul>
<li><strong>Gas phase</strong>: Isolated molecule energy (reference state)</li>
<li><strong>Solution</strong>: Molecule stabilized by solvation energy</li>
<li><strong>Kink site</strong>: Molecule partially coordinated in crystal</li>
<li><strong>Bulk crystal</strong>: Molecule fully coordinated (maximum stability)</li>
</ul>
<p>The energy differences between these states determine solubility, growth rates, and morphology.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solvent-effects-on-morphology">Solvent Effects on Morphology<a href="#solvent-effects-on-morphology" class="hash-link" aria-label="Direct link to Solvent Effects on Morphology" title="Direct link to Solvent Effects on Morphology">​</a></h3>
<p>Different solvents produce different crystal shapes through modified competition:</p>
<ul>
<li><strong>Polar solvents</strong>: Strongly solvate polar molecular groups, slowing growth of faces that expose these groups</li>
<li><strong>Nonpolar solvents</strong>: Weakly solvate hydrophobic regions, allowing faster growth</li>
<li><strong>Hydrogen bonding</strong>: Specific interactions can dramatically modify face-specific growth rates</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="computational-advantages">Computational Advantages<a href="#computational-advantages" class="hash-link" aria-label="Direct link to Computational Advantages" title="Direct link to Computational Advantages">​</a></h3>
<p><strong>Efficiency</strong>: The protocol is designed for rapid screening:</p>
<ul>
<li>CE-1p: ~5 seconds per dimer vs ~60 seconds for full QM</li>
<li>SMD: Converged in 2 SCF calculations</li>
<li>Partitioning: Fast geometric algorithm</li>
<li>Total: ~1 hour for typical pharmaceutical molecule</li>
</ul>
<p><strong>Accuracy</strong>: Validation studies show:</p>
<ul>
<li>Morphology prediction: Correct major faces for organic crystals</li>
<li>Solvent effects: Reproduces experimental trends</li>
<li>Energies: 10-30% typical error vs experimental values</li>
</ul>
<p><strong>General applicability</strong>:</p>
<ul>
<li>No empirical fitting required</li>
<li>Works for any crystal structure + solvent combination</li>
<li>Handles elements H through Rn</li>
<li>Suitable for high-throughput screening</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-occ-cg-command">Implementation: occ cg Command<a href="#implementation-occ-cg-command" class="hash-link" aria-label="Direct link to Implementation: occ cg Command" title="Direct link to Implementation: occ cg Command">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-usage">Basic Usage<a href="#basic-usage" class="hash-link" aria-label="Direct link to Basic Usage" title="Direct link to Basic Usage">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">occ cg crystal.cif --model=ce-1p --solvent=water --radius=4.1 --surface-energies=10</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-parameters">Key Parameters<a href="#key-parameters" class="hash-link" aria-label="Direct link to Key Parameters" title="Direct link to Key Parameters">​</a></h3>
<ul>
<li><strong><code>--model</code></strong>: Energy model (ce-1p recommended for speed/accuracy balance)</li>
<li><strong><code>--solvent</code></strong>: Solvent for SMD calculations (water, ethanol, acetonitrile, etc.)</li>
<li><strong><code>--radius</code></strong>: Cutoff distance for nearest-neighbor definition (Å)</li>
<li><strong><code>--surface-energies</code></strong>: Number of crystal faces to analyze</li>
<li><strong><code>--max-radius</code></strong>: Maximum distance for long-range interactions (default 30 Å)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="output-files">Output Files<a href="#output-files" class="hash-link" aria-label="Direct link to Output Files" title="Direct link to Output Files">​</a></h3>
<p>The calculation produces several output files:</p>
<ul>
<li><strong>Interaction energies</strong>: CE-1p energies for all molecular pairs</li>
<li><strong>Solvation energies</strong>: SMD results and surface partitioning</li>
<li><strong>Surface analysis</strong>: Face identification and attachment energies</li>
<li><strong>CrystalGrower input</strong>: Files ready for Monte Carlo simulation</li>
<li><strong>Morphology prediction</strong>: Final crystal shape visualization</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="integration-with-crystalgrower">Integration with CrystalGrower<a href="#integration-with-crystalgrower" class="hash-link" aria-label="Direct link to Integration with CrystalGrower" title="Direct link to Integration with CrystalGrower">​</a></h3>
<p>The <code>occ cg</code> output can be directly used with CrystalGrower for detailed morphology simulation:</p>
<ol>
<li><strong>Energy calculation</strong>: <code>occ cg</code> computes all required interaction energies</li>
<li><strong>File preparation</strong>: Automatic generation of CrystalGrower input files</li>
<li><strong>Simulation</strong>: Run Monte Carlo crystal growth with predicted energies</li>
<li><strong>Analysis</strong>: Compare predicted vs experimental morphologies</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="limitations-and-future-directions">Limitations and Future Directions<a href="#limitations-and-future-directions" class="hash-link" aria-label="Direct link to Limitations and Future Directions" title="Direct link to Limitations and Future Directions">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="current-limitations">Current Limitations<a href="#current-limitations" class="hash-link" aria-label="Direct link to Current Limitations" title="Direct link to Current Limitations">​</a></h3>
<ul>
<li><strong>Thermodynamic approximation</strong>: Assumes similar transition state barriers</li>
<li><strong>Continuum solvation</strong>: No explicit solvent molecules or specific binding</li>
<li><strong>Rigid molecules</strong>: No conformational changes upon crystallization</li>
<li><strong>Pure phases</strong>: No impurities or additives</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="potential-improvements">Potential Improvements<a href="#potential-improvements" class="hash-link" aria-label="Direct link to Potential Improvements" title="Direct link to Potential Improvements">​</a></h3>
<ul>
<li><strong>Explicit solvation</strong>: Include specific solvent-solute interactions</li>
<li><strong>Kinetic effects</strong>: Incorporate growth barriers and surface reconstruction</li>
<li><strong>Temperature dependence</strong>: Extend beyond standard conditions</li>
<li><strong>Multi-component systems</strong>: Handle co-crystals and solid solutions</li>
</ul>
<p>The current methodology provides an excellent starting point for crystal engineering applications, with systematic improvements possible as computational resources and theoretical methods continue to advance.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/awscc_workshop/ce-1p"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Appendix: CE-1p</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#crystal-growth-models-from-molecular-interactions-to-morphology" class="table-of-contents__link toc-highlight">Crystal Growth Models: From Molecular Interactions to Morphology</a><ul><li><a href="#the-terrace-step-kink-model" class="table-of-contents__link toc-highlight">The Terrace-Step-Kink Model</a></li><li><a href="#thermodynamic-vs-kinetic-control" class="table-of-contents__link toc-highlight">Thermodynamic vs. Kinetic Control</a></li></ul></li><li><a href="#monte-carlo-crystal-growth-simulation" class="table-of-contents__link toc-highlight">Monte Carlo Crystal Growth Simulation</a><ul><li><a href="#the-crystalgrower-approach" class="table-of-contents__link toc-highlight">The CrystalGrower Approach</a></li><li><a href="#supersaturation-the-driving-force" class="table-of-contents__link toc-highlight">Supersaturation: The Driving Force</a></li><li><a href="#what-the-simulation-needs-from-you" class="table-of-contents__link toc-highlight">What the Simulation Needs From You</a></li></ul></li><li><a href="#computational-energy-protocol-the-how-and-why" class="table-of-contents__link toc-highlight">Computational Energy Protocol: The &quot;How&quot; and &quot;Why&quot;</a><ul><li><a href="#the-big-picture" class="table-of-contents__link toc-highlight">The Big Picture</a></li><li><a href="#step-1-get-the-lattice-energies-without-going-broke" class="table-of-contents__link toc-highlight">Step 1: Get the Lattice Energies (Without Going Broke)</a></li><li><a href="#step-2-long-range-interaction-assignment" class="table-of-contents__link toc-highlight">Step 2: Long-Range Interaction Assignment</a></li><li><a href="#step-3-solvation-energy-calculation" class="table-of-contents__link toc-highlight">Step 3: Solvation Energy Calculation</a></li><li><a href="#step-4-solvation-energy-partitioning" class="table-of-contents__link toc-highlight">Step 4: Solvation Energy Partitioning</a></li><li><a href="#step-5-crystal-growth-simulation" class="table-of-contents__link toc-highlight">Step 5: Crystal Growth Simulation</a></li></ul></li><li><a href="#physical-interpretation-and-applications" class="table-of-contents__link toc-highlight">Physical Interpretation and Applications</a><ul><li><a href="#energy-landscape" class="table-of-contents__link toc-highlight">Energy Landscape</a></li><li><a href="#solvent-effects-on-morphology" class="table-of-contents__link toc-highlight">Solvent Effects on Morphology</a></li><li><a href="#computational-advantages" class="table-of-contents__link toc-highlight">Computational Advantages</a></li></ul></li><li><a href="#implementation-occ-cg-command" class="table-of-contents__link toc-highlight">Implementation: occ cg Command</a><ul><li><a href="#basic-usage" class="table-of-contents__link toc-highlight">Basic Usage</a></li><li><a href="#key-parameters" class="table-of-contents__link toc-highlight">Key Parameters</a></li><li><a href="#output-files" class="table-of-contents__link toc-highlight">Output Files</a></li><li><a href="#integration-with-crystalgrower" class="table-of-contents__link toc-highlight">Integration with CrystalGrower</a></li></ul></li><li><a href="#limitations-and-future-directions" class="table-of-contents__link toc-highlight">Limitations and Future Directions</a><ul><li><a href="#current-limitations" class="table-of-contents__link toc-highlight">Current Limitations</a></li><li><a href="#potential-improvements" class="table-of-contents__link toc-highlight">Potential Improvements</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Software</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://crystalexplorer.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">crystalexplorer</a></li><li class="footer__item"><a href="https://github.com/peterspackman/chmpy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">chmpy</a></li><li class="footer__item"><a href="https://github.com/peterspackman/occ" target="_blank" rel="noopener noreferrer" class="footer__link-item">occ</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://bsky.app/profile/crystalexplorer.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">bluesky<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/peterspackman" target="_blank" rel="noopener noreferrer" class="footer__link-item">github<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">blog</a></li><li class="footer__item"><a href="https://scholar.google.com.au/citations?user=GmSR9oIAAAAJ" target="_blank" rel="noopener noreferrer" class="footer__link-item">google scholar<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://orcid.org/0000-0002-6532-8571" target="_blank" rel="noopener noreferrer" class="footer__link-item">orcid<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://publons.com/researcher/AAA-2424-2020/" target="_blank" rel="noopener noreferrer" class="footer__link-item">publons<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Peter R. Spackman</div></div></div></footer></div>
</body>
</html>