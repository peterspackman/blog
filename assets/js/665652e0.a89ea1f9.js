"use strict";(globalThis.webpackChunkblog=globalThis.webpackChunkblog||[]).push([[1288],{2292:(e,t,a)=>{a.r(t),a.d(t,{default:()=>is});var s=a(6540),n=a(1656);const r="container_Qh_B",i="layout_SyMw",l="sidebar_Cwvp",o="content_ak_G",c="tabs_tRXw",d="tab_F12w",u="tabContent_hF_7",m="collapsibleSection_Nmyk",h="sectionHeader_qShV",p="sectionTitle_aNil",x="chevron_b8vT",g="sectionContent_NPTV",f="chevronExpanded_ry9E",j="status_l6dK",v="statusLoading_AJab",b="statusReady_FVt8",y="moleculeInfo_KKVy",N="button_XSDO",C="scrollableContent_ikhb",_="stickyButtons_GEQA",$="buttonPrimary_eux_",S="buttonDanger_gLI_",w="tabActive_fzT3",F="propertiesTab_ipsn",k="structureTab_HvbL",O="noStructure_y5fR",M="matricesSection_omrz",E="noMatrices_bajq",A="orbitalsCard_tkcK",z="orbitalGrid_Wtwa",L="moreOrbitals_oRmJ",I="errorModal_HssV",D="errorContent_nEMj",R="optimizationTab_sFuH",T="optimizationSummary_Qbys",B="optimizationHeader_o9LX",H="summaryGrid_miSr",q="summaryItem_TeDs",V="summaryLabel_ItYF",P="summaryValue_eJ3Z",U="converged_TVV4",Y="notConverged_zYdK",X="trajectoryViewerContainer_y8Ak",W="optimizationLayout_h32e",Z="trajectoryViewerSection_ZNX4",G="trajectoryControlsPanel_mPQs",J="trajectoryControlsHeader_NJya",K="trajectoryModeSection_Fa3j",Q="modeButton_mefH",ee="active_TuRi",te="frequenciesControlSection_yYHA",ae="frequenciesSectionHeader_PauO",se="frequencySettings_wwcQ",ne="checkboxLabel_yHfy",re="checkbox_PB7n",ie="modesList_XfUU",le="modeItem_NeQD",oe="modeSelected_GfpX",ce="modeSelectedIndicator_koJh",de="modeInfo_QcHf",ue="modeNumber_aQX4",me="modeValue_Thd_",he="imaginaryBadge_edwd",pe="frequencySummary_MO4Z",xe="section_X2kF",ge="exampleSection_iMDs",fe="exampleLabel__wK2",je="exampleSelect_VuLc",ve="inputContainer_aHUj",be="headerRow_MA_E",ye="label_1fak",Ne="controls_Azqc",Ce="browseButton_eNgL",_e="combinedInput_AOvI",$e="dragging_F5j2",Se="valid_peYL",we="invalid_Yt4V",Fe="clearButton_KExK",ke="xyzTextarea_Jaou",Oe="errorMessage_OUge";var Me=a(4848);const Ee={formaldehyde:{name:"Formaldehyde (CH\u2082O)",xyz:"4\nFormaldehyde\nH  1.0686 -0.1411  1.0408\nC  0.5979  0.0151  0.0688\nH  1.2687  0.2002 -0.7717\nO -0.5960 -0.0151 -0.0686"},water:{name:"Water (H\u2082O)",xyz:"3\nWater molecule\nO  0.000000  0.000000  0.000000\nH  0.757000  0.586000  0.000000\nH -0.757000  0.586000  0.000000"},urea:{name:"Urea (CH\u2084N\u2082O)",xyz:"8\nUrea molecule\nC  0.000000  0.000000  0.000000\nO  0.000000  1.220000  0.000000\nN  1.150000 -0.610000  0.000000\nN -1.150000 -0.610000  0.000000\nH  1.150000 -1.610000  0.000000\nH  2.050000 -0.110000  0.000000\nH -1.150000 -1.610000  0.000000\nH -2.050000 -0.110000  0.000000"},formamide:{name:"Formamide (CH\u2083NO)",xyz:"6\nFormamide molecule\nC  0.000000  0.000000  0.000000\nO  1.220000  0.000000  0.000000\nN -0.610000  1.150000  0.000000\nH -0.610000 -0.950000  0.000000\nH -1.610000  1.150000  0.000000\nH -0.110000  2.050000  0.000000"},methane:{name:"Methane (CH\u2084)",xyz:"5\nMethane molecule\nC  0.000000  0.000000  0.000000\nH  0.629000  0.629000  0.629000\nH -0.629000 -0.629000  0.629000\nH -0.629000  0.629000 -0.629000\nH  0.629000 -0.629000 -0.629000"},ammonia:{name:"Ammonia (NH\u2083)",xyz:"4\nAmmonia molecule\nN  0.000000  0.000000  0.000000\nH  0.000000  0.950000  0.330000\nH  0.820000 -0.480000  0.330000\nH -0.820000 -0.480000  0.330000"},ethylene:{name:"Ethylene (C\u2082H\u2084)",xyz:"6\nEthylene molecule\nC  0.000000  0.000000  0.668000\nC  0.000000  0.000000 -0.668000\nH  0.000000  0.923000  1.232000\nH  0.000000 -0.923000  1.232000\nH  0.000000  0.923000 -1.232000\nH  0.000000 -0.923000 -1.232000"}},Ae=({onFileLoad:e,onValidationChange:t})=>{const[a,n]=(0,s.useState)(""),[r,i]=(0,s.useState)(""),[l,o]=(0,s.useState)(!1),[c,d]=(0,s.useState)("formaldehyde"),[u,m]=(0,s.useState)(!0),[h,p]=(0,s.useState)(""),x=(0,s.useRef)(null),g=(0,s.useRef)(null),f=e=>{try{const t=e.trim().split("\n");if(t.length<3)return{isValid:!1,error:"XYZ file must have at least 3 lines"};const a=parseInt(t[0]);if(isNaN(a)||a<=0)return{isValid:!1,error:"First line must be a positive integer (number of atoms)"};const s=t.slice(2);if(s.length<a)return{isValid:!1,error:`Expected ${a} atom lines, but found ${s.length}`};for(let e=0;e<a;e++){const t=s[e];if(!t||!t.trim())return{isValid:!1,error:`Line ${e+3}: Empty atom line`};const a=t.trim().split(/\s+/);if(a.length<4)return{isValid:!1,error:`Line ${e+3}: Expected element symbol and 3 coordinates`};const n=a[0];if(!/^[A-Z][a-z]?$/.test(n))return{isValid:!1,error:`Line ${e+3}: Invalid element symbol format '${n}'`};for(let s=1;s<=3;s++){const t=parseFloat(a[s]);if(isNaN(t))return{isValid:!1,error:`Line ${e+3}: Invalid coordinate '${a[s]}'`}}}return{isValid:!0}}catch(t){return{isValid:!1,error:"Failed to parse XYZ format: "+t.message}}};(0,s.useEffect)(()=>{const a=Ee.formaldehyde;i(a.xyz),n(""),d("formaldehyde"),m(!0),p(""),e(a.xyz),t&&t(!0)},[]),(0,s.useEffect)(()=>()=>{g.current&&clearTimeout(g.current)},[]);const j=async a=>{const s=a.name.split(".").pop()?.toLowerCase();if("xyz"===s){n(a.name);try{const s=await a.text();i(s);const n=f(s);m(n.isValid),p(n.error||""),n.isValid&&e(s),t&&t(n.isValid,n.error)}catch(r){console.error("Error reading file:",r),alert("Failed to read file: "+r.message)}}else alert("Please upload an XYZ file.")};return(0,Me.jsxs)("div",{className:xe,children:[(0,Me.jsxs)("div",{className:ge,children:[(0,Me.jsx)("label",{className:fe,children:"Example Molecules"}),(0,Me.jsxs)("select",{value:c,onChange:a=>{const s=a.target.value;if(s&&Ee[s]){const a=Ee[s];i(a.xyz),n(""),d(s),m(!0),p(""),e(a.xyz),t&&t(!0),x.current&&(x.current.value="")}},className:je,children:[(0,Me.jsx)("option",{value:"",children:"Select an example..."}),Object.entries(Ee).map(([e,t])=>(0,Me.jsx)("option",{value:e,children:t.name},e))]})]}),(0,Me.jsxs)("div",{className:ve,children:[(0,Me.jsxs)("div",{className:be,children:[(0,Me.jsx)("span",{className:ye,children:"XYZ Coordinates"}),(0,Me.jsxs)("div",{className:Ne,children:[(0,Me.jsx)("button",{onClick:e=>{e.stopPropagation(),x.current?.click()},className:Ce,children:"Browse"}),(a||r)&&(0,Me.jsx)("button",{onClick:()=>{n(""),i(""),d(""),m(!0),p(""),t&&t(!0),x.current&&(x.current.value="")},className:Fe,children:"Clear"})]})]}),(0,Me.jsxs)("div",{className:`${_e} ${l?$e:""} ${u?r.trim()?Se:"":we}`,onDrop:e=>{e.preventDefault(),o(!1);const t=e.dataTransfer.files[0];t&&j(t)},onDragOver:e=>{e.preventDefault(),o(!0)},onDragLeave:()=>{o(!1)},children:[(0,Me.jsx)("textarea",{value:r,onChange:a=>{const s=a.target.value;i(s),n(""),d(""),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{if(s.trim()){const a=f(s);m(a.isValid),p(a.error||""),a.isValid&&e(s),t&&t(a.isValid,a.error)}else m(!0),p(""),t&&t(!0)},300)},placeholder:a?`Loaded: ${a}`:"Select an example molecule above or drag & drop XYZ file here",rows:8,className:ke}),(0,Me.jsx)("input",{ref:x,type:"file",accept:".xyz",onChange:e=>{const t=e.target.files?.[0];t&&j(t)},style:{display:"none"}})]}),!u&&h&&(0,Me.jsx)("div",{className:Oe,children:h})]})]})},ze="section_H6hy",Le="field_rd2A",Ie="checkboxLabel_PBvi",De="disabled_hTIz",Re="fieldDescription_BWzj",Te="advancedButton_mLCF",Be="modal_fyDg",He="modalContent_AwMf",qe="modalHeader_MM0o",Ve="closeButton_DpfQ",Pe="modalBody_OmwJ",Ue="modalFooter_UPoE",Ye="primaryButton_Qg8y",Xe=({settings:e,updateSettings:t,showAdvancedSettings:a,setShowAdvancedSettings:s})=>(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsxs)("div",{className:ze,children:[(0,Me.jsxs)("div",{className:Le,children:[(0,Me.jsx)("label",{children:"Method"}),(0,Me.jsxs)("select",{value:e.method,onChange:e=>t({method:e.target.value}),children:[(0,Me.jsx)("option",{value:"hf",children:"Hartree-Fock"}),(0,Me.jsx)("option",{value:"b3lyp",children:"B3LYP"}),(0,Me.jsx)("option",{value:"pbe",children:"PBE"}),(0,Me.jsx)("option",{value:"pbe0",children:"PBE0"}),(0,Me.jsx)("option",{value:"blyp",children:"BLYP"}),(0,Me.jsx)("option",{value:"wb97x",children:"\u03c9B97X"})]})]}),(0,Me.jsxs)("div",{className:Le,children:[(0,Me.jsx)("label",{children:"Basis Set"}),(0,Me.jsxs)("select",{value:e.basisSet,onChange:e=>t({basisSet:e.target.value}),children:[(0,Me.jsx)("option",{value:"sto-3g",children:"STO-3G"}),(0,Me.jsx)("option",{value:"3-21g",children:"3-21G"}),(0,Me.jsx)("option",{value:"6-31g",children:"6-31G"}),(0,Me.jsx)("option",{value:"6-31g(d,p)",children:"6-31G(d,p)"}),(0,Me.jsx)("option",{value:"def2-svp",children:"def2-SVP"}),(0,Me.jsx)("option",{value:"def2-tzvp",children:"def2-TZVP"}),(0,Me.jsx)("option",{value:"cc-pvdz",children:"cc-pVDZ"})]})]})]}),(0,Me.jsxs)("div",{className:ze,children:[(0,Me.jsx)("div",{className:Le,children:(0,Me.jsxs)("label",{className:Ie,children:[(0,Me.jsx)("input",{type:"checkbox",checked:e.optimize,onChange:e=>t({optimize:e.target.checked})}),(0,Me.jsx)("span",{children:"Optimize Geometry"})]})}),(0,Me.jsx)("div",{className:Le,children:(0,Me.jsxs)("label",{className:`${Ie} ${e.optimize?"":De}`,children:[(0,Me.jsx)("input",{type:"checkbox",checked:e.computeFrequencies,onChange:e=>t({computeFrequencies:e.target.checked}),disabled:!e.optimize}),(0,Me.jsx)("span",{children:"Calculate Frequencies"})]})})]}),(0,Me.jsx)("div",{className:ze,children:(0,Me.jsx)("button",{className:Te,onClick:()=>s(!0),children:"Advanced Settings..."})}),a&&(0,Me.jsx)("div",{className:Be,children:(0,Me.jsxs)("div",{className:He,children:[(0,Me.jsxs)("div",{className:qe,children:[(0,Me.jsx)("h3",{children:"Advanced Settings"}),(0,Me.jsx)("button",{className:Ve,onClick:()=>s(!1),children:"\xd7"})]}),(0,Me.jsxs)("div",{className:Pe,children:[(0,Me.jsxs)("div",{className:Le,children:[(0,Me.jsx)("label",{children:"Charge"}),(0,Me.jsx)("input",{type:"number",min:"-5",max:"5",step:"1",value:e.charge,onChange:e=>t({charge:parseInt(e.target.value)||0})})]}),(0,Me.jsxs)("div",{className:Le,children:[(0,Me.jsx)("label",{children:"Multiplicity"}),(0,Me.jsx)("input",{type:"number",min:"1",max:"7",step:"1",value:e.multiplicity,onChange:e=>t({multiplicity:parseInt(e.target.value)||1})}),(0,Me.jsx)("small",{className:Re,children:"Spin multiplicity (2S+1): 1=singlet, 2=doublet, 3=triplet"})]}),(0,Me.jsxs)("div",{className:Le,children:[(0,Me.jsx)("label",{children:"SCF Max Iterations"}),(0,Me.jsx)("input",{type:"number",min:"10",max:"500",value:e.maxIterations,onChange:e=>t({maxIterations:parseInt(e.target.value)})})]}),(0,Me.jsxs)("div",{className:Le,children:[(0,Me.jsx)("label",{children:"Energy Tolerance"}),(0,Me.jsxs)("select",{value:e.energyTolerance.toString(),onChange:e=>t({energyTolerance:parseFloat(e.target.value)}),children:[(0,Me.jsx)("option",{value:"1e-6",children:"1e-6"}),(0,Me.jsx)("option",{value:"1e-7",children:"1e-7"}),(0,Me.jsx)("option",{value:"1e-8",children:"1e-8"}),(0,Me.jsx)("option",{value:"1e-9",children:"1e-9"}),(0,Me.jsx)("option",{value:"1e-10",children:"1e-10"})]})]}),(0,Me.jsxs)("div",{className:Le,children:[(0,Me.jsx)("label",{children:"Threads"}),(0,Me.jsx)("input",{type:"number",min:"1",max:"16",value:e.threads,onChange:e=>t({threads:parseInt(e.target.value)||1})})]}),(0,Me.jsxs)("div",{className:Le,children:[(0,Me.jsx)("label",{children:"Log Level"}),(0,Me.jsxs)("select",{value:e.logLevel,onChange:e=>t({logLevel:parseInt(e.target.value)}),children:[(0,Me.jsx)("option",{value:"0",children:"Trace"}),(0,Me.jsx)("option",{value:"1",children:"Debug"}),(0,Me.jsx)("option",{value:"2",children:"Info"}),(0,Me.jsx)("option",{value:"3",children:"Warning"}),(0,Me.jsx)("option",{value:"4",children:"Error"})]})]})]}),(0,Me.jsx)("div",{className:Ue,children:(0,Me.jsx)("button",{className:Ye,onClick:()=>s(!1),children:"Done"})})]})})]}),We="modal__pzA",Ze="modalContent_aG6Z",Ge="modalHeader_JId1",Je="closeButton_qY1R",Ke="modalBody_XWx5",Qe="modalFooter_OEJk",et="section_tqM_",tt="field_w4A6",at="checkboxLabel_Phdw",st="fieldDescription_H5rq",nt="vectorInputs_yJTs",rt="vectorField_ln0P",it="primaryButton_mVt0",lt="secondaryButton_V9cE",ot=({settings:e,updateSettings:t,show:a,onClose:s})=>{if(!a)return null;const n=(a,s,n)=>{const r=[...e[a]];r[s]=parseFloat(n)||0,t({[a]:r})};return(0,Me.jsx)("div",{className:We,children:(0,Me.jsxs)("div",{className:Ze,children:[(0,Me.jsxs)("div",{className:Ge,children:[(0,Me.jsx)("h3",{children:"Cube Generation Settings"}),(0,Me.jsx)("button",{className:Je,onClick:s,children:"\xd7"})]}),(0,Me.jsxs)("div",{className:Ke,children:[(0,Me.jsxs)("div",{className:et,children:[(0,Me.jsx)("h4",{children:"Grid Resolution"}),(0,Me.jsxs)("div",{className:tt,children:[(0,Me.jsx)("label",{children:"Grid Steps per Direction"}),(0,Me.jsx)("input",{type:"number",min:"10",max:"200",value:e.gridSteps,onChange:e=>t({gridSteps:parseInt(e.target.value)||50})}),(0,Me.jsx)("small",{className:st,children:"Number of grid points in each direction (default: 50)"})]})]}),(0,Me.jsxs)("div",{className:et,children:[(0,Me.jsx)("h4",{children:"Adaptive Bounds"}),(0,Me.jsxs)("div",{className:tt,children:[(0,Me.jsxs)("label",{className:at,children:[(0,Me.jsx)("input",{type:"checkbox",checked:e.useAdaptive,onChange:e=>t({useAdaptive:e.target.checked})}),(0,Me.jsx)("span",{children:"Use adaptive bounds"})]}),(0,Me.jsx)("small",{className:st,children:"Automatically determine cube size based on density threshold"})]}),e.useAdaptive&&(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsxs)("div",{className:tt,children:[(0,Me.jsx)("label",{children:"Buffer Distance (\xc5)"}),(0,Me.jsx)("input",{type:"number",min:"0.5",max:"10",step:"0.5",value:e.bufferDistance,onChange:e=>t({bufferDistance:parseFloat(e.target.value)||2})}),(0,Me.jsx)("small",{className:st,children:"Extra space around molecule (default: 2.0 \xc5)"})]}),(0,Me.jsxs)("div",{className:tt,children:[(0,Me.jsx)("label",{children:"Density Threshold"}),(0,Me.jsxs)("select",{value:e.threshold.toString(),onChange:e=>t({threshold:parseFloat(e.target.value)}),children:[(0,Me.jsx)("option",{value:"1e-4",children:"1e-4"}),(0,Me.jsx)("option",{value:"1e-5",children:"1e-5 (default)"}),(0,Me.jsx)("option",{value:"1e-6",children:"1e-6"}),(0,Me.jsx)("option",{value:"1e-7",children:"1e-7"}),(0,Me.jsx)("option",{value:"1e-8",children:"1e-8"})]}),(0,Me.jsx)("small",{className:st,children:"Value threshold for determining bounds"})]})]})]}),(0,Me.jsxs)("div",{className:et,children:[(0,Me.jsx)("h4",{children:"Grid Origin"}),(0,Me.jsxs)("div",{className:tt,children:[(0,Me.jsxs)("label",{className:at,children:[(0,Me.jsx)("input",{type:"checkbox",checked:e.customOrigin,onChange:e=>t({customOrigin:e.target.checked})}),(0,Me.jsx)("span",{children:"Set custom origin"})]}),(0,Me.jsx)("small",{className:st,children:"By default, origin is calculated automatically"})]}),e.customOrigin&&(0,Me.jsxs)("div",{className:nt,children:[(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"X"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.origin[0],onChange:e=>n("origin",0,e.target.value)})]}),(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"Y"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.origin[1],onChange:e=>n("origin",1,e.target.value)})]}),(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"Z"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.origin[2],onChange:e=>n("origin",2,e.target.value)})]})]})]}),(0,Me.jsxs)("div",{className:et,children:[(0,Me.jsx)("h4",{children:"Grid Directions"}),(0,Me.jsxs)("div",{className:tt,children:[(0,Me.jsxs)("label",{className:at,children:[(0,Me.jsx)("input",{type:"checkbox",checked:e.customDirections,onChange:e=>t({customDirections:e.target.checked})}),(0,Me.jsx)("span",{children:"Set custom grid vectors"})]}),(0,Me.jsx)("small",{className:st,children:"By default, uses Cartesian axes aligned with molecule"})]}),e.customDirections&&(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsxs)("div",{className:tt,children:[(0,Me.jsx)("label",{children:"Direction A (Bohr)"}),(0,Me.jsxs)("div",{className:nt,children:[(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"X"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.directionA[0],onChange:e=>n("directionA",0,e.target.value)})]}),(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"Y"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.directionA[1],onChange:e=>n("directionA",1,e.target.value)})]}),(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"Z"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.directionA[2],onChange:e=>n("directionA",2,e.target.value)})]})]})]}),(0,Me.jsxs)("div",{className:tt,children:[(0,Me.jsx)("label",{children:"Direction B (Bohr)"}),(0,Me.jsxs)("div",{className:nt,children:[(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"X"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.directionB[0],onChange:e=>n("directionB",0,e.target.value)})]}),(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"Y"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.directionB[1],onChange:e=>n("directionB",1,e.target.value)})]}),(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"Z"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.directionB[2],onChange:e=>n("directionB",2,e.target.value)})]})]})]}),(0,Me.jsxs)("div",{className:tt,children:[(0,Me.jsx)("label",{children:"Direction C (Bohr)"}),(0,Me.jsxs)("div",{className:nt,children:[(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"X"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.directionC[0],onChange:e=>n("directionC",0,e.target.value)})]}),(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"Y"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.directionC[1],onChange:e=>n("directionC",1,e.target.value)})]}),(0,Me.jsxs)("div",{className:rt,children:[(0,Me.jsx)("label",{children:"Z"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:e.directionC[2],onChange:e=>n("directionC",2,e.target.value)})]})]})]})]})]})]}),(0,Me.jsxs)("div",{className:Qe,children:[(0,Me.jsx)("button",{className:lt,onClick:()=>{t({gridSteps:50,useAdaptive:!0,bufferDistance:2,threshold:1e-5,customOrigin:!1,origin:[0,0,0],customDirections:!1,directionA:[0,0,0],directionB:[0,0,0],directionC:[0,0,0]})},children:"Reset to Defaults"}),(0,Me.jsx)("button",{className:it,onClick:s,children:"Apply"})]})]})})},ct="container_R89I",dt="summaryGrid_ag2i",ut="energyCard_YXOX",mt="statusCard_RoU8",ht="propertiesCard_AHmH",pt="primaryEnergy_Xokq",xt="secondaryEnergy_Gl5x",gt="propertyItem_grVF",ft="exportSection_Tufw",jt="exportButtons_Op6D",vt="exportButton_Xvg9",bt="energyValues_pzt_",yt="statusInfo_hd1b",Nt="convergenceStatus_AYcc",Ct="converged_xwWE",_t="notConverged_Y8IO",$t="timing_HvIZ",St="propertyList_aAAD",wt="propertyLabel_Acxr",Ft="propertyValue_OR5o",kt="exportButtonDisabled_HPmD",Ot="noResults_jWfa",Mt="optimizationInfo_faKG",Et="infoItem_rXyy",At=({results:e})=>{if(!e)return(0,Me.jsxs)("div",{className:Ot,children:[(0,Me.jsx)("h3",{children:"No Results Yet"}),(0,Me.jsx)("p",{children:"Run a calculation to see results here."})]});const t=t=>{if(!e.wavefunctionData)return;let a,s,n;switch(t){case"owf":if(!e.wavefunctionData.owfJson)return void alert("Wavefunction data not available.");a=e.wavefunctionData.owfJson,s="wavefunction.owf.json",n="application/json";break;case"fchk":if(!e.wavefunctionData.fchk)return void alert("FCHK data not available.");a=e.wavefunctionData.fchk,s="wavefunction.fchk",n="text/plain";break;case"summary":a=JSON.stringify({energy:e.energy,energyInEV:e.energyInEV,properties:e.properties,numBasisFunctions:e.wavefunctionData.numBasisFunctions,numAtoms:e.wavefunctionData.numAtoms,calculationTime:e.elapsedMs,orbitalEnergies:e.orbitalEnergies?.slice(0,20)},null,2),s="calculation_summary.json",n="application/json"}const r=new Blob([a],{type:n}),i=URL.createObjectURL(r),l=document.createElement("a");l.href=i,l.download=s,l.click(),URL.revokeObjectURL(i)};return(0,Me.jsxs)("div",{className:ct,children:[(0,Me.jsxs)("details",{style:{marginBottom:"1rem",fontSize:"0.8rem",opacity:.7},children:[(0,Me.jsx)("summary",{style:{cursor:"pointer"},children:"Debug Info"}),(0,Me.jsx)("pre",{style:{fontSize:"0.7rem",overflow:"auto",maxHeight:"200px"},children:JSON.stringify({hasWavefunctionData:!!e.wavefunctionData,hasOwfJson:!!e.wavefunctionData?.owfJson,owfJsonLength:e.wavefunctionData?.owfJson?.length,hasFchk:!!e.wavefunctionData?.fchk,hasProperties:!!e.properties,hasOrbitalEnergies:!!e.orbitalEnergies,orbitalEnergiesCount:e.orbitalEnergies?.length,hasOrbitalOccupations:!!e.orbitalOccupations},null,2)})]}),(0,Me.jsxs)("div",{className:dt,children:[(0,Me.jsxs)("div",{className:ut,children:[(0,Me.jsx)("h4",{children:"Total Energy"}),(0,Me.jsxs)("div",{className:bt,children:[(0,Me.jsxs)("div",{className:pt,children:[e.energy.toFixed(8)," Eh"]}),(0,Me.jsxs)("div",{className:xt,children:[e.energyInEV.toFixed(6)," eV"]})]})]}),(0,Me.jsxs)("div",{className:mt,children:[(0,Me.jsx)("h4",{children:"Status"}),(0,Me.jsxs)("div",{className:yt,children:[(0,Me.jsx)("div",{className:`${Nt} ${e.converged?Ct:_t}`,children:e.converged?"\u2713 Converged":"\u2717 Not Converged"}),(0,Me.jsx)("div",{className:$t,children:(a=e.elapsedMs,`${Math.floor(a/1e3)}s ${Math.round(a%1e3)}ms`)})]})]}),e.properties&&(0,Me.jsxs)("div",{className:ht,children:[(0,Me.jsx)("h4",{children:"Key Properties"}),(0,Me.jsxs)("div",{className:St,children:[void 0!==e.properties.homo&&(0,Me.jsxs)("div",{className:gt,children:[(0,Me.jsx)("span",{className:wt,children:"HOMO:"}),(0,Me.jsxs)("span",{className:Ft,children:[e.properties.homo.toFixed(6)," Eh"]})]}),void 0!==e.properties.lumo&&(0,Me.jsxs)("div",{className:gt,children:[(0,Me.jsx)("span",{className:wt,children:"LUMO:"}),(0,Me.jsxs)("span",{className:Ft,children:[e.properties.lumo.toFixed(6)," Eh"]})]}),void 0!==e.properties.gap&&(0,Me.jsxs)("div",{className:gt,children:[(0,Me.jsx)("span",{className:wt,children:"Gap:"}),(0,Me.jsxs)("span",{className:Ft,children:[e.properties.gap.toFixed(6)," Eh"]})]})]})]})]}),e.wavefunctionData&&(0,Me.jsxs)("div",{className:ft,children:[(0,Me.jsx)("h4",{children:"Export Wavefunction"}),(0,Me.jsxs)("div",{className:jt,children:[(0,Me.jsx)("button",{className:e.wavefunctionData.owfJson?vt:`${vt} ${kt}`,onClick:()=>e.wavefunctionData.owfJson?t("owf"):null,disabled:!e.wavefunctionData.owfJson,title:"Download full wavefunction in OCC format",children:"\u2193 OWF.JSON"}),(0,Me.jsx)("button",{className:vt,onClick:()=>t("summary"),title:"Download calculation summary (energy, orbitals, properties)",children:"\u2193 Summary"}),(0,Me.jsxs)("button",{className:e.wavefunctionData.fchk?vt:`${vt} ${kt}`,onClick:()=>e.wavefunctionData.fchk?t("fchk"):alert("FCHK data not available. Check the calculation logs for details."),disabled:!e.wavefunctionData.fchk,title:e.wavefunctionData.fchk?"Download FCHK file":"FCHK generation not yet implemented via CLI",children:["\u2193 FCHK ",!e.wavefunctionData.fchk&&"(N/A)"]})]})]}),e.optimization&&(0,Me.jsxs)("div",{className:ft,children:[(0,Me.jsx)("h4",{children:"Export Optimized Geometry"}),(0,Me.jsx)("div",{className:jt,children:(0,Me.jsx)("button",{className:vt,onClick:()=>{if(!e.optimization?.finalXYZ)return;const t=e.optimization.finalXYZ,a=new Blob([t],{type:"text/plain"}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download="optimized_geometry.xyz",n.click(),URL.revokeObjectURL(s)},title:"Download optimized geometry in XYZ format",children:"\u2193 Optimized XYZ"})}),(0,Me.jsxs)("div",{className:Mt,children:[(0,Me.jsxs)("div",{className:Et,children:[(0,Me.jsx)("span",{children:"Status:"}),(0,Me.jsx)("span",{className:`${Nt} ${e.optimization.trajectory.converged?Ct:_t}`,children:e.optimization.trajectory.converged?"\u2713 Converged":"\u2717 Not Converged"})]}),(0,Me.jsxs)("div",{className:Et,children:[(0,Me.jsx)("span",{children:"Steps:"}),(0,Me.jsx)("span",{children:e.optimization.steps})]}),(0,Me.jsxs)("div",{className:Et,children:[(0,Me.jsx)("span",{children:"Final Energy:"}),(0,Me.jsxs)("span",{children:[e.energy.toFixed(8)," Eh"]})]})]})]})]});var a},zt={container:"container_BYXD",header:"header_RGzB",controls:"controls_Rvup",button:"button_YEOU",buttonActive:"buttonActive_nb5D",logOutput:"logOutput_RpAa",noLogs:"noLogs_oYTM",logEntry:"logEntry_Oa3L",timestamp:"timestamp__Tyr",message:"message_A8Nt","log-debug":"log-debug_cHxc","log-info":"log-info_Lwm5","log-warn":"log-warn_SwuY","log-error":"log-error_TdP2"},Lt=({logs:e})=>{const[t,a]=(0,s.useState)(!0),n=(0,s.useRef)(null);(0,s.useEffect)(()=>{t&&n.current&&(n.current.scrollTop=n.current.scrollHeight)},[e,t]);return(0,Me.jsxs)("div",{className:zt.container,children:[(0,Me.jsxs)("div",{className:zt.header,children:[(0,Me.jsx)("h3",{children:"Calculation Output"}),(0,Me.jsx)("div",{className:zt.controls,children:(0,Me.jsx)("button",{className:`${zt.button} ${t?zt.buttonActive:""}`,onClick:()=>a(!t),children:t?"Auto-scroll ON":"Auto-scroll OFF"})})]}),(0,Me.jsx)("div",{ref:n,className:zt.logOutput,children:0===e.length?(0,Me.jsx)("div",{className:zt.noLogs,children:"No output yet. Run a calculation to see logs."}):e.map((e,t)=>{return(0,Me.jsxs)("div",{className:`${zt.logEntry} ${zt[`log-${e.level}`]}`,children:[(0,Me.jsxs)("span",{className:zt.timestamp,children:["[",(a=e.timestamp,a.toLocaleTimeString()),"]"]}),(0,Me.jsx)("span",{className:zt.message,children:e.message})]},t);var a})})]})},It="matrixContainer__RiK",Dt="header_t7QL",Rt="controls_sj24",Tt="dimensions_G9Ce",Bt="toggleButton_ziSy",Ht="downloadButton_yZ_5",qt="matrixWrapper_lIP_",Vt="matrix_UPd_",Pt="matrixElement_jLaA",Ut="infoContent_XCc5",Yt="fullMatrix_FIje",Xt="zeroElement_VjgC",Wt="truncationNotice_Npk0",Zt="matrixInfo_AD0u",Gt="infoToggle_sbWR",Jt=({matrix:e,title:t,precision:a=6,maxDisplaySize:n=8})=>{const[r,i]=(0,s.useState)(!1),[l,o]=(0,s.useState)(!1);if(!e||!e.data)return(0,Me.jsxs)("div",{className:It,children:[(0,Me.jsx)("h4",{children:t}),(0,Me.jsx)("p",{children:"Matrix data not available"})]});const{rows:c,cols:d,data:u}=e,m=c>n||d>n,h=l?c:Math.min(c,n),p=l?d:Math.min(d,n),x=e=>Math.abs(e)<1e-10?"\xb7":e.toFixed(a);return(0,Me.jsxs)("div",{className:It,children:[(0,Me.jsxs)("div",{className:Dt,children:[(0,Me.jsx)("h4",{children:t}),(0,Me.jsxs)("div",{className:Rt,children:[(0,Me.jsxs)("span",{className:Tt,children:[c," \xd7 ",d]}),m&&(0,Me.jsx)("button",{className:Bt,onClick:()=>o(!l),children:l?"Show Preview":"Show Full"}),(0,Me.jsx)("button",{className:Ht,onClick:()=>{const e=u.map(e=>e.map(e=>x(e)).join(",")).join("\n"),a=new Blob([e],{type:"text/csv"}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download=`${t.toLowerCase().replace(/\s+/g,"_")}_matrix.csv`,n.click(),URL.revokeObjectURL(s)},title:"Download as CSV",children:"\u2193 CSV"})]})]}),(0,Me.jsxs)("div",{className:qt,children:[(0,Me.jsx)("div",{className:`${Vt} ${l?Yt:""}`,style:{gridTemplateColumns:`repeat(${p}, 1fr)`},children:Array.from({length:h},(e,t)=>Array.from({length:p},(e,a)=>{const s=u[t]?.[a]||0,n=x(s),r=Math.abs(s)<1e-10;return(0,Me.jsx)("div",{className:`${Pt} ${r?Xt:""}`,title:`[${t+1},${a+1}] = ${s}`,children:n},`${t}-${a}`)}))}),m&&!l&&(0,Me.jsxs)("div",{className:Wt,children:["Showing ",h," \xd7 ",p," of ",c," \xd7 ",d," matrix"]})]}),(0,Me.jsxs)("div",{className:Zt,children:[(0,Me.jsxs)("button",{className:Gt,onClick:()=>i(!r),children:[r?"\u25bc":"\u25b6"," Matrix Information"]}),r&&(0,Me.jsxs)("div",{className:Ut,children:[(0,Me.jsxs)("div",{children:[(0,Me.jsx)("strong",{children:"Dimensions:"})," ",c," rows \xd7 ",d," columns"]}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("strong",{children:"Total elements:"})," ",c*d]}),u.length>0&&u[0]&&(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsxs)("div",{children:[(0,Me.jsx)("strong",{children:"Max value:"})," ",Math.max(...u.flat()).toFixed(a)]}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("strong",{children:"Min value:"})," ",Math.min(...u.flat()).toFixed(a)]}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("strong",{children:"Trace (diagonal sum):"})," ",u.reduce((e,t,a)=>e+(t[a]||0),0).toFixed(a)]})]})]})]})]})};var Kt=a(7851);const Qt="container_BTtL",ea="header_Zg_R",ta="controls_krEJ",aa="controlButton_kE_9",sa="viewer_MOiN",na="representationControls_JFkt",ra="controlGroup_advN",ia="inlineControlGroup_p0fZ",la="controlLabel_p9ac",oa="controlSelect_wf9l",ca="checkboxLabel_O6nm",da="checkbox_vb0q",ua="numberInput_NZEF",ma="slicePositionControls_XcJh",ha="collapsibleControl_f2QI",pa="controlToggle_IHht",xa="controlContent_BMT8",ga="colorRangeGrid_zP5d",fa="computingIndicator_nVPU",ja="mainContent_hmUM",va="viewerContainer_HOsW",ba="orbitalSidebar_Sjw1",ya="open_VSem",Na="orbitalToggleButton_zhVa",Ca="orbitalSidebarHeader_sOPI",_a="orbitalCloseButton_PBas",$a="moControls_QuQW",Sa="collapsibleSection_wCEA",wa="lightSectionHeader_RRMY",Fa="chevron_qy2f",ka="chevronExpanded_o9bu",Oa="sectionContent_L8gO",Ma="orbitalList_q8AK",Ea="placeholder_XAIu",Aa="loading_XCE6",za="error_fQgs",La="cubeSettingsButton_vqPO",Ia="twoColumnOrbitalContainer_ujH0",Da="orbitalColumn_h5cg",Ra="columnHeader_s2Q2",Ta="orbitalItem_coIp",Ba="orbitalOccupied_2McF",Ha="orbitalVirtual_y4gy",qa="orbitalAlphaOccupied_FxGT",Va="orbitalEnergy_svnX",Pa="orbitalEnergyEV_OrpY",Ua="orbitalLabel_q_Pv",Ya="orbitalAlphaVirtual_xunq",Xa="orbitalBetaOccupied_POcU",Wa="orbitalBetaVirtual_YCwN",Za="orbitalSelected_kMgf",Ga="orbitalContent_ff1A",Ja="spinIcon_0iu1",Ka="orbitalIndicators_GNGS",Qa="orbitalColorIndicator_WBpC",es="orbitalColorPicker_rcrR",ts=({orbital:e,isHOMO:t=!1,isLUMO:a=!1,isSelected:s=!1,colorIndicator:n,onColorChange:r,onClick:i,className:l=""})=>{const o=e.energy/27.2114,c=e.spin?` (${e.spin})`:"";let d=Ta;"alpha"===e.spin?d+=` ${e.isOccupied?qa:Ya}`:"beta"===e.spin?d+=` ${e.isOccupied?Xa:Wa}`:d+=` ${e.isOccupied?Ba:Ha}`,s&&(d+=` ${Za}`),l&&(d+=` ${l}`);const u="alpha"===e.spin?"\u2191":"beta"===e.spin?"\u2193":e.isOccupied&&e.occupation>=2?"\u2191\u2193":e.isOccupied&&e.occupation>=1?"\u2191":null;return(0,Me.jsxs)("div",{className:d,onClick:i,title:`MO ${e.index}${c}: ${e.energy.toFixed(4)} eV (occupation: ${e.occupation})`,style:{cursor:i?"pointer":"default"},children:[(0,Me.jsxs)("div",{className:Ga,children:[(0,Me.jsxs)("div",{className:Va,children:[u&&(0,Me.jsx)("span",{className:Ja,children:u}),o.toFixed(4)," Eh"]}),(0,Me.jsxs)("div",{className:Pa,children:[e.energy.toFixed(4)," eV"]}),(t||a)&&(0,Me.jsx)("div",{className:Ua,children:t?"HOMO":"LUMO"})]}),(0,Me.jsx)("div",{className:Ka,children:n&&(s?(0,Me.jsx)("input",{type:"color",value:n,onChange:e=>{e.stopPropagation(),r?.(e.target.value)},onClick:e=>e.stopPropagation(),className:es,title:`Change color for MO ${e.index}`}):(0,Me.jsx)("div",{className:Qa,style:{backgroundColor:n},title:`Last used color: ${n}`}))})]})},as=({xyzData:e,moleculeName:t="Molecule",wavefunctionResults:a,cubeResults:n,cubeGridInfo:r,cubeSettings:i,onRequestCubeComputation:l,onOpenCubeSettings:o})=>{const c=(0,s.useRef)(null),d=(0,s.useRef)(null),u=(0,s.useRef)(null),m=(0,s.useRef)(null),[h,p]=(0,s.useState)(!1),[x,g]=(0,s.useState)(""),[f,j]=(0,s.useState)("ball+stick"),[v,b]=(0,s.useState)(!0),[y,N]=(0,s.useState)("element"),[C,_]=(0,s.useState)(new Set),[$,S]=(0,s.useState)(.01),[w,F]=(0,s.useState)(!1),[k,O]=(0,s.useState)(1),[M,E]=(0,s.useState)(!1),[A,z]=(0,s.useState)(()=>{try{const e=localStorage.getItem("orbitalColors");if(e){const t=JSON.parse(e);return new Map(Object.entries(t).map(([e,t])=>[parseInt(e),t]))}}catch(x){console.warn("Failed to load orbital colors from localStorage:",x)}return new Map}),[L,I]=(0,s.useState)(i?.gridSteps||50),D=(0,s.useRef)(null),R=(0,s.useRef)(null),[T,B]=(0,s.useState)(!0),[H,q]=(0,s.useState)(!1),V=(0,s.useRef)(null),[P,U]=(0,s.useState)(null),[Y,X]=(0,s.useState)("surface"),[W,Z]=(0,s.useState)(!1),[G,J]=(0,s.useState)("z"),[K,Q]=(0,s.useState)(0),[ee,te]=(0,s.useState)("rwb"),[ae,se]=(0,s.useState)([0,.05]),[ne,re]=(0,s.useState)(!1);(0,s.useEffect)(()=>{i?.gridSteps&&I(i.gridSteps)},[i?.gridSteps]);const ie=()=>"dark"===document.documentElement.getAttribute("data-theme")?"#1b1b1d":"#ffffff";(0,s.useEffect)(()=>{if(!c.current)return;d.current=new Kt.BI(c.current,{backgroundColor:ie(),quality:"medium",clipNear:1e-6,clipFar:100,clipDist:10,fogNear:100,fogFar:100});const e=()=>{d.current&&d.current.handleResize()};window.addEventListener("resize",e);const t=new MutationObserver(()=>{d.current&&d.current.setParameters({backgroundColor:ie()})});return t.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{window.removeEventListener("resize",e),t.disconnect(),d.current&&d.current.dispose()}},[]);const le=()=>{if(!u.current)return;u.current.removeAllRepresentations();const e={colorScheme:y,sele:v?"all":"not hydrogen"};switch(f){case"ball+stick":e.radiusScale=.8,e.bondScale=.3;break;case"line":e.linewidth=2;break;case"spacefill":e.radiusScale=1;break;case"licorice":e.bondScale=.5,e.multipleBond=!0;break;case"surface":e.opacity=.8,e.surfaceType="vws"}u.current.addRepresentation(f,e),d.current?.autoView()};(0,s.useEffect)(()=>{le()},[f,v,y]);const oe=async e=>{if(d.current)try{d.current.removeAllComponents();const a=((e,t)=>{const a=e.trim().split("\n"),s=parseInt(a[0]),n=a[1]||t,r=[];for(let u=2;u<2+s;u++){const e=a[u].trim().split(/\s+/);r.push({element:e[0],x:parseFloat(e[1]),y:parseFloat(e[2]),z:parseFloat(e[3])})}const i={"H-H":.74,"H-C":1.09,"H-N":1.01,"H-O":.96,"H-S":1.34,"C-C":1.54,"C-N":1.47,"C-O":1.43,"C-S":1.82,"N-N":1.45,"N-O":1.4,"N-S":1.68,"O-O":1.48,"O-S":1.66,"S-S":2.05},l=(e,t)=>i[`${e}-${t}`]||i[`${t}-${e}`]||2,o=(e,t)=>{const a=e.x-t.x,s=e.y-t.y,n=e.z-t.z;return Math.sqrt(a*a+s*s+n*n)},c=[];for(let u=0;u<r.length;u++)for(let e=u+1;e<r.length;e++){const t=o(r[u],r[e]),a=l(r[u].element,r[e].element);if(t<=1.3*a){let s=1;t<.85*a&&(s=2),t<.75*a&&(s=3),c.push({atom1:u+1,atom2:e+1,order:s})}}let d=`${n}\n`;return d+="  Generated from XYZ with bond guessing\n",d+="\n",d+=`${s.toString().padStart(3," ")}${c.length.toString().padStart(3," ")}  0  0  0  0  0  0  0  0999 V2000\n`,r.forEach(e=>{const t=e.x.toFixed(4).padStart(10," "),a=e.y.toFixed(4).padStart(10," "),s=e.z.toFixed(4).padStart(10," ");d+=`${t}${a}${s} ${e.element.padEnd(3," ")} 0  0  0  0  0  0  0  0  0  0  0  0\n`}),c.forEach(e=>{d+=`${e.atom1.toString().padStart(3," ")}${e.atom2.toString().padStart(3," ")}${e.order.toString().padStart(3," ")}  0  0  0  0\n`}),d+="M  END\n$$$$\n",d})(e,t),s=new Blob([a],{type:"text/plain"}),n=await d.current.loadFile(s,{ext:"sdf",name:t});u.current=n,le()}catch(a){throw console.error("Error loading geometry:",a),a}};(0,s.useEffect)(()=>{if(!e||!d.current)return;(async()=>{p(!0),g("");try{await oe(e),p(!1)}catch(t){console.error("Error loading molecule:",t),g("Failed to load molecule structure"),p(!1)}})()},[e,t]);const ce=s.useMemo(()=>{if(!a?.orbitalEnergies||!a?.orbitalOccupations)return[];const e=[];if("object"==typeof a.orbitalEnergies&&"isUnrestricted"in a.orbitalEnergies){const t=a.orbitalEnergies,s=a.orbitalOccupations;for(let a=0;a<t.alpha.length;a++){const n=t.alpha[a],r=s.alpha[a]||0;e.push({index:a,energy:27.2114*n,occupation:r,isOccupied:r>0,spin:"alpha"})}for(let a=0;a<t.beta.length;a++){const n=t.beta[a],r=s.beta[a]||0;e.push({index:a,energy:27.2114*n,occupation:r,isOccupied:r>0,spin:"beta"})}}else{const t=a.orbitalEnergies,s=a.orbitalOccupations;for(let a=0;a<t.length;a++){const n=t[a],r=s[a]||0;e.push({index:a,energy:27.2114*n,occupation:r,isOccupied:r>0})}}return e},[a]),de=ce;(0,s.useEffect)(()=>{if(ce.length>0&&l&&C.size>0){const e=[];for(const t of C){const a=ce[t],s=a.spin,r=s?`molecular_orbital_${a.index}_${s}_${L}`:`molecular_orbital_${a.index}_${L}`,i=n?.get(r);i||e.push(t)}e.length>0&&(D.current&&clearTimeout(D.current),D.current=setTimeout(()=>{me(e)},300))}return()=>{D.current&&clearTimeout(D.current),R.current&&clearTimeout(R.current)}},[C,ce.length,n,L]);const ue=(e,t)=>{z(a=>{const s=new Map(a);return s.set(e,t),s}),R.current&&clearTimeout(R.current),C.has(e)&&(R.current=setTimeout(()=>{pe(),R.current=null},50))},me=async e=>{if(l&&d.current){E(!0),g("");try{const t=ce.length-1;for(const a of e){if(a<0||a>t)throw new Error(`Invalid orbital index ${a}. Valid range: 0-${t}`);const e=ce[a],s=e.spin;l("molecular_orbital",e.index,L,s)}}catch(x){console.error("Error requesting MO computation:",x),g("Failed to request molecular orbital computation: "+x.message),E(!1)}}};(0,s.useEffect)(()=>{if(console.log("MO visualization effect triggered:",{selectedOrbitals:C.size,cubeResults:n.size,orbitalRenderStyle:Y,sliceDirection:G,slicePosition:K}),R.current&&(clearTimeout(R.current),R.current=null),!d.current)return;if(0===C.size)return void pe();if(!n)return;Array.from(C).every(e=>{const t=ce[e],a=t?.spin,s=a?`molecular_orbital_${t.index}_${a}_${L}`:`molecular_orbital_${t.index}_${L}`;return n.get(s)})&&(pe(),M&&E(!1))},[n,C,$,w,k,Y,G,K,ee,ae]);const he=(e,t,a)=>(console.log(`Slice position: direction=${t}, position=${a}`),a),pe=async()=>{if(d.current)try{m.current&&(Array.isArray(m.current)?m.current.forEach(e=>{e&&d.current&&d.current.removeComponent(e)}):d.current&&d.current.removeComponent(m.current),m.current=null);const e=[],t=["#4A90E2","#FF8C42","#7B68EE","#32CD32","#FF6B6B","#9B59B6"];if(0===C.size)return m.current=[],void d.current.autoView();for(const[a,s]of Array.from(C).entries()){const r=ce[s],i=r?.spin,l=i?`molecular_orbital_${r.index}_${i}_${L}`:`molecular_orbital_${r.index}_${L}`,o=n?.get(l);if(o){const n=new Blob([o],{type:"text/plain"}),r=await d.current.loadFile(n,{ext:"cube",name:`MO_${s}`});if(r){let n=A.get(s);if(n||(n=t[a%t.length],z(e=>{const t=new Map(e);return t.set(s,n),t})),"surface"===Y)r.addRepresentation("surface",{visible:!0,isolevelType:"value",isolevel:$,color:n,opacity:k,opaqueBack:!1}),w&&r.addRepresentation("surface",{visible:!0,isolevelType:"value",isolevel:-$,color:"red",opacity:k,opaqueBack:!1});else if("wireframe"===Y)r.addRepresentation("surface",{visible:!0,isolevelType:"value",isolevel:$,color:n,opacity:k,wireframe:!0,linewidth:2}),w&&r.addRepresentation("surface",{visible:!0,isolevelType:"value",isolevel:-$,color:"red",opacity:k,wireframe:!0,linewidth:2});else if("dot"===Y)r.addRepresentation("dot",{visible:!0,color:n,opacity:k,dotType:"square",dotSpacing:2,threshold:.001});else if("slice"===Y){const e=he(0,G,K);console.log(`Adding slice representation: direction=${G}, normalizedPos=${K}, coordinatePos=${e}`),r.addRepresentation("slice",{visible:!0,opacity:k,dimension:G,positionType:"coordinate",position:e,thresholdMin:ae[0],thresholdMax:ae[1],thresholdType:"value",colorScheme:ee,colorDomain:ae})}e.push(r)}}}m.current=e,d.current.autoView()}catch(x){console.error("Error visualizing molecular orbitals:",x),g("Failed to visualize molecular orbitals: "+x.message)}},xe=e=>{_(t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})};return(0,s.useEffect)(()=>{(async()=>{if(!d.current)return;if(V.current&&(d.current.removeComponent(V.current),V.current=null),!H)return;let e=null;if(r){const t=r.origin,a=r.steps,s=r.nx,n=r.ny,i=r.nz,l=r.basis;if(t&&a&&s&&n&&i&&l){const a=[[l[0],l[1],l[2]],[l[3],l[4],l[5]],[l[6],l[7],l[8]]],r=[t[0],t[1],t[2]],o=[t[0]+(s-1)*a[0][0]+(n-1)*a[1][0]+(i-1)*a[2][0],t[1]+(s-1)*a[0][1]+(n-1)*a[1][1]+(i-1)*a[2][1],t[2]+(s-1)*a[0][2]+(n-1)*a[1][2]+(i-1)*a[2][2]],c=.529177;e={min:[r[0]*c,r[1]*c,r[2]*c],max:[o[0]*c,o[1]*c,o[2]*c]},console.log("Grid bounds (converted to Angstrom):",e)}}if(e)try{const[t,a,s]=e.min,[n,r,i]=e.max,l=[[t,a,s],[n,a,s],[n,r,s],[t,r,s],[t,a,i],[n,a,i],[n,r,i],[t,r,i]],o=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];let c=`Grid Bounds\n  Generated\n  \n${l.length.toString().padStart(3," ")}${o.length.toString().padStart(3," ")}  0  0  0  0  0  0  0  0999 V2000\n`;l.forEach(([e,t,a])=>{c+=`${e.toFixed(4).padStart(10," ")}${t.toFixed(4).padStart(10," ")}${a.toFixed(4).padStart(10," ")} C   0  0  0  0  0  0  0  0  0  0  0  0\n`}),o.forEach(([e,t])=>{c+=`${(e+1).toString().padStart(3," ")}${(t+1).toString().padStart(3," ")}  1  0  0  0  0\n`}),c+="M  END\n$$$$\n";const u=new Blob([c],{type:"text/plain"}),m=await d.current.loadFile(u,{ext:"mol",name:"Grid_Bounds"});m&&(m.addRepresentation("line",{colorScheme:"uniform",colorValue:"#ff6b6b",linewidth:2,opacity:.7}),V.current=m)}catch(x){console.error("Error creating grid bounds visualization:",x),g("Failed to create grid bounds visualization: "+x.message)}else console.log("No cube grid info available - cannot show accurate grid bounds")})()},[H,r]),(0,s.useEffect)(()=>{try{const e=Object.fromEntries(A);localStorage.setItem("orbitalColors",JSON.stringify(e))}catch(x){console.warn("Failed to save orbital colors to localStorage:",x)}},[A]),e?(0,Me.jsxs)("div",{className:Qt,children:[(0,Me.jsxs)("div",{className:ea,children:[(0,Me.jsx)("h4",{children:"3D Structure & Molecular Orbitals"}),(0,Me.jsxs)("div",{className:ta,children:[(0,Me.jsx)("button",{className:aa,onClick:()=>{d.current&&d.current.autoView()},title:"Reset view",children:"\u2302"}),(0,Me.jsx)("button",{className:aa,onClick:()=>{d.current&&d.current.toggleFullscreen(c.current)},title:"Toggle fullscreen",children:"\u26f6"})]})]}),(0,Me.jsxs)("div",{className:na,children:[(0,Me.jsxs)("div",{className:ia,children:[(0,Me.jsx)("label",{className:la,children:"Style"}),(0,Me.jsxs)("select",{value:f,onChange:e=>j(e.target.value),className:oa,children:[(0,Me.jsx)("option",{value:"ball+stick",children:"Ball & Stick"}),(0,Me.jsx)("option",{value:"line",children:"Line"}),(0,Me.jsx)("option",{value:"spacefill",children:"Space Fill"}),(0,Me.jsx)("option",{value:"licorice",children:"Licorice"}),(0,Me.jsx)("option",{value:"surface",children:"Surface"})]})]}),(0,Me.jsxs)("div",{className:ia,children:[(0,Me.jsx)("label",{className:la,children:"Color"}),(0,Me.jsxs)("select",{value:y,onChange:e=>N(e.target.value),className:oa,children:[(0,Me.jsx)("option",{value:"element",children:"By Element"}),(0,Me.jsx)("option",{value:"uniform",children:"Uniform"}),(0,Me.jsx)("option",{value:"chainname",children:"By Chain"}),(0,Me.jsx)("option",{value:"random",children:"Random"})]})]})]}),(0,Me.jsxs)("div",{className:ja,children:[(0,Me.jsxs)("div",{className:va,children:[x&&(0,Me.jsx)("div",{className:za,children:(0,Me.jsx)("p",{children:x})}),h&&(0,Me.jsx)("div",{className:Aa,children:(0,Me.jsx)("p",{children:"Loading molecule..."})}),(0,Me.jsx)("div",{ref:c,className:sa,style:{opacity:h?.5:1}}),a&&ce.length>0&&(0,Me.jsx)("button",{className:Na,onClick:()=>Z(!W),children:W?"Hide":"Orbitals"})]}),a&&ce.length>0&&(0,Me.jsxs)("div",{className:`${ba} ${W?ya:""}`,children:[(0,Me.jsxs)("div",{className:Ca,children:[(0,Me.jsx)("h5",{children:"Molecular Orbitals"}),(0,Me.jsx)("button",{className:_a,onClick:()=>Z(!1),title:"Close orbital panel",children:"\xd7"})]}),(0,Me.jsxs)("div",{className:Sa,children:[(0,Me.jsxs)("button",{className:wa,onClick:()=>B(!T),children:[(0,Me.jsx)("span",{children:"Settings"}),(0,Me.jsx)("span",{className:`${Fa} ${T?ka:""}`,children:"\u25bc"})]}),T&&(0,Me.jsx)("div",{className:Oa,children:(0,Me.jsxs)("div",{className:$a,children:[(0,Me.jsxs)("div",{className:ra,children:[(0,Me.jsx)("label",{className:la,children:"Style"}),(0,Me.jsxs)("select",{value:Y,onChange:e=>X(e.target.value),className:oa,children:[(0,Me.jsx)("option",{value:"surface",children:"Surface"}),(0,Me.jsx)("option",{value:"wireframe",children:"Wireframe"}),(0,Me.jsx)("option",{value:"dot",children:"Dot Volume"}),(0,Me.jsx)("option",{value:"slice",children:"Slice Volume"})]})]}),("surface"===Y||"wireframe"===Y)&&(0,Me.jsxs)("div",{className:ra,children:[(0,Me.jsx)("label",{className:la,children:"Isovalue"}),(0,Me.jsx)("input",{type:"number",min:"0.001",max:"0.2",step:"0.001",value:$,onChange:e=>S(parseFloat(e.target.value)||.01),className:ua})]}),"slice"===Y&&(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsxs)("div",{className:ra,children:[(0,Me.jsx)("label",{className:la,children:"Slice Direction"}),(0,Me.jsxs)("select",{value:G,onChange:e=>J(e.target.value),className:oa,children:[(0,Me.jsx)("option",{value:"x",children:"X-axis"}),(0,Me.jsx)("option",{value:"y",children:"Y-axis"}),(0,Me.jsx)("option",{value:"z",children:"Z-axis"})]})]}),(0,Me.jsxs)("div",{className:ra,children:[(0,Me.jsx)("label",{className:la,children:"Slice Position"}),(0,Me.jsxs)("div",{className:ma,children:[(0,Me.jsx)("button",{onClick:()=>Q(K-.5),className:aa,title:"Move slice by -0.5",children:"-"}),(0,Me.jsx)("input",{type:"number",step:"0.1",value:K,onChange:e=>Q(parseFloat(e.target.value)||0),className:ua,title:"Slice position in Angstroms"}),(0,Me.jsx)("button",{onClick:()=>Q(K+.5),className:aa,title:"Move slice by +0.5",children:"+"})]})]}),(0,Me.jsxs)("div",{className:ha,children:[(0,Me.jsxs)("button",{className:pa,onClick:()=>re(!ne),children:[(0,Me.jsx)("span",{className:la,children:"Color Range"}),(0,Me.jsx)("span",{className:`${Fa} ${ne?ka:""}`,children:"\u25bc"})]}),ne&&(0,Me.jsx)("div",{className:xa,children:(0,Me.jsxs)("div",{className:ga,children:[(0,Me.jsxs)("div",{className:ra,children:[(0,Me.jsx)("label",{className:la,children:"Minimum"}),(0,Me.jsx)("input",{type:"number",step:"0.01",value:ae[0],onChange:e=>se([parseFloat(e.target.value)||0,ae[1]]),className:ua,title:"Minimum value for color scale"})]}),(0,Me.jsxs)("div",{className:ra,children:[(0,Me.jsx)("label",{className:la,children:"Maximum"}),(0,Me.jsx)("input",{type:"number",step:"0.01",value:ae[1],onChange:e=>se([ae[0],parseFloat(e.target.value)||.05]),className:ua,title:"Maximum value for color scale"})]})]})})]})]}),(0,Me.jsxs)("div",{className:ra,children:[(0,Me.jsx)("label",{className:la,children:"Opacity"}),(0,Me.jsx)("input",{type:"number",min:"0",max:"1",step:"0.05",value:k,onChange:e=>O(parseFloat(e.target.value)||1),className:ua,title:"Orbital surface opacity (0 = transparent, 1 = opaque)"})]}),(0,Me.jsxs)("div",{className:ra,children:[(0,Me.jsx)("label",{className:la,children:"Grid Steps"}),(0,Me.jsx)("input",{type:"number",min:"20",max:"60",step:"5",value:L,onChange:e=>I(parseInt(e.target.value)||40),className:ua,title:"Number of grid points per dimension (higher = more detail, slower)"}),r&&(0,Me.jsxs)("label",{className:ca,children:[(0,Me.jsx)("input",{type:"checkbox",checked:H,onChange:e=>q(e.target.checked),className:da}),"Bounds"]})]}),o&&(0,Me.jsx)("div",{className:ra,children:(0,Me.jsx)("button",{className:La,onClick:o,title:"Advanced cube generation settings",children:"\u2699 Cube Settings..."})}),M&&(0,Me.jsx)("div",{className:ra,children:(0,Me.jsx)("span",{className:fa,children:"Computing MO..."})})]})})]}),(()=>{if(ce.length>0&&void 0!==ce[0].spin){const e=ce.filter(e=>"alpha"===e.spin),t=ce.filter(e=>"beta"===e.spin),a=(Math.max(e.length,t.length),ce.findIndex(e=>"alpha"===e.spin&&e.isOccupied&&!ce.find((t,a)=>a>ce.indexOf(e)&&"alpha"===t.spin&&t.isOccupied))),s=a>=0?ce.findIndex((e,t)=>"alpha"===e.spin&&t>a&&!e.isOccupied):-1,n=ce.findIndex(e=>"beta"===e.spin&&e.isOccupied&&!ce.find((t,a)=>a>ce.indexOf(e)&&"beta"===t.spin&&t.isOccupied)),r=n>=0?ce.findIndex((e,t)=>"beta"===e.spin&&t>n&&!e.isOccupied):-1;return(0,Me.jsx)("div",{className:Ia,children:(0,Me.jsxs)("div",{children:[(0,Me.jsxs)("div",{className:Da,children:[(0,Me.jsx)("div",{className:Ra,title:"Alpha spin (spin up)",children:"\u2191"}),(0,Me.jsx)("div",{children:e.map(e=>{const t=ce.indexOf(e),n=t===a,r=t===s,i=C.has(t),l=A.get(t);return(0,Me.jsx)(ts,{orbital:e,isHOMO:n,isLUMO:r,isSelected:i,colorIndicator:l,onColorChange:e=>ue(t,e),onClick:()=>xe(t)},`alpha-${e.index}`)})})]}),(0,Me.jsxs)("div",{className:Da,children:[(0,Me.jsx)("div",{className:Ra,title:"Beta spin (spin down)",children:"\u2193"}),(0,Me.jsx)("div",{children:t.map(e=>{const t=ce.indexOf(e),a=t===n,s=t===r,i=C.has(t),l=A.get(t);return(0,Me.jsx)(ts,{orbital:e,isHOMO:a,isLUMO:s,isSelected:i,colorIndicator:l,onColorChange:e=>ue(t,e),onClick:()=>xe(t)},`beta-${e.index}`)})})]})]})})}return(0,Me.jsx)("div",{className:Ma,children:de.map((e,t)=>{const a=ce.findIndex((e,t)=>e.isOccupied&&(!ce[t+1]||!ce[t+1].isOccupied)),s=t===a,n=t===(a>=0?a+1:-1),r=C.has(t),i=A.get(t);return(0,Me.jsx)(ts,{orbital:e,isHOMO:s,isLUMO:n,isSelected:r,colorIndicator:i,onColorChange:e=>ue(t,e),onClick:()=>xe(t)},e.index)})})})()]})]})]}):(0,Me.jsx)("div",{className:Qt,children:(0,Me.jsxs)("div",{className:Ea,children:[(0,Me.jsx)("h4",{children:"Molecule Viewer"}),(0,Me.jsx)("p",{children:"Load a molecule to see its 3D structure"})]})})};var ss=a(6370);class ns{static DEFAULT_FRAMES=20;static DEFAULT_AMPLITUDE=.3;static precomputeAllTrajectories(e,t,a,s){const n=new Map;return t.forEach((t,r)=>{const i=a[r],l=i&&i.length>0?this.generateTrajectory(e,i,t,r,s):this.createPlaceholderTrajectory(e,t,r);n.set(r,l)}),n}static generateTrajectory(e,t,a,s,n){const r=n?.frames??this.DEFAULT_FRAMES,i=n?.amplitude??this.DEFAULT_AMPLITUDE,{numAtoms:l,atoms:o}=this.parseGeometry(e);if(!o.length)return"";const c=[];for(let d=0;d<r;d++){const e=2*Math.PI*d/r,n=i*Math.sin(e),l=this.createFrame(o,t,n,a,s);c.push(l)}return c.join("\n")}static createPlaceholderTrajectory(e,t,a){const s=e.trim().split("\n"),n=parseInt(s[0]),r=[];for(let i=0;i<5;i++){const e=[n.toString()];e.push(`Mode ${a+1}: ${Math.abs(t).toFixed(2)} cm\u207b\xb9 (normal mode data unavailable)`);for(let t=2;t<s.length;t++)e.push(s[t]);r.push(e.join("\n"))}return r.join("\n")}static parseGeometry(e){const t=e.trim().split("\n"),a=parseInt(t[0]);if(t.length<a+2)return{numAtoms:0,atoms:[]};const s=[];for(let n=2;n<2+a;n++){const e=t[n].trim().split(/\s+/);s.push({element:e[0],x:parseFloat(e[1]),y:parseFloat(e[2]),z:parseFloat(e[3])})}return{numAtoms:a,atoms:s}}static createFrame(e,t,a,s,n){const r=[e.length.toString()];r.push(`Mode ${n+1}: ${Math.abs(s).toFixed(2)} cm\u207b\xb9 ${s<0?"(imaginary)":""}`);for(let i=0;i<e.length;i++){const s=e[i],n=t[3*i]||0,l=t[3*i+1]||0,o=t[3*i+2]||0,c=s.x+a*n,d=s.y+a*l,u=s.z+a*o;r.push(`${s.element}  ${c.toFixed(6)}  ${d.toFixed(6)}  ${u.toFixed(6)}`)}return r.join("\n")}}const rs=()=>{const[e,t]=(0,s.useState)(null),[n,xe]=(0,s.useState)(!1),[ge,fe]=(0,s.useState)(""),[je,ve]=(0,s.useState)(null),[be,ye]=(0,s.useState)(!1),[Ne,Ce]=(0,s.useState)(null),[_e,$e]=(0,s.useState)([]),[Se,we]=(0,s.useState)("structure"),[Fe,ke]=(0,s.useState)(""),[Oe,Ee]=(0,s.useState)(""),[ze,Le]=(0,s.useState)(new Map),[Ie,De]=(0,s.useState)(null),[Re,Te]=(0,s.useState)(!0),[Be,He]=(0,s.useState)(null),[qe,Ve]=(0,s.useState)(!0),[Pe,Ue]=(0,s.useState)(!0),[Ye,We]=(0,s.useState)(!1),[Ze,Ge]=(0,s.useState)({method:"hf",basisSet:"3-21g",charge:0,multiplicity:1,optimize:!1,computeFrequencies:!1,maxIterations:100,energyTolerance:1e-8,threads:1,logLevel:2}),[Je,Ke]=(0,s.useState)({gridSteps:50,useAdaptive:!0,bufferDistance:2,threshold:1e-5,customOrigin:!1,origin:[0,0,0],customDirections:!1,directionA:[0,0,0],directionB:[0,0,0],directionC:[0,0,0]}),[Qe,et]=(0,s.useState)(!1),[tt,at]=(0,s.useState)("optimization"),[st,nt]=(0,s.useState)(null),[rt,it]=(0,s.useState)(!0),[lt,ct]=(0,s.useState)(!0),[dt,ut]=(0,s.useState)(new Map);(0,s.useEffect)(()=>(mt(),()=>{e&&e.terminate()}),[]);const mt=async()=>{try{const e=new Worker(new URL(a.p+a.u(610),a.b),{type:void 0});e.onmessage=ht,e.onerror=e=>{console.error("Worker error:",e),ke("Worker error: "+e.message),xe(!1)},t(e),e.postMessage({type:"init",data:{}})}catch(Fe){console.error("Failed to initialize worker:",Fe),ke("Failed to initialize Web Worker: "+Fe.message)}},ht=e=>{const{type:t,...a}=e.data;switch(t){case"initialized":a.success?(xe(!0),xt("Worker initialized successfully","info")):(xe(!1),ke("Worker initialization failed: "+a.error));break;case"log":xt(a.message,pt(a.level));break;case"progress":xt(a.message,"info"),"complete"===a.stage&&ye(!1);break;case"result":gt(a);break;case"optimization_progress":xt(a.message,"info");break;case"cubeResult":ft(a);break;case"error":console.error("Worker error:",a.error),ke("Calculation error: "+a.error),ye(!1)}},pt=e=>{switch(e){case 0:case 1:return"debug";case 2:default:return"info";case 3:return"warn";case 4:case 5:return"error"}},xt=(e,t)=>{$e(a=>[...a,{message:e,level:t,timestamp:new Date}])},gt=e=>{ye(!1),e.success?(Ce(e.results),we("results"),xt("Calculation completed successfully!","info"),e.results.frequencies?.frequencies&&e.results.optimization?.finalXYZ?(xt(`Found frequency data: ${e.results.frequencies.frequencies.length} frequencies, normalModes: ${e.results.frequencies.normalModes?"available":"missing"}`,"info"),jt(e.results)):xt("No frequency data or optimized geometry available for trajectory pre-computation","info")):ke("Calculation failed: "+e.error)},ft=e=>{if(e.success){let t;t="molecular_orbital"===e.cubeType?e.spin?`${e.cubeType}_${e.orbitalIndex}_${e.spin}_${e.gridSteps||40}`:`${e.cubeType}_${e.orbitalIndex}_${e.gridSteps||40}`:e.cubeType,Le(a=>new Map(a.set(t,e.cubeData))),e.gridInfo&&De(e.gridInfo);const a=e.spin?` (${e.spin})`:"";xt(`Cube computation completed: ${e.cubeType}${void 0!==e.orbitalIndex?` (orbital ${e.orbitalIndex}${a})`:""} [${e.gridSteps||40} steps]`,"info")}else ke(`Cube computation failed: ${e.error}`),xt(`Cube computation failed: ${e.error}`,"error")},jt=e=>{if(!e.frequencies?.frequencies||!e.optimization?.finalXYZ)return;xt("Pre-computing normal mode trajectories...","info");const t=ns.precomputeAllTrajectories(e.optimization.finalXYZ,e.frequencies.frequencies,e.frequencies.normalModes||[]);ut(t),xt(`Pre-computed ${t.size} normal mode trajectories`,"info")},vt=()=>Ne?.frequencies?.frequencies?Ne.frequencies.frequencies.map((e,t)=>({freq:e,index:t})).filter(({freq:e})=>!rt||Math.abs(e)>=50):[];return(0,Me.jsxs)("div",{className:r,children:[(0,Me.jsxs)("div",{className:i,children:[(0,Me.jsxs)("div",{className:l,children:[(0,Me.jsx)("div",{className:`${j} ${n?b:v}`,children:n?"\u2713 Ready":"\u23f3 Loading..."}),(0,Me.jsxs)("div",{className:C,children:[(0,Me.jsxs)("div",{className:m,children:[(0,Me.jsxs)("button",{className:h,onClick:()=>Ve(!qe),children:[(0,Me.jsx)("span",{className:p,children:"Molecule Input"}),(0,Me.jsx)("span",{className:`${x} ${qe?f:""}`,children:"\u25bc"})]}),qe&&(0,Me.jsxs)("div",{className:g,children:[(0,Me.jsx)(Ae,{onFileLoad:e=>{fe(e),Le(new Map),Ce(null),ke(""),we("structure"),Ee("");try{const t=e.trim().split("\n"),a=parseInt(t[0]),s=t[1]||"Loaded Molecule",n=new Map;for(let e=2;e<2+a;e++){const a=t[e].trim().split(/\s+/)[0];n.set(a,(n.get(a)||0)+1)}const r=Array.from(n.entries()).map(([e,t])=>t>1?`${e}${t}`:e).join("");ve({name:s,formula:r,numAtoms:a}),xt(`Molecule loaded: ${r} (${a} atoms) - cleared orbital cache`,"info")}catch(Fe){console.error("Error parsing XYZ:",Fe)}},onValidationChange:(e,t)=>{Te(e),Ee(!e&&t?t:"")}}),je&&(0,Me.jsx)("div",{className:y,children:(0,Me.jsxs)("div",{children:[(0,Me.jsx)("strong",{children:je.formula})," (",je.numAtoms," atoms)"]})})]})]}),ge&&(0,Me.jsxs)("div",{className:m,children:[(0,Me.jsxs)("button",{className:h,onClick:()=>Ue(!Pe),children:[(0,Me.jsx)("span",{className:p,children:"Calculation Settings"}),(0,Me.jsx)("span",{className:`${x} ${Pe?f:""}`,children:"\u25bc"})]}),Pe&&(0,Me.jsx)("div",{className:g,children:(0,Me.jsx)(Xe,{settings:Ze,updateSettings:e=>{Ge(t=>{const a={...t,...e};return"optimize"in e&&!e.optimize&&(a.computeFrequencies=!1),a})},showAdvancedSettings:Ye,setShowAdvancedSettings:We})})]})]}),ge&&(0,Me.jsxs)("div",{className:_,children:[(0,Me.jsx)("button",{className:`${N} ${$}`,onClick:()=>{if(!ge)return void ke("Please load a molecule first.");if(!Re)return;Ce(null),$e([]),we("output"),ye(!0),ut(new Map),xt("Starting calculation via CLI...","info");const e=new Worker("/occ-cli-worker.js");let t="",a=!1;e.onmessage=s=>{const{type:n,text:r,code:i,files:l,stdout:o}=s.data;switch(n){case"ready":xt("CLI worker ready, executing command...","info");break;case"output":t+=r+"\n",xt(r,"info");break;case"error":t+=r+"\n",xt(r,"error");break;case"exit":if(a)return;if(a=!0,0!==i)return ke(`Calculation failed with exit code ${i}`),ye(!1),void e.terminate();xt("Calculation completed, parsing results...","info");try{const e=o.match(/total\s+([-\d.]+)/);if(!e)throw new Error("Could not parse energy from output");const t=parseFloat(e[1]),a=o.match(/converged after ([\d.]+) seconds/),s=null!==a,n=a?1e3*parseFloat(a[1]):0,r=Object.keys(l).find(e=>e.endsWith(".owf.json"));if(!r)throw new Error("No .owf.json file found in output");const i=l[r];xt(`Found wavefunction file: ${r} (${i.length} bytes)`,"info"),He(i);const u=(new TextDecoder).decode(i);let m;xt("Parsing wavefunction JSON...","info");try{m=JSON.parse(u),xt(`Parsed owf.json keys: ${Object.keys(m).join(", ")}`,"info")}catch(c){throw xt(`Failed to parse owf.json: ${c.message}`,"error"),c}const h={energy:t,energyInEV:27.2114*t,elapsedMs:n,converged:s},p=m["molecular orbitals"];xt("Molecular orbitals object: "+(p?"found":"missing"),"info"),p&&xt(`MO keys: ${Object.keys(p).join(", ")}`,"info");const x=p&&"unrestricted"===p["spinorbital kind"];if(xt("Calculation type: "+(x?"unrestricted":"restricted"),"info"),x){const e=p["orbital energies"];if(e&&Array.isArray(e)){const t=e.length/2,a=e.slice(0,t).map(e=>Number(e)),s=e.slice(t).map(e=>Number(e));h.orbitalEnergies={alpha:a,beta:s,isUnrestricted:!0},xt(`Found ${a.length} alpha and ${s.length} beta orbital energies (stacked format)`,"info")}else xt("No orbital energies found for unrestricted calculation","warn")}else{const e=p?p["orbital energies"]:null;e?(h.orbitalEnergies=e,xt(`Found ${e.length} orbital energies`,"info")):xt("No energies found in MO object","warn")}if(p){const e=p["alpha electrons"]||0,t=p["beta electrons"]||0;if(x&&h.orbitalEnergies?.isUnrestricted){const a=h.orbitalEnergies.alpha,s=h.orbitalEnergies.beta;h.orbitalOccupations={alpha:a.map((t,a)=>a<e?1:0),beta:s.map((e,a)=>a<t?1:0),isUnrestricted:!0},xt(`Set alpha/beta occupations: ${e} alpha, ${t} beta electrons`,"info");const n=e>0&&e<=a.length?a[e-1]:null,r=e<a.length?a[e]:null,i=t>0&&t<=s.length?s[t-1]:null,l=t<s.length?s[t]:null;h.properties={alphaHOMO:null!=n?27.2114*n:void 0,alphaLUMO:null!=r?27.2114*r:void 0,betaHOMO:null!=i?27.2114*i:void 0,betaLUMO:null!=l?27.2114*l:void 0,isUnrestricted:!0},null!=n&&xt(`Alpha HOMO: ${n.toFixed(6)} Ha (${(27.2114*n).toFixed(4)} eV)`,"info"),null!=r&&xt(`Alpha LUMO: ${r.toFixed(6)} Ha (${(27.2114*r).toFixed(4)} eV)`,"info"),null!=i&&xt(`Beta HOMO: ${i.toFixed(6)} Ha (${(27.2114*i).toFixed(4)} eV)`,"info"),null!=l&&xt(`Beta LUMO: ${l.toFixed(6)} Ha (${(27.2114*l).toFixed(4)} eV)`,"info")}else if(h.orbitalEnergies&&Array.isArray(h.orbitalEnergies)){const a=h.orbitalEnergies,s=[];for(let n=0;n<a.length;n++)n<Math.min(e,t)?s.push(2):n<Math.max(e,t)?s.push(1):s.push(0);if(h.orbitalOccupations=s,xt(`Set orbital occupations based on ${e} alpha and ${t} beta electrons`,"info"),a.length>0){const s=Math.max(e,t)-1,n=s+1;if(s>=0&&s<a.length){const e=parseFloat(a[s]),t=n<a.length?parseFloat(a[n]):null;isNaN(e)||(h.properties={homo:27.2114*e,lumo:t&&!isNaN(t)?27.2114*t:void 0,gap:t&&!isNaN(t)?27.2114*(t-e):void 0},xt(`HOMO: ${e.toFixed(6)} Ha (${(27.2114*e).toFixed(4)} eV)`,"info"),t&&!isNaN(t)&&(xt(`LUMO: ${t.toFixed(6)} Ha (${(27.2114*t).toFixed(4)} eV)`,"info"),xt(`Gap: ${(27.2114*(t-e)).toFixed(4)} eV`,"info")))}}}}if(m.atoms&&p){const e=m["basis functions"]||[];h.wavefunctionData={numBasisFunctions:e.length||0,numAtoms:m.atoms.length||0,nAlpha:p["alpha electrons"]||0,nBeta:p["beta electrons"]||0,owfJson:u},xt("Stored wavefunction metadata","info")}else xt(`Warning: Missing atoms or mo in owf.json. Has atoms: ${!!m.atoms}, Has mo: ${!!p}`,"warn");try{h.matrices={};const e=e=>({rows:e.length,cols:e[0]?.length||0,data:e}),t=p["orbital energies"]?.length||0;if(xt(`Number of basis functions: ${t}`,"info"),m["kinetic energy matrix"]){const t=m["kinetic energy matrix"];Array.isArray(t)&&t.length>0&&Array.isArray(t[0])&&(h.matrices.kinetic=e(t),xt(`Extracted kinetic energy matrix (${t.length}\xd7${t[0].length})`,"info"))}if(m["nuclear attraction matrix"]){const t=m["nuclear attraction matrix"];Array.isArray(t)&&t.length>0&&Array.isArray(t[0])&&(h.matrices.nuclear=e(t),xt(`Extracted nuclear attraction matrix (${t.length}\xd7${t[0].length})`,"info"))}let a=null;if(m["overlap matrix"]?a=m["overlap matrix"]:m["orbital basis"]?.["overlap matrix"]?a=m["orbital basis"]["overlap matrix"]:p["overlap matrix"]&&(a=p["overlap matrix"]),a&&Array.isArray(a)&&a.length>0&&Array.isArray(a[0])?(h.matrices.overlap=e(a),xt(`Extracted overlap matrix (${a.length}\xd7${a[0].length})`,"info")):xt("Overlap matrix not found in OWF JSON","warn"),p["density matrix"]){const t=p["density matrix"];Array.isArray(t)&&t.length>0&&Array.isArray(t[0])&&(h.matrices.density=e(t),xt(`Extracted density matrix (${t.length}\xd7${t[0].length})`,"info"))}if(p["orbital coefficients"]){const t=p["orbital coefficients"];Array.isArray(t)&&t.length>0&&Array.isArray(t[0])&&(h.matrices.coefficients=e(t),xt(`Extracted MO coefficients matrix (${t.length}\xd7${t[0].length})`,"info"))}const s=Object.keys(h.matrices).length;s>0?xt(`Extracted ${s} matrices from wavefunction data`,"info"):xt("No matrices found in wavefunction data","warn")}catch(d){xt(`Warning: Failed to extract matrices: ${d.message}`,"warn")}const g=Object.keys(l).find(e=>e.endsWith(".owf.fchk")||e.endsWith(".fchk"));if(g){const e=l[g],t=(new TextDecoder).decode(e);xt(`Found FCHK file: ${g} (${e.length} bytes)`,"info"),h.wavefunctionData&&(h.wavefunctionData.fchk=t)}else xt("Warning: No FCHK file found in output","warn");const f=Object.keys(l).find(e=>e.endsWith("_trj.xyz")),j=Object.keys(l).find(e=>e.endsWith("_opt.xyz"));if(f&&j){xt(`Found optimization files: ${f}, ${j}`,"info");try{const e=(new TextDecoder).decode(l[f]),a=(new TextDecoder).decode(l[j]),n=e.trim().split(/\n(?=\d+\n)/),r=[],i=[],o=[];for(const t of n){if(!t.trim())continue;r.push(t.trim());const e=t.trim().split("\n");if(e.length>=2){const t=e[1],a=t.match(/energy[=:\s]+([-\d.]+)/i);a&&i.push(parseFloat(a[1]));const s=t.match(/grad(?:ient)?[=:\s]+([-\d.]+)/i);s&&o.push(parseFloat(s[1]))}}h.optimization={trajectory:{energies:i.length>0?i:[t],gradientNorms:o,geometries:r,converged:s,steps:r.length,finalEnergy:t,finalMolecule:null},finalXYZ:a,steps:r.length,energies:i.length>0?i:[t],gradientNorms:o},xt(`Parsed optimization trajectory: ${r.length} steps`,"info")}catch(c){xt(`Warning: Failed to parse optimization files: ${c.message}`,"warn")}}const v=Object.keys(l).find(e=>e.endsWith("_freq.json"));if(v){xt(`Found frequency file: ${v}`,"info");try{const e=(new TextDecoder).decode(l[v]),t=JSON.parse(e);xt(`Frequency JSON keys: ${Object.keys(t).join(", ")}`,"info");const a=t.frequencies_cm||t.sorted_frequencies_cm||[],s=t.normal_modes||[],n=t.n_atoms||m.atoms?.length||0,r=t.n_modes||a.length,i=a.map(e=>Array.isArray(e)?e[0]:e),o=[];if(Array.isArray(s)&&s.length>0&&r>0)if(Array.isArray(s[0])){const e=s.length,t=s[0].length;xt(`Normal modes matrix: ${e} rows \xd7 ${t} cols`,"info");for(let a=0;a<t;a++){const t=[];for(let n=0;n<e;n++)t.push(s[n][a]);o.push(t)}}else xt("Warning: normal_modes is not a 2D array","warn");if(i.length>0){h.frequencies={frequencies:i,nModes:r,nAtoms:n,summary:`${i.length} vibrational modes`,normalModes:o},xt(`Parsed ${i.length} vibrational frequencies`,"info");const e=i.slice(0,5).map(e=>e<0?`${Math.abs(e).toFixed(1)}i`:e.toFixed(1)).join(", ");xt(`First frequencies: ${e} cm\u207b\xb9`,"info"),o.length>0?xt(`Parsed ${o.length} normal modes (${o[0].length} elements each)`,"info"):xt("Warning: No normal mode data found","warn")}else xt("Warning: No frequencies found in frequency JSON","warn")}catch(c){xt(`Warning: Failed to parse frequency file: ${c.message}`,"warn")}}Ce(h),we("results"),xt(`Energy: ${t.toFixed(8)} Ha (${(27.2114*t).toFixed(4)} eV)`,"info"),xt("Calculation completed successfully!","info")}catch(Fe){ke(`Failed to parse results: ${Fe.message}`),xt(`Error: ${Fe.message}`,"error")}ye(!1),e.terminate()}},e.onerror=t=>{ke(`CLI worker error: ${t.message}`),ye(!1),e.terminate()};const s={xyzData:ge,method:Ze.method,basis:Ze.basisSet,charge:Ze.charge,multiplicity:Ze.multiplicity,threads:Ze.threads};Ze.optimize&&(s.optMaxIterations=50,xt("Optimization enabled (max 50 steps)","info")),Ze.computeFrequencies&&Ze.optimize&&(s.computeFrequencies=!0,xt("Frequency calculation enabled","info"));let n=`occ scf input.xyz ${Ze.method} ${Ze.basisSet}`;0!==Ze.charge&&(n+=` --charge ${Ze.charge}`),1!==Ze.multiplicity&&(n+=` --multiplicity ${Ze.multiplicity}`),Ze.optimize&&(n+=" --opt-max-iterations 50"),Ze.computeFrequencies&&Ze.optimize&&(n+=" --frequencies"),n+=` --threads=${Ze.threads}`,n+=" -o json -o fchk",xt(`Running: ${n}`,"info"),e.postMessage(s)},disabled:be||!n||!Re,children:be?"Calculating...":"Run Calculation"}),be&&(0,Me.jsx)("button",{className:`${N} ${S}`,onClick:()=>{e&&be&&(e.terminate(),xt("Calculation cancelled. Restarting worker...","warn"),mt(),ye(!1))},children:"Cancel"})]})]}),(0,Me.jsxs)("div",{className:o,children:[ge&&(0,Me.jsxs)("div",{className:c,children:[(0,Me.jsx)("button",{className:`${d} ${"output"===Se?w:""}`,onClick:()=>we("output"),children:"Output"}),(0,Me.jsx)("button",{className:`${d} ${"results"===Se?w:""}`,onClick:()=>we("results"),children:"Results"}),(0,Me.jsx)("button",{className:`${d} ${"structure"===Se?w:""}`,onClick:()=>we("structure"),children:"Structure"}),(0,Me.jsx)("button",{className:`${d} ${"properties"===Se?w:""}`,onClick:()=>we("properties"),children:"Properties"}),Ne?.optimization&&(0,Me.jsx)("button",{className:`${d} ${"optimization"===Se?w:""}`,onClick:()=>we("optimization"),children:"Optimization"})]}),(0,Me.jsxs)("div",{className:u,children:["output"===Se&&(0,Me.jsx)(Lt,{logs:_e}),"results"===Se&&(0,Me.jsx)(At,{results:Ne}),"structure"===Se&&(0,Me.jsx)("div",{className:k,children:ge?(0,Me.jsx)(as,{xyzData:Ne?.optimization?.finalXYZ?Ne.optimization.finalXYZ:ge,moleculeName:`${je?.name||"Molecule"}${Ne?.optimization?" (Optimized)":""}`,wavefunctionResults:Ne,cubeResults:ze,cubeGridInfo:Ie,cubeSettings:Je,onRequestCubeComputation:(e,t,a,s)=>{if(!Be)return void ke("No wavefunction data available for cube computation.");xt(`Requesting ${e} cube via CLI...`,"info");const n=new Worker("/occ-cli-worker.js");let r=!1;n.onmessage=s=>{const{type:i,text:l,code:o,cubeData:c,gridInfo:d,property:u,orbital:m,spin:h}=s.data;switch(i){case"output":xt(`[CUBE] ${l}`,"info");break;case"error":xt(`[CUBE ERROR] ${l}`,"error");break;case"exit":if(r)return;if(r=!0,0!==o||!c)return ke(`Cube generation failed with exit code ${o}`),xt("Cube generation failed","error"),void n.terminate();const s=a||Je.gridSteps;let i;i=void 0!==t?h?`molecular_orbital_${t}_${h}_${s}`:`molecular_orbital_${t}_${s}`:e,Le(e=>new Map(e.set(i,c))),d&&(De(d),xt(`Grid info: ${d.nx}\xd7${d.ny}\xd7${d.nz} points`,"info"));xt(`Cube computation completed: ${u}${void 0!==m?` (orbital ${m}${h?` (${h})`:""})`:""}`,"info"),n.terminate()}},n.onerror=e=>{ke(`Cube worker error: ${e.message}`),n.terminate()};let i="density",l=null,o=s||null;"molecular_orbital"===e&&void 0!==t?(i="density",l=(t+1).toString()):"electron_density"===e?i="density":"electric_potential"===e&&(i="esp");const c=a||Je.gridSteps,d={command:"cube",owfData:Be,property:i,orbital:l,spin:o,gridSteps:c};Je.useAdaptive&&(d.adaptive=!0,d.bufferDistance=Je.bufferDistance,d.threshold=Je.threshold),Je.customOrigin&&(d.origin=Je.origin),Je.customDirections&&(d.directionA=Je.directionA,d.directionB=Je.directionB,d.directionC=Je.directionC);let u=`occ cube input.owf.json ${i}`;o&&(u+=` ${o}`),l&&(u+=` --orbital ${l}`),u+=` -n ${c}`,Je.useAdaptive&&(u+=` --adaptive --buffer ${Je.bufferDistance} --threshold ${Je.threshold}`),Je.customOrigin&&(u+=` --origin ${Je.origin.join(" ")}`),Je.customDirections&&(u+=` --da ${Je.directionA.join(" ")}`,u+=` --db ${Je.directionB.join(" ")}`,u+=` --dc ${Je.directionC.join(" ")}`),xt(`Running: ${u}`,"info"),n.postMessage(d)},onOpenCubeSettings:()=>et(!0)}):(0,Me.jsxs)("div",{className:O,children:[(0,Me.jsx)("h3",{children:"No Structure Loaded"}),(0,Me.jsx)("p",{children:"Load a molecule to see its 3D structure visualization."})]})}),"properties"===Se&&Ne&&(0,Me.jsxs)("div",{className:F,children:[Ne.orbitalEnergies&&(0,Me.jsxs)("div",{className:A,children:[(0,Me.jsx)("h4",{children:"Orbital Energies"}),Ne.orbitalEnergies.isUnrestricted?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)("h5",{style:{marginTop:"1rem",color:"#3b82f6"},children:"Alpha Orbitals (\u2191)"}),(0,Me.jsx)("div",{className:z,children:Ne.orbitalEnergies.alpha.slice(0,10).map((e,t)=>{const a=Ne.orbitalOccupations?.alpha?.[t]??0,s={index:t,energy:27.2114*e,occupation:a,isOccupied:a>0,spin:"alpha"};return(0,Me.jsx)(ts,{orbital:s},`alpha-${t}`)})}),Ne.orbitalEnergies.alpha.length>10&&(0,Me.jsxs)("div",{className:L,children:["... and ",Ne.orbitalEnergies.alpha.length-10," more alpha orbitals"]}),(0,Me.jsx)("h5",{style:{marginTop:"1.5rem",color:"#f97316"},children:"Beta Orbitals (\u2193)"}),(0,Me.jsx)("div",{className:z,children:Ne.orbitalEnergies.beta.slice(0,10).map((e,t)=>{const a=Ne.orbitalOccupations?.beta?.[t]??0,s={index:t,energy:27.2114*e,occupation:a,isOccupied:a>0,spin:"beta"};return(0,Me.jsx)(ts,{orbital:s},`beta-${t}`)})}),Ne.orbitalEnergies.beta.length>10&&(0,Me.jsxs)("div",{className:L,children:["... and ",Ne.orbitalEnergies.beta.length-10," more beta orbitals"]})]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)("div",{className:z,children:Ne.orbitalEnergies.slice(0,20).map((e,t)=>{const a=Ne.orbitalOccupations?.[t]??0,s={index:t,energy:27.2114*e,occupation:a,isOccupied:a>0};return(0,Me.jsx)(ts,{orbital:s},t)})}),Ne.orbitalEnergies.length>20&&(0,Me.jsxs)("div",{className:L,children:["... and ",Ne.orbitalEnergies.length-20," more orbitals"]})]})]}),Ne.matrices&&Object.keys(Ne.matrices).length>0?(0,Me.jsx)("div",{className:M,children:Object.entries(Ne.matrices).map(([e,t])=>t?(0,Me.jsx)(Jt,{matrix:t,title:`${e.charAt(0).toUpperCase()}${e.slice(1)} Matrix`,precision:6,maxDisplaySize:6},e):null)}):(0,Me.jsx)("div",{className:E,children:(0,Me.jsx)("p",{children:"No matrix data available. Matrices are generated during SCF calculations and may depend on the calculation method and settings."})})]}),"optimization"===Se&&Ne?.optimization&&(0,Me.jsxs)("div",{className:R,children:[(0,Me.jsx)("div",{className:B,children:(0,Me.jsxs)("div",{className:T,children:[(0,Me.jsx)("h4",{children:"Optimization Summary"}),(0,Me.jsxs)("div",{className:H,children:[(0,Me.jsxs)("div",{className:q,children:[(0,Me.jsx)("span",{className:V,children:"Converged:"}),(0,Me.jsx)("span",{className:`${P} ${Ne.optimization.trajectory.converged?U:Y}`,children:Ne.optimization.trajectory.converged?"Yes":"No"})]}),(0,Me.jsxs)("div",{className:q,children:[(0,Me.jsx)("span",{className:V,children:"Steps:"}),(0,Me.jsx)("span",{className:P,children:Ne.optimization.steps})]}),(0,Me.jsxs)("div",{className:q,children:[(0,Me.jsx)("span",{className:V,children:"Final Energy:"}),(0,Me.jsxs)("span",{className:P,children:[Ne.energy.toFixed(8)," Ha"]})]}),(0,Me.jsxs)("div",{className:q,children:[(0,Me.jsx)("span",{className:V,children:"Final Energy:"}),(0,Me.jsxs)("span",{className:P,children:[Ne.energyInEV.toFixed(4)," eV"]})]})]})]})}),(0,Me.jsxs)("div",{className:W,children:[(0,Me.jsx)("div",{className:Z,children:(0,Me.jsx)("div",{className:X,children:(0,Me.jsx)(ss.A,{trajectoryData:"normal_mode"===tt&&null!==st?(e=>{const t=dt.get(e);if(t)return t;if(!Ne?.optimization?.finalXYZ||!Ne?.frequencies?.frequencies)return"";const a=Ne.frequencies.normalModes?.[e],s=Ne.frequencies.frequencies[e];return a&&0!==a.length?ns.generateTrajectory(Ne.optimization.finalXYZ,a,s,e):ns.createPlaceholderTrajectory(Ne.optimization.finalXYZ,s,e)})(st):"optimization"===tt&&Ne?.optimization?.trajectory?(e=>{if(!e||!e.geometries||!e.energies)return"";const t=[];return e.geometries.forEach((a,s)=>{const n=e.energies[s],r=a.trim().split("\n");if(r.length>=2){const e=r[0],a=`Step ${s} Energy=${n.toFixed(9)}`,i=r.slice(2).join("\n");t.push(`${e}\n${a}\n${i}`)}}),t.join("\n")})(Ne.optimization.trajectory):"",moleculeName:(()=>{if("normal_mode"===tt&&null!==st&&Ne?.frequencies?.frequencies){const e=Ne.frequencies.frequencies[st];return`Mode ${st+1}: ${Math.abs(e).toFixed(2)} cm\u207b\xb9`}return"optimization"===tt?`${je?.formula||"Molecule"} Optimization`:"Trajectory"})(),autoPlay:"normal_mode"===tt,initialSpeed:"normal_mode"===tt?60:20})})}),(0,Me.jsxs)("div",{className:G,children:[(0,Me.jsx)("div",{className:J,children:(0,Me.jsx)("h4",{children:"Trajectory Controls"})}),(0,Me.jsx)("div",{className:K,children:(0,Me.jsx)("button",{onClick:()=>{at("optimization"),nt(null)},className:`${Q} ${"optimization"===tt?ee:""}`,children:"Optimization Path"})}),Ne.frequencies&&Ne.frequencies.frequencies.length>0&&(0,Me.jsxs)("div",{className:te,children:[(0,Me.jsxs)("div",{className:ae,children:[(0,Me.jsx)("h5",{children:"Normal Modes"}),(0,Me.jsx)("div",{className:se,children:(0,Me.jsxs)("label",{className:ne,children:[(0,Me.jsx)("input",{type:"checkbox",checked:rt,onChange:e=>{it(e.target.checked),e.target.checked&&null!==st&&Ne.frequencies.frequencies[st]&&Math.abs(Ne.frequencies.frequencies[st])<50&&(nt(null),at("optimization"))},className:re}),"Hide low modes (< 50 cm\u207b\xb9)"]})})]}),(0,Me.jsx)("div",{className:ie,children:vt().map(({freq:e,index:t})=>{const a="normal_mode"===tt&&st===t;return(0,Me.jsxs)("div",{className:`${le} ${a?oe:""}`,onClick:()=>{at("normal_mode"),nt(t)},style:{cursor:"pointer"},title:`Click to visualize mode ${t+1}`,children:[(0,Me.jsxs)("div",{className:de,children:[(0,Me.jsxs)("div",{className:ue,children:["Mode ",t+1]}),(0,Me.jsxs)("div",{className:me,children:[e<0?`${Math.abs(e).toFixed(1)}i`:e.toFixed(1)," cm\u207b\xb9"]}),e<0&&(0,Me.jsx)("div",{className:he,children:"imag"})]}),a&&(0,Me.jsx)("div",{className:ce,children:"\u25b6 Playing"})]},t)})}),(0,Me.jsxs)("div",{className:pe,children:["Showing ",vt().length," of ",Ne.frequencies.frequencies.length," modes"]})]})]})]})]})]})]})]}),Fe&&!Oe&&(0,Me.jsx)("div",{className:I,children:(0,Me.jsxs)("div",{className:D,children:[(0,Me.jsx)("h3",{children:"Error"}),(0,Me.jsx)("p",{children:Fe}),(0,Me.jsx)("button",{onClick:()=>ke(""),children:"Close"})]})}),(0,Me.jsx)(ot,{settings:Je,updateSettings:e=>{Ke(t=>({...t,...e}))},show:Qe,onClose:()=>et(!1)})]})};function is(){return(0,s.useEffect)(()=>{const e=document.createElement("script");return e.src="/coi-serviceworker.js",e.async=!0,document.head.appendChild(e),()=>{e.parentNode&&e.parentNode.removeChild(e)}},[]),(0,Me.jsx)(n.A,{title:"Wavefunction Calculator",description:"Quantum Chemistry Calculations in Your Browser",children:(0,Me.jsx)("main",{style:{minHeight:"calc(100vh - 60px)"},children:(0,Me.jsx)(rs,{})})})}},6370:(e,t,a)=>{a.d(t,{A:()=>B});var s=a(6540),n=a(7851);const r="container_kZ5w",i="header_HEr1",l="controls_ixvO",o="controlButton_GDgO",c="viewer_WviD",d="loadingOverlay_lwCV",u="errorOverlay_rmFC",m="loadingSpinner_PLZ5",h="errorMessage_qkbu",p="frameInfoOverlay_vX3K",x="frameNumber_EMUy",g="frameComment_F9wg",f="frameEnergy_RPyN",j="frameVolume_c0K5",v="displayControlsOverlay_fIES",b="overlayControls_EEtd",y="overlayControlGroup_E9WC",N="overlayLabel_tcBl",C="overlaySelect_UZvO",_="overlayCheckbox_jtWY",$="overlaySlider_ifAA",S="overlayValue_f7JJ",w="overlayNumberInput_nqMv",F="trajectoryControls_t0nZ",k="compactControls_H6OY",O="frameControls_R8UR",M="playerControls_ukm9",E="playerButton_Mfw8",A="playPauseButton_PlTX",z="frameSlider_B4ss";var L=a(4848);class I{shapeComponent=null;frameUnitcells=[];constructor(e,t){this.component=e,this.stage=t}setFrameUnitcells(e){this.frameUnitcells=e.map(e=>{if(!e.includes("Lattice="))return null;const t=e.match(/Lattice="([^"]+)"/);if(!t)return null;const a=t[1].split(/\s+/).map(e=>parseFloat(e));if(9!==a.length)return null;return{a:[a[0],a[1],a[2]],b:[a[3],a[4],a[5]],c:[a[6],a[7],a[8]]}})}updateFrame(e){if(e<0||e>=this.frameUnitcells.length)return;const t=this.frameUnitcells[e];t&&(this.remove(),this.createUnitCellShape(t))}createUnitCellShape(e){const{a:t,b:a,c:s}=e,r=this.component.structure.center,i=[[0,0,0],[1,0,0],[0,1,0],[0,0,1],[1,1,0],[1,0,1],[0,1,1],[1,1,1]].map(([e,n,i])=>[r.x+e*t[0]+n*a[0]+i*s[0],r.y+e*t[1]+n*a[1]+i*s[1],r.z+e*t[2]+n*a[2]+i*s[2]]),l=new n.yp("unitcell");[[0,1],[0,2],[0,3],[1,4],[1,5],[2,4],[2,6],[3,5],[3,6],[4,7],[5,7],[6,7]].forEach(([e,t])=>{l.addWideline(i[e],i[t],[1,.5,0])}),this.shapeComponent=this.stage.addComponentFromObject(l),this.shapeComponent.addRepresentation("buffer",{linewidth:5,opacity:.8})}remove(){this.shapeComponent&&(this.stage.removeComponent(this.shapeComponent),this.shapeComponent=null)}setVisible(e){this.shapeComponent&&this.shapeComponent.setVisibility(e)}}const D=e=>e.toLowerCase().split(".").pop()||"",R=e=>["pdb","ent","pqr","mmcif","cif","mcif","gro","sdf","mol2","mmtf"].includes(e);class T{static convertXYZTrajToPDB(e,t="MOL"){const a=this.parseXYZTrajectory(e);return this.convertFramesToPDB(a,t)}static calculateVolume(e,t,a,s,n,r){const i=s*Math.PI/180,l=n*Math.PI/180,o=r*Math.PI/180,c=Math.cos(i),d=Math.cos(l),u=Math.cos(o);return e*t*a*Math.sqrt(1+2*c*d*u-c*c-d*d-u*u)}static parseLatticeInfo(e){const t=e.match(/Lattice="([^"]+)"/);if(!t)return null;const a=t[1].split(/\s+/).map(e=>parseFloat(e));if(9!==a.length)return null;const s=a[0],n=a[1],r=a[2],i=a[3],l=a[4],o=a[5],c=a[6],d=a[7],u=a[8],m=Math.sqrt(s*s+n*n+r*r),h=Math.sqrt(i*i+l*l+o*o),p=Math.sqrt(c*c+d*d+u*u),x=180*Math.acos((i*c+l*d+o*u)/(h*p))/Math.PI,g=180*Math.acos((s*c+n*d+r*u)/(m*p))/Math.PI,f=180*Math.acos((s*i+n*l+r*o)/(m*h))/Math.PI;return{a:m,b:h,c:p,alpha:x,beta:g,gamma:f,volume:this.calculateVolume(m,h,p,x,g,f)}}static convertFramesToPDB(e,t="MOL"){let a="";return e.forEach((e,s)=>{a+=`MODEL     ${(s+1).toString().padStart(4," ")}\n`;const n=e.trim().split("\n"),r=parseInt(n[0]),i=n[1]||"",l=this.parseLatticeInfo(i);if(l){const e=l.a.toFixed(3).padStart(9," "),t=l.b.toFixed(3).padStart(9," "),s=l.c.toFixed(3).padStart(9," "),n=l.alpha.toFixed(2).padStart(7," "),r=l.beta.toFixed(2).padStart(7," "),i=l.gamma.toFixed(2).padStart(7," ");a+=`CRYST1${e}${t}${s}${n}${r}${i} P 1           1\n`}for(let o=0;o<r;o++){const e=n[o+2].trim().split(/\s+/),s=e[0],r=parseFloat(e[1]),i=parseFloat(e[2]),l=parseFloat(e[3]),c=(o+1).toString().padStart(5," "),d=s.padEnd(4," "),u=t.substring(0,3).padEnd(3," "),m="A",h="1".padStart(4," "),p=r.toFixed(3).padStart(8," "),x=i.toFixed(3).padStart(8," "),g=l.toFixed(3).padStart(8," ");a+=`ATOM  ${c} ${d} ${u} ${m}${h}    ${p}${x}${g}  1.00  0.00           ${s.padEnd(2," ")}\n`}a+="ENDMDL\n"}),a+="END\n",a}static parseXYZTrajectory(e){const t=[],a=e.trim().split("\n");let s=0;for(;s<a.length;){if(!a[s]||""===a[s].trim()){s++;continue}const e=parseInt(a[s]);if(isNaN(e)||e<=0){s++;continue}if(s+e+1>=a.length)break;const n=a.slice(s,s+e+2);t.push(n.join("\n")),s+=e+2}return t}}const B=({trajectoryData:e,xyzFrames:t,structureFile:a,trajectoryFile:B,structureUrl:H,trajectoryUrl:q,moleculeName:V="Trajectory",autoPlay:P=!1,initialSpeed:U=100})=>{const Y=(0,s.useRef)(null),X=(0,s.useRef)(null),W=(0,s.useRef)(null),Z=(0,s.useRef)(null),G=(0,s.useRef)(null),[J,K]=(0,s.useState)(!1),[Q,ee]=(0,s.useState)(""),[te,ae]=(0,s.useState)(0),[se,ne]=(0,s.useState)(0),[re,ie]=(0,s.useState)(!1),[le,oe]=(0,s.useState)(30),[ce,de]=(0,s.useState)("ball+stick"),[ue,me]=(0,s.useState)(!0),[he,pe]=(0,s.useState)("element"),[xe,ge]=(0,s.useState)([]),[fe,je]=(0,s.useState)([]),[ve,be]=(0,s.useState)(null),[ye,Ne]=(0,s.useState)(!1),[Ce,_e]=(0,s.useState)(!1),[$e,Se]=(0,s.useState)(!1),[we,Fe]=(0,s.useState)(1),[ke,Oe]=(0,s.useState)(1),[Me,Ee]=(0,s.useState)(1),[Ae,ze]=(0,s.useState)([]),[Le,Ie]=(0,s.useState)(null),De=()=>"dark"===document.documentElement.getAttribute("data-theme")?"#1b1b1d":"#ffffff";(0,s.useEffect)(()=>{if(!Y.current)return;X.current=new n.BI(Y.current,{backgroundColor:De(),quality:"medium",clipNear:1e-6,clipFar:100,clipDist:10});const e=()=>{X.current&&X.current.handleResize()};window.addEventListener("resize",e);const t=new MutationObserver(()=>{X.current&&X.current.setParameters({backgroundColor:De()})});return t.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{window.removeEventListener("resize",e),t.disconnect(),X.current&&X.current.dispose()}},[]);const Re=e=>{const t=[/Energy\s*=\s*(-?\d+\.?\d*)/i,/E\s*=\s*(-?\d+\.?\d*)/i,/energy:\s*(-?\d+\.?\d*)/i];for(const a of t){const t=e.match(a);if(t){const e=parseFloat(t[1]);if(!isNaN(e))return e}}return null},Te=e=>e.includes("cm\u207b\xb9")||e.includes("cm-1")||e.toLowerCase().includes("mode")||e.includes("Frame=")?null:e.toUpperCase().includes("ORCA")?(e=>{if(e.toUpperCase().includes("ORCA")){const t=e.match(/E\s+(-?\d+\.?\d*)/i);if(t){const e=parseFloat(t[1]);if(!isNaN(e))return e}}return null})(e):e.includes("Energy=")||e.includes("E=")||e.includes("energy:")||e.includes("Lattice=")?Re(e):null,Be=e=>{const t=e.match(/Lattice="([^"]+)"/);if(!t)return null;const a=t[1].split(/\s+/).map(e=>parseFloat(e));if(9!==a.length)return null;const s=a[0],n=a[1],r=a[2],i=a[3],l=a[4],o=a[5],c=a[6],d=a[7],u=a[8],m=Math.sqrt(s*s+n*n+r*r),h=Math.sqrt(i*i+l*l+o*o),p=Math.sqrt(c*c+d*d+u*u),x=180*Math.acos((i*c+l*d+o*u)/(h*p))/Math.PI,g=180*Math.acos((s*c+n*d+r*u)/(m*p))/Math.PI,f=180*Math.acos((s*i+n*l+r*o)/(m*h))/Math.PI,j=x*Math.PI/180,v=g*Math.PI/180,b=f*Math.PI/180,y=Math.cos(j),N=Math.cos(v),C=Math.cos(b);return m*h*p*Math.sqrt(1+2*y*N*C-y*y-N*N-C*C)},He=e=>{const t=e.trim().split("\n"),a=[],s=[],n=[],r=[];let i=!1,l=0;for(;l<t.length;){const e=parseInt(t[l]);if(isNaN(e)){l++;continue}const o=t.slice(l,l+e+2);a.push(o.join("\n"));const c=t[l+1]||"";n.push(c);const d=Te(c);s.push(d);const u=Be(c);r.push(u),c.includes("Lattice=")&&(i=!0),l+=e+2}ge(s),je(n),ze(r),_e(i);const o=s.filter(e=>null!==e);return o.length>0?be(Math.min(...o)):be(null),{frames:a,comments:n,hasLattice:i}},qe=async(e,t=[],a=!1)=>{if(X.current){K(!0),ee("");try{X.current.removeAllComponents(),Z.current=null,G.current=null;const s=T.convertFramesToPDB(e,V),n=new Blob([s],{type:"text/plain"}),r=await X.current.loadFile(n,{ext:"pdb",name:V,asTrajectory:!0});W.current=r,ne(e.length),Ve();const i=r.addTrajectory();if(Z.current=i,i.trajectory&&i.trajectory.player){const e=i.trajectory.player;G.current=e;const t=Math.round(1e3/le);e.parameters&&(e.parameters.timeout=t,e.parameters.mode="loop",e.parameters.step=1,e.parameters.direction="forward"),e.signals&&(e.signals.startedRunning&&e.signals.startedRunning.add(()=>{ie(!0)}),e.signals.haltedRunning&&e.signals.haltedRunning.add(()=>{ie(!1)}))}if(i.trajectory&&i.trajectory.signals&&i.trajectory.signals.frameChanged&&i.trajectory.signals.frameChanged.add(e=>{ae(e)}),X.current.autoView(),console.log("Trajectory loaded. latticeDetected:",a,"comments.length:",t.length),a&&t.length>0){console.log("Creating CustomUnitCellRepresentation...");const e=new I(r,X.current);e.setFrameUnitcells(t),Ie(e),_e(!0),console.log("CustomUnitCellRepresentation created:",e)}else console.log("Not creating unit cell: latticeDetected =",a,"comments =",t.length),_e(!1);P&&G.current&&setTimeout(()=>G.current.play(),500),K(!1)}catch(s){console.error("Error loading trajectory:",s),ee(`Failed to load trajectory: ${s.message}`),K(!1)}}},Ve=()=>{if(!W.current)return;W.current.removeAllRepresentations();const e={colorScheme:he,sele:ue?"all":"not hydrogen"};switch(ce){case"ball+stick":e.radiusScale=.8,e.bondScale=.3;break;case"line":e.linewidth=2;break;case"spacefill":e.radiusScale=1;break;case"licorice":e.bondScale=.5,e.multipleBond=!0}W.current.addRepresentation(ce,e),X.current?.autoView()},Pe=e=>1===we&&1===ke&&1===Me?e:e.map(e=>{const t=e.trim().split("\n"),a=parseInt(t[0]),s=t[1]||"",n=s.match(/Lattice="([^"]+)"/);if(!n)return e;const r=n[1].split(/\s+/).map(e=>parseFloat(e));if(9!==r.length)return e;const i=[r[0],r[1],r[2]],l=[r[3],r[4],r[5]],o=[r[6],r[7],r[8]],c=[];for(let h=0;h<a;h++){const e=t[h+2].trim().split(/\s+/);c.push({element:e[0],x:parseFloat(e[1]),y:parseFloat(e[2]),z:parseFloat(e[3])})}const d=[];for(let h=0;h<we;h++)for(let e=0;e<ke;e++)for(let t=0;t<Me;t++){const a=[h*i[0]+e*l[0]+t*o[0],h*i[1]+e*l[1]+t*o[1],h*i[2]+e*l[2]+t*o[2]];c.forEach(e=>{d.push({element:e.element,x:e.x+a[0],y:e.y+a[1],z:e.z+a[2]})})}const u=[d.length.toString()],m=s.replace(/Lattice="([^"]+)"/,(e,t)=>`Lattice="${[i[0]*we,i[1]*we,i[2]*we,l[0]*ke,l[1]*ke,l[2]*ke,o[0]*Me,o[1]*Me,o[2]*Me].join(" ")}"`);return u.push(m),d.forEach(e=>{u.push(`${e.element}  ${e.x.toFixed(6)}  ${e.y.toFixed(6)}  ${e.z.toFixed(6)}`)}),u.join("\n")}),Ue=()=>{Le&&Ce&&($e?(Le.updateFrame(te),Le.setVisible(!0)):Le.setVisible(!1))};(0,s.useEffect)(()=>{const s=()=>{if(G.current)if("function"==typeof G.current.pause)try{G.current.pause()}catch(e){}else G.current.intervalId&&clearInterval(G.current.intervalId);ie(!1)};if((a||H)&&(B||q||R(a?D(a.name):H?D(H):""))){s();const e=a||H,t=B||q;setTimeout(()=>(async(e,t)=>{if(X.current){K(!0),ee("");try{let a;if(X.current.removeAllComponents(),Z.current=null,G.current=null,"string"==typeof e)a=await X.current.loadFile(e,{name:V});else{const t=D(e.name);a=await X.current.loadFile(e,{ext:t,name:V})}if(W.current=a,Ve(),t){let e;if("string"==typeof t)e=await n.un(t);else{const a=URL.createObjectURL(t);try{e=await n.un(a,{ext:D(t.name)})}finally{URL.revokeObjectURL(a)}}const s=a.addTrajectory(e);if(Z.current=s,s.trajectory&&s.trajectory.player){const e=s.trajectory.player;G.current=e;const t=Math.round(1e3/le);e.parameters&&(e.parameters.timeout=t,e.parameters.mode="loop",e.parameters.step=1,e.parameters.direction="forward"),e.signals&&(e.signals.startedRunning&&e.signals.startedRunning.add(()=>{ie(!0)}),e.signals.haltedRunning&&e.signals.haltedRunning.add(()=>{ie(!1)}))}s.trajectory&&s.trajectory.signals&&s.trajectory.signals.frameChanged&&s.trajectory.signals.frameChanged.add(e=>{ae(e)}),e&&void 0!==e.frameCount?ne(e.frameCount):s.trajectory&&void 0!==s.trajectory.frameCount&&ne(s.trajectory.frameCount)}else if(R(D("string"==typeof e?e:e.name))){const e=a.addTrajectory();if(Z.current=e,e.trajectory&&e.trajectory.player){const t=e.trajectory.player;G.current=t;const a=Math.round(1e3/le);t.parameters&&(t.parameters.timeout=a,t.parameters.mode="loop",t.parameters.step=1,t.parameters.direction="forward"),t.signals&&(t.signals.startedRunning&&t.signals.startedRunning.add(()=>{ie(!0)}),t.signals.haltedRunning&&t.signals.haltedRunning.add(()=>{ie(!1)}))}e.trajectory&&e.trajectory.signals&&e.trajectory.signals.frameChanged&&e.trajectory.signals.frameChanged.add(e=>{ae(e)}),a.structure&&a.structure.modelStore&&void 0!==a.structure.modelStore.count&&ne(a.structure.modelStore.count)}X.current.autoView(),P&&G.current&&se>1&&setTimeout(()=>{G.current&&"function"==typeof G.current.play&&G.current.play()},500),K(!1)}catch(a){console.error("Error loading trajectory:",a),ee(`Failed to load trajectory: ${a.message}`),K(!1)}}})(e,t),50)}else if(e){const t=He(e);if(t.frames.length>0){s();const e=Pe(t.frames);setTimeout(()=>qe(e,t.comments,t.hasLattice),50)}}else if(t&&t.length>0){s();const e=t.join("\n\n"),a=He(e),n=Pe(a.frames);setTimeout(()=>qe(n,a.comments,a.hasLattice),50)}return s},[e,t,a,B,H,q,we,ke,Me]),(0,s.useEffect)(()=>{Ve()},[ce,ue,he]),(0,s.useEffect)(()=>{$e?Ue():Le&&Le.remove()},[$e,we,ke,Me,Ce,Le]),(0,s.useEffect)(()=>{$e&&Ce&&Ue()},[te,$e,Ce,Le]);const Ye=()=>{if(G.current&&"function"==typeof G.current.play)G.current.play();else if(Z.current&&Z.current.trajectory&&se>1){ie(!0);let e=te;const t=setInterval(()=>{try{Z.current&&Z.current.trajectory?(e=(e+1)%se,Z.current.trajectory.setFrame(e),ae(e)):(clearInterval(t),ie(!1))}catch(a){console.warn("Trajectory disposed during playback, stopping:",a.message),clearInterval(t),ie(!1)}},Math.round(1e3/le));G.current={intervalId:t}}},Xe=()=>{G.current&&("function"==typeof G.current.pause?G.current.pause():G.current.intervalId&&(clearInterval(G.current.intervalId),G.current=null)),ie(!1)},We=e=>{try{Z.current&&Z.current.trajectory&&Z.current.trajectory.setFrame(e)}catch(t){console.warn("Cannot set frame on disposed trajectory:",t.message)}};return(0,s.useEffect)(()=>{const e=e=>{if(!(se<=1||e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLSelectElement))switch(e.code){case"Space":e.preventDefault(),re?Xe():Ye();break;case"ArrowLeft":e.preventDefault(),We(Math.max(0,te-1));break;case"ArrowRight":e.preventDefault(),We(Math.min(se-1,te+1));break;case"Home":e.preventDefault(),We(0);break;case"End":e.preventDefault(),We(se-1)}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[se,te,re]),(0,L.jsxs)("div",{className:r,children:[(0,L.jsxs)("div",{className:i,children:[(0,L.jsx)("h4",{children:V}),(0,L.jsxs)("div",{className:l,children:[(0,L.jsx)("button",{onClick:()=>Ne(!ye),className:o,title:"Toggle display options",children:"Options"}),(0,L.jsx)("button",{onClick:()=>{X.current&&X.current.autoView(1e3)},className:o,children:"Reset View"}),(0,L.jsx)("button",{onClick:()=>{X.current&&X.current.toggleFullscreen(Y.current)},className:o,children:"Fullscreen"})]})]}),(0,L.jsxs)("div",{className:c,ref:Y,children:[J&&(0,L.jsx)("div",{className:d,children:(0,L.jsx)("div",{className:m,children:"Loading trajectory..."})}),Q&&(0,L.jsx)("div",{className:u,children:(0,L.jsx)("div",{className:h,children:Q})}),se>0&&(0,L.jsxs)("div",{className:p,children:[(0,L.jsxs)("div",{className:x,children:["Frame ",te+1,"/",se]}),fe[te]&&(0,L.jsx)("div",{className:g,children:fe[te]}),null!==xe[te]&&void 0!==xe[te]&&null!==ve&&(0,L.jsx)("div",{className:f,children:(()=>{const e=xe[te]-ve;return`${e>=0?"+":""}${(2625.5*e).toFixed(2)} kJ/mol`})()}),null!==Ae[te]&&void 0!==Ae[te]&&(0,L.jsxs)("div",{className:j,children:["Volume: ",Ae[te].toFixed(2)," \xc5\xb3"]})]}),ye&&(0,L.jsx)("div",{className:v,children:(0,L.jsxs)("div",{className:b,children:[(0,L.jsxs)("div",{className:y,children:[(0,L.jsx)("label",{className:N,children:"Style:"}),(0,L.jsxs)("select",{value:ce,onChange:e=>de(e.target.value),className:C,children:[(0,L.jsx)("option",{value:"ball+stick",children:"Ball & Stick"}),(0,L.jsx)("option",{value:"line",children:"Line"}),(0,L.jsx)("option",{value:"spacefill",children:"Spacefill"}),(0,L.jsx)("option",{value:"licorice",children:"Licorice"}),(0,L.jsx)("option",{value:"cartoon",children:"Cartoon"})]})]}),(0,L.jsxs)("div",{className:y,children:[(0,L.jsx)("label",{className:N,children:"Color:"}),(0,L.jsxs)("select",{value:he,onChange:e=>pe(e.target.value),className:C,children:[(0,L.jsx)("option",{value:"element",children:"Element"}),(0,L.jsx)("option",{value:"chainname",children:"Chain"}),(0,L.jsx)("option",{value:"residueindex",children:"Residue"}),(0,L.jsx)("option",{value:"bfactor",children:"B-factor"})]})]}),(0,L.jsxs)("div",{className:y,children:[(0,L.jsx)("input",{type:"checkbox",checked:ue,onChange:e=>me(e.target.checked),id:"showH-overlay",className:_}),(0,L.jsx)("label",{htmlFor:"showH-overlay",className:N,children:"Show Hydrogens"})]}),(0,L.jsxs)("div",{className:y,children:[(0,L.jsx)("label",{className:N,children:"FPS:"}),(0,L.jsx)("input",{type:"range",min:"10",max:"60",step:"5",value:le,onChange:e=>(e=>{if(oe(e),G.current&&G.current.parameters){const t=Math.round(1e3/e);G.current.parameters.timeout=t,re&&"function"==typeof G.current.pause&&"function"==typeof G.current.play&&(G.current.pause(),G.current.play())}})(parseInt(e.target.value)),className:$}),(0,L.jsx)("span",{className:S,children:le})]}),Ce&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:y,children:[(0,L.jsx)("input",{type:"checkbox",checked:$e,onChange:e=>Se(e.target.checked),id:"showUnitCell-overlay",className:_}),(0,L.jsx)("label",{htmlFor:"showUnitCell-overlay",className:N,children:"Show Unit Cell"})]}),$e&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:y,children:[(0,L.jsx)("label",{className:N,children:"Supercell X:"}),(0,L.jsx)("input",{type:"number",min:"1",max:"5",value:we,onChange:e=>Fe(parseInt(e.target.value)||1),className:w})]}),(0,L.jsxs)("div",{className:y,children:[(0,L.jsx)("label",{className:N,children:"Supercell Y:"}),(0,L.jsx)("input",{type:"number",min:"1",max:"5",value:ke,onChange:e=>Oe(parseInt(e.target.value)||1),className:w})]}),(0,L.jsxs)("div",{className:y,children:[(0,L.jsx)("label",{className:N,children:"Supercell Z:"}),(0,L.jsx)("input",{type:"number",min:"1",max:"5",value:Me,onChange:e=>Ee(parseInt(e.target.value)||1),className:w})]})]})]})]})})]}),se>1&&(0,L.jsx)("div",{className:F,children:(0,L.jsxs)("div",{className:k,children:[(0,L.jsxs)("div",{className:M,children:[(0,L.jsx)("button",{onClick:()=>We(Math.max(0,te-1)),className:E,disabled:0===te,title:"Previous frame",children:"\u23ee"}),(0,L.jsx)("button",{onClick:re?Xe:Ye,className:`${E} ${A}`,title:re?"Pause":"Play",children:re?"\u23f8":"\u23f5"}),(0,L.jsx)("button",{onClick:()=>We(Math.min(se-1,te+1)),className:E,disabled:te===se-1,title:"Next frame",children:"\u23ed"})]}),(0,L.jsx)("div",{className:O,children:(0,L.jsx)("input",{type:"range",min:"0",max:se-1,value:te,onChange:e=>We(parseInt(e.target.value)),className:z})})]})})]})}}}]);