"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[9819],{1445:(e,t,n)=>{e.exports=n.p+"373b539584b8e152.wasm"},2949:(e,t,n)=>{n.d(t,{getModule:()=>r,loadOCC:()=>o});let i=null,s=null;async function o(e={}){return i||(s||(s=(async()=>{try{const t=await n.e(3223).then(n.bind(n,3223)),s="function"==typeof t?t:t.default||t,o="undefined"==typeof window;let r=e.wasmPath,a=e.dataPath;if(!r)if(o){const e=new URL(n(1445),n.b);r=e.pathname}else r="./occjs.wasm";if(!a)if(o){const e=new URL(n(6989),n.b);a=e.pathname}else a="./occjs.data";const c=await s({locateFile:e=>e.endsWith(".wasm")?r:e.endsWith(".data")?a:e,...e.env});return c.LogLevel&&c.setLogLevel&&c.setLogLevel(c.LogLevel.WARN||3),c.setDataDirectory("/"),console.log("OCC module loaded with data directory:",c.getDataDirectory()),i=c,c}catch(t){throw s=null,new Error(`Failed to load OCC module: ${t.message}`)}})(),s))}function r(){if(!i)throw new Error("OCC module not loaded. Call loadOCC() first.");return i}},6989:(e,t,n)=>{e.exports=n.p+"2ff5cc6334a31430.data"},9819:(e,t,n)=>{n.r(t),n.d(t,{BasisSets:()=>M,DMAConfig:()=>f,DMAResult:()=>p,Elements:()=>C,QMCalculation:()=>o,SCFSettings:()=>s,calculateDMA:()=>d,createDFTCalculation:()=>c,createDFTWorkflow:()=>h,createHFCalculation:()=>a,createHFMP2Workflow:()=>u,createMP2Calculation:()=>l,createMolecule:()=>y,createOCC:()=>v,createQMCalculation:()=>D,generatePunchFile:()=>m,getModule:()=>i.getModule,loadBasisSet:()=>S,loadOCC:()=>i.loadOCC,moleculeFromXYZ:()=>w,quickCalculation:()=>g,wavefunctionFromString:()=>b});var i=n(2949);class s{constructor(){this.maxIterations=100,this.energyTolerance=1e-8,this.densityTolerance=1e-6,this.initialGuess="core",this.diis=!0,this.diisSize=8}setMaxIterations(e){return this.maxIterations=e,this}setEnergyTolerance(e){return this.energyTolerance=e,this}setDensityTolerance(e){return this.densityTolerance=e,this}setInitialGuess(e){return this.initialGuess=e,this}setDIIS(e,t=8){return this.diis=e,this.diisSize=t,this}}class o{constructor(e,t,n){this.molecule=e,this.basis=t,this.module=n,this.wavefunction=null,this.energy=null,this.method=null,this.properties=new Map}async runHF(e={}){const t=e instanceof s?e:new s;e instanceof s||Object.assign(t,e);const n=new this.module.HartreeFock(this.basis);e.precision&&n.setPrecision(e.precision);const i=e.unrestricted?this.module.SpinorbitalKind.Unrestricted:this.module.SpinorbitalKind.Restricted,o=new this.module.HartreeFockSCF(n,i);o.setChargeMultiplicity(this.molecule.charge(),this.molecule.multiplicity());const r=o.convergenceSettings;return t.energyTolerance&&(r.energyThreshold=t.energyTolerance),t.commutatorTolerance&&(r.commutatorThreshold=t.commutatorTolerance),this.energy=o.run(),this.wavefunction=o.wavefunction(),this.method="HF",this.energy}async runDFT(e,t={}){const n=new this.module.DFT(e,this.basis);t.precision&&n.setPrecision(t.precision);const i=t.unrestricted?this.module.SpinorbitalKind.Unrestricted:this.module.SpinorbitalKind.Restricted,s=new this.module.KohnShamSCF(n,i);if(s.setChargeMultiplicity(this.molecule.charge(),this.molecule.multiplicity()),t.scfSettings){const e=s.convergenceSettings;t.scfSettings.energyTolerance&&(e.energyThreshold=t.scfSettings.energyTolerance)}return this.energy=s.run(),this.wavefunction=s.wavefunction(),this.method=`DFT/${e}`,this.energy}async runMP2(e={}){if(!this.wavefunction)throw new Error("MP2 calculation requires a reference wavefunction. Run HF or DFT first.");const t=new this.module.MP2(this.wavefunction);return void 0!==e.frozenCore&&t.setFrozenCore(e.frozenCore),this.energy=t.run(),this.method="MP2",this.energy}async calculateProperties(e){if(!this.wavefunction)throw new Error("Properties calculation requires a wavefunction. Run SCF first.");const t={};for(const n of e)switch(n.toLowerCase()){case"mulliken":t.mulliken=this.wavefunction.mullikenCharges(),this.properties.set("mulliken",t.mulliken);break;case"energy":t.energy=this.energy;break;case"orbitals":t.orbitals={coefficients:this.wavefunction.coefficients(),energies:this.wavefunction.orbitalEnergies(),occupations:this.wavefunction.occupations()},this.properties.set("orbitals",t.orbitals);break;case"homo":t.homo=this.wavefunction.homoEnergy();break;case"lumo":t.lumo=this.wavefunction.lumoEnergy();break;case"gap":t.gap=this.wavefunction.lumoEnergy()-this.wavefunction.homoEnergy();break;default:console.warn(`Unknown property: ${n}`)}return t}exportWavefunction(e="molden"){if(!this.wavefunction)throw new Error("No wavefunction to export. Run SCF calculation first.");return this.wavefunction.exportToString(e.toLowerCase())}getSummary(){return{method:this.method,energy:this.energy,molecule:{formula:this.molecule.name(),natoms:this.molecule.size(),charge:this.molecule.charge(),multiplicity:this.molecule.multiplicity()},basis:this.basis?this.basis.name():"Unknown",converged:null!==this.energy,properties:Object.fromEntries(this.properties)}}}function r(e,t,n={},i){const s=function(e,t,n,i={}){if(i.json){const n="string"==typeof i.json?i.json:JSON.stringify(i.json);return e.AOBasis.fromJson(t.atoms(),n)}return e.AOBasis.load(t.atoms(),n)}(i,e,t,n);return new o(e,s,i)}async function a(e,t,n={},i){const o=await r(e,t,n,i),a=(new s).setMaxIterations(n.maxIterations||100).setEnergyTolerance(n.energyTolerance||1e-8).setDensityTolerance(n.densityTolerance||1e-6).setInitialGuess(n.initialGuess||"core").setDIIS(!1!==n.diis,n.diisSize||8);return o._defaultHFSettings=a,o.runHFWithDefaults=function(){return this.runHF(this._defaultHFSettings)},o}async function c(e,t,n,i={},o){const a=await r(e,t,i,o),c={scfSettings:(new s).setMaxIterations(i.maxIterations||150).setEnergyTolerance(i.energyTolerance||1e-8).setDensityTolerance(i.densityTolerance||1e-6).setInitialGuess(i.initialGuess||"core").setDIIS(!1!==i.diis,i.diisSize||8),densityFittingBasis:i.densityFittingBasis,gridSettings:i.gridSettings,...i.dftOptions};return a._defaultFunctional=n,a._defaultDFTOptions=c,a.runDFTWithDefaults=function(){return this.runDFT(this._defaultFunctional,this._defaultDFTOptions)},a}function l(e,t={}){if(!e.wavefunction)throw new Error("MP2 calculation requires a reference wavefunction. Run HF or DFT on the reference calculation first.");const n={frozenCore:void 0===t.frozenCore||t.frozenCore,useRI:void 0!==t.useRI&&t.useRI,spinComponentScaling:t.spinComponentScaling,...t};return e._defaultMP2Options=n,e.runMP2WithDefaults=function(){return this.runMP2(this._defaultMP2Options)},e}async function u(e,t,n={},i){const s=await a(e,t,n,i),o=await s.runHFWithDefaults();l(s,n.mp2Options);const r=await s.runMP2WithDefaults();return{calculation:s,energies:{hf:o,mp2:r},summary:s.getSummary()}}async function h(e,t,n,i={},s){const o=await c(e,t,n,i,s),r=await o.runDFTWithDefaults();let a={};return i.properties&&Array.isArray(i.properties)&&(a=await o.calculateProperties(i.properties)),{calculation:o,energy:r,properties:a,summary:o.getSummary()}}async function g(e,t={},n){const{method:i="HF",basis:s="sto-3g",functional:o="b3lyp",properties:r=["energy","mulliken","dipole"],...u}=t;let h,g;switch(i.toUpperCase()){case"HF":h=await a(e,s,u,n),g=await h.runHFWithDefaults();break;case"DFT":h=await c(e,s,o,u,n),g=await h.runDFTWithDefaults();break;case"MP2":h=await a(e,s,u,n),await h.runHFWithDefaults(),l(h,u.mp2Options),g=await h.runMP2WithDefaults();break;default:throw new Error(`Unknown method: ${i}. Use 'HF', 'DFT', or 'MP2'.`)}return{method:i,energy:g,properties:await h.calculateProperties(r),calculation:h}}class f{constructor(){this.maxRank=4,this.bigExponent=4,this.includeNuclei=!0,this.atomRadii=new Map,this.atomLimits=new Map,this.writePunch=!1,this.punchFilename="dma.punch"}setAtomRadius(e,t){this.atomRadii.set(e,t)}setAtomLimit(e,t){this.atomLimits.set(e,t)}}async function d(e,t={}){const{loadOCC:i}=await Promise.resolve().then(n.bind(n,2949)),s=await i();console.log("DMA: Starting calculation with options:",t),console.log("DMA: Creating config...");const o=new s.DMAConfig;if(console.log("DMA: Config created successfully"),console.log("DMA: Setting basic settings..."),o.setMaxRank(t.maxRank??4),o.setBigExponent(t.bigExponent??4),o.setIncludeNuclei(t.includeNuclei??!0),console.log(`DMA: Basic settings set - max_rank=${o.settings.max_rank}, big_exponent=${o.settings.big_exponent}`),t.atomRadii){console.log("DMA: Setting atom radii...");for(const[e,n]of Object.entries(t.atomRadii))console.log(`DMA: Setting radius for ${e} to ${n}`),o.setAtomRadius(e,n);console.log("DMA: Atom radii set")}if(t.atomLimits){console.log("DMA: Setting atom limits...");for(const[e,n]of Object.entries(t.atomLimits))console.log(`DMA: Setting limit for ${e} to ${n}`),o.setAtomLimit(e,n);console.log("DMA: Atom limits set")}t.atomRadii?.H||(console.log("DMA: Setting default H radius..."),o.setAtomRadius("H",.35)),t.atomLimits?.H||(console.log("DMA: Setting default H limit..."),o.setAtomLimit("H",1)),console.log("DMA: Creating driver...");const r=new s.DMADriver;console.log("DMA: Driver created"),console.log("DMA: Setting config on driver..."),r.set_config(o),console.log("DMA: Config set on driver"),console.log("DMA: About to call runWithWavefunction...");const a=r.runWithWavefunction(e);console.log("DMA: runWithWavefunction completed successfully"),console.log("DMA: Creating result wrapper...");const c=new p(a);return console.log("DMA: Result wrapper created"),c}async function m(e){const{getModule:t}=await Promise.resolve().then(n.bind(n,2949)),i=t(),{result:s,sites:o}=e;return i.generate_punch_file(s,o)}class p{constructor(e){this.result=e.result,this.sites=e.sites}getSiteMultipoles(e){return this.result.multipoles.get(e)}getTotalMultipoles(){return null}getSites(){return this.sites}async toPunchFile(){const{getModule:e}=await Promise.resolve().then(n.bind(n,2949));return e().generate_punch_file(this.result,this.sites)}getMultipoleComponent(e,t){return this.getSiteMultipoles(e).getComponent(t)}getAllComponents(e){const t=this.getSiteMultipoles(e),n={Q00:t.getComponent("Q00"),charge:t.getComponent("Q00"),maxRank:t.max_rank},i=["Q10","Q11c","Q11s","Q20","Q21c","Q21s","Q22c","Q22s","Q30","Q31c","Q31s","Q32c","Q32s","Q33c","Q33s","Q40","Q41c","Q41s","Q42c","Q42s","Q43c","Q43s","Q44c","Q44s"];for(const o of i)try{n[o]=t.getComponent(o)}catch(s){break}return n}}async function w(e){return(await(0,i.loadOCC)()).Molecule.fromXyzString(e)}async function y(e,t){const n=await(0,i.loadOCC)(),s=e.length,o=n.Mat3N.create(s);for(let i=0;i<s;i++)o.set(0,i,t[i][0]),o.set(1,i,t[i][1]),o.set(2,i,t[i][2]);const r=n.IVec.fromArray(e);return new n.Molecule(r,o)}const C={H:1,He:2,Li:3,Be:4,B:5,C:6,N:7,O:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,S:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56},M={"sto-3g":"sto-3g","3-21g":"3-21g","6-31g":"6-31g","6-31g(d)":"6-31g(d)","6-31g(d,p)":"6-31g(d,p)","6-311g(d,p)":"6-311g(d,p)","def2-svp":"def2-svp","def2-tzvp":"def2-tzvp","def2-qzvp":"def2-qzvp","cc-pvdz":"cc-pvdz","cc-pvtz":"cc-pvtz","cc-pvqz":"cc-pvqz"};async function D(e,t,n={}){return r(e,t,n,await(0,i.loadOCC)())}const v=i.loadOCC;async function S(e,t){return(await(0,i.loadOCC)()).AOBasis.load(e.atoms(),t)}async function b(e,t){return(await(0,i.loadOCC)()).Wavefunction.fromString(e,t)}}}]);