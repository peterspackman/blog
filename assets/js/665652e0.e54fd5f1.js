"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[1288],{5066:(e,s,a)=>{a.r(s),a.d(s,{default:()=>Bs});var t=a(6540),n=a(1656);const l="container_Qh_B",r="layout_SyMw",i="sidebar_Cwvp",o="content_ak_G",c="tabs_tRXw",d="tab_F12w",u="tabContent_hF_7",m="collapsibleSection_Nmyk",h="sectionHeader_qShV",p="sectionTitle_aNil",x="chevron_b8vT",v="sectionContent_NPTV",j="chevronExpanded_ry9E",g="status_l6dK",b="statusLoading_AJab",f="statusReady_FVt8",N="moleculeInfo_KKVy",_="button_XSDO",y="stickyButtons_GEQA",S="buttonPrimary_eux_",C="buttonDanger_gLI_",w="tabActive_fzT3",$="propertiesTab_ipsn",k="structureTab_HvbL",F="noStructure_y5fR",E="matricesSection_omrz",M="noMatrices_bajq",O="orbitalsCard_tkcK",R="orbitalGrid_Wtwa",L="moreOrbitals_oRmJ",T="errorModal_HssV",D="errorContent_nEMj",H="section_X2kF",z="exampleSection_iMDs",I="exampleLabel__wK2",B="exampleSelect_VuLc",A="inputContainer_aHUj",V="headerRow_MA_E",P="label_1fak",G="controls_Azqc",W="browseButton_eNgL",U="combinedInput_AOvI",X="dragging_F5j2",q="clearButton_KExK",Y="xyzTextarea_Jaou";var Z=a(4848);const K={water:{name:"Water (H\u2082O)",xyz:"3\nWater molecule\nO  0.000000  0.000000  0.000000\nH  0.757000  0.586000  0.000000\nH -0.757000  0.586000  0.000000"},urea:{name:"Urea (CH\u2084N\u2082O)",xyz:"8\nUrea molecule\nC  0.000000  0.000000  0.000000\nO  0.000000  1.220000  0.000000\nN  1.150000 -0.610000  0.000000\nN -1.150000 -0.610000  0.000000\nH  1.150000 -1.610000  0.000000\nH  2.050000 -0.110000  0.000000\nH -1.150000 -1.610000  0.000000\nH -2.050000 -0.110000  0.000000"},formamide:{name:"Formamide (CH\u2083NO)",xyz:"6\nFormamide molecule\nC  0.000000  0.000000  0.000000\nO  1.220000  0.000000  0.000000\nN -0.610000  1.150000  0.000000\nH -0.610000 -0.950000  0.000000\nH -1.610000  1.150000  0.000000\nH -0.110000  2.050000  0.000000"},methane:{name:"Methane (CH\u2084)",xyz:"5\nMethane molecule\nC  0.000000  0.000000  0.000000\nH  0.629000  0.629000  0.629000\nH -0.629000 -0.629000  0.629000\nH -0.629000  0.629000 -0.629000\nH  0.629000 -0.629000 -0.629000"},ammonia:{name:"Ammonia (NH\u2083)",xyz:"4\nAmmonia molecule\nN  0.000000  0.000000  0.000000\nH  0.000000  0.950000  0.330000\nH  0.820000 -0.480000  0.330000\nH -0.820000 -0.480000  0.330000"},ethylene:{name:"Ethylene (C\u2082H\u2084)",xyz:"6\nEthylene molecule\nC  0.000000  0.000000  0.668000\nC  0.000000  0.000000 -0.668000\nH  0.000000  0.923000  1.232000\nH  0.000000 -0.923000  1.232000\nH  0.000000  0.923000 -1.232000\nH  0.000000 -0.923000 -1.232000"}},Q=({onFileLoad:e})=>{const[s,a]=(0,t.useState)(""),[n,l]=(0,t.useState)(""),[r,i]=(0,t.useState)(!1),[o,c]=(0,t.useState)("water"),d=(0,t.useRef)(null);(0,t.useEffect)((()=>{const s=K.water;l(s.xyz),a(""),c("water"),e(s.xyz)}),[]);const u=async s=>{const t=s.name.split(".").pop()?.toLowerCase();if("xyz"===t){a(s.name);try{const a=await s.text();l(a),e(a)}catch(n){console.error("Error reading file:",n),alert("Failed to read file: "+n.message)}}else alert("Please upload an XYZ file.")};return(0,Z.jsxs)("div",{className:H,children:[(0,Z.jsxs)("div",{className:z,children:[(0,Z.jsx)("label",{className:I,children:"Example Molecules"}),(0,Z.jsxs)("select",{value:o,onChange:s=>{const t=s.target.value;if(t&&K[t]){const s=K[t];l(s.xyz),a(""),c(t),e(s.xyz),d.current&&(d.current.value="")}},className:B,children:[(0,Z.jsx)("option",{value:"",children:"Select an example..."}),Object.entries(K).map((([e,s])=>(0,Z.jsx)("option",{value:e,children:s.name},e)))]})]}),(0,Z.jsxs)("div",{className:A,children:[(0,Z.jsxs)("div",{className:V,children:[(0,Z.jsx)("span",{className:P,children:"XYZ Coordinates"}),(0,Z.jsxs)("div",{className:G,children:[(0,Z.jsx)("button",{onClick:e=>{e.stopPropagation(),d.current?.click()},className:W,children:"Browse"}),(s||n)&&(0,Z.jsx)("button",{onClick:()=>{a(""),l(""),c(""),d.current&&(d.current.value="")},className:q,children:"Clear"})]})]}),(0,Z.jsxs)("div",{className:`${U} ${r?X:""}`,onDrop:e=>{e.preventDefault(),i(!1);const s=e.dataTransfer.files[0];s&&u(s)},onDragOver:e=>{e.preventDefault(),i(!0)},onDragLeave:()=>{i(!1)},children:[(0,Z.jsx)("textarea",{value:n,onChange:s=>{const t=s.target.value;l(t),t.trim()&&(a(""),c(""),e(t))},placeholder:s?`Loaded: ${s}`:"Select an example molecule above or drag & drop XYZ file here",rows:8,className:Y}),(0,Z.jsx)("input",{ref:d,type:"file",accept:".xyz",onChange:e=>{const s=e.target.files?.[0];s&&u(s)},style:{display:"none"}})]})]})]})},J="section_H6hy",ee="field_rd2A",se=({method:e,setMethod:s,basisSet:a,setBasisSet:t,maxIterations:n,setMaxIterations:l,energyTolerance:r,setEnergyTolerance:i,logLevel:o,setLogLevel:c})=>(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:J,children:[(0,Z.jsx)("h3",{children:"Calculation Method"}),(0,Z.jsxs)("div",{className:ee,children:[(0,Z.jsx)("label",{children:"Theory Level"}),(0,Z.jsxs)("select",{value:e,onChange:e=>s(e.target.value),children:[(0,Z.jsx)("option",{value:"hf",children:"Hartree-Fock (HF)"}),(0,Z.jsx)("option",{value:"dft-b3lyp",children:"DFT (B3LYP)"}),(0,Z.jsx)("option",{value:"dft-pbe",children:"DFT (PBE)"}),(0,Z.jsx)("option",{value:"dft-pbe0",children:"DFT (PBE0)"}),(0,Z.jsx)("option",{value:"dft-blyp",children:"DFT (BLYP)"}),(0,Z.jsx)("option",{value:"dft-wb97x",children:"DFT (\u03c9B97X)"}),(0,Z.jsx)("option",{value:"dft-wb97m",children:"DFT (\u03c9B97M)"}),(0,Z.jsx)("option",{value:"dft-m062x",children:"DFT (M06-2X)"}),(0,Z.jsx)("option",{value:"dft-r2scan",children:"DFT (r\xb2SCAN)"}),(0,Z.jsx)("option",{value:"dft-tpss",children:"DFT (TPSS)"})]})]}),(0,Z.jsxs)("div",{className:ee,children:[(0,Z.jsx)("label",{children:"Basis Set"}),(0,Z.jsxs)("select",{value:a,onChange:e=>t(e.target.value),children:[(0,Z.jsx)("option",{value:"sto-3g",children:"STO-3G"}),(0,Z.jsx)("option",{value:"3-21g",children:"3-21G"}),(0,Z.jsx)("option",{value:"6-31g",children:"6-31G"}),(0,Z.jsx)("option",{value:"6-31g(d,p)",children:"6-31G(d,p)"}),(0,Z.jsx)("option",{value:"6-311g(d,p)",children:"6-311G(d,p)"}),(0,Z.jsx)("option",{value:"def2-svp",children:"def2-SVP"}),(0,Z.jsx)("option",{value:"def2-tzvp",children:"def2-TZVP"}),(0,Z.jsx)("option",{value:"cc-pvdz",children:"cc-pVDZ"}),(0,Z.jsx)("option",{value:"cc-pvtz",children:"cc-pVTZ"}),(0,Z.jsx)("option",{value:"cc-pvqz",children:"cc-pVQZ"}),(0,Z.jsx)("option",{value:"pcseg-0",children:"pc-0"}),(0,Z.jsx)("option",{value:"pcseg-1",children:"pc-1"}),(0,Z.jsx)("option",{value:"pcseg-2",children:"pc-2"}),(0,Z.jsx)("option",{value:"pcseg-3",children:"pc-3"}),(0,Z.jsx)("option",{value:"aug-pcseg-1",children:"aug-pc-1"}),(0,Z.jsx)("option",{value:"aug-pcseg-2",children:"aug-pc-2"})]})]})]}),(0,Z.jsxs)("div",{className:J,children:[(0,Z.jsx)("h3",{children:"SCF Settings"}),(0,Z.jsxs)("div",{className:ee,children:[(0,Z.jsx)("label",{children:"Max Iterations"}),(0,Z.jsx)("input",{type:"number",min:"10",max:"500",value:n,onChange:e=>l(parseInt(e.target.value))})]}),(0,Z.jsxs)("div",{className:ee,children:[(0,Z.jsx)("label",{children:"Energy Tolerance"}),(0,Z.jsxs)("select",{value:r.toString(),onChange:e=>i(parseFloat(e.target.value)),children:[(0,Z.jsx)("option",{value:"1e-6",children:"1e-6"}),(0,Z.jsx)("option",{value:"1e-7",children:"1e-7"}),(0,Z.jsx)("option",{value:"1e-8",children:"1e-8"}),(0,Z.jsx)("option",{value:"1e-9",children:"1e-9"}),(0,Z.jsx)("option",{value:"1e-10",children:"1e-10"})]})]}),(0,Z.jsxs)("div",{className:ee,children:[(0,Z.jsx)("label",{children:"Log Level"}),(0,Z.jsxs)("select",{value:o,onChange:e=>c(parseInt(e.target.value)),children:[(0,Z.jsx)("option",{value:"0",children:"Trace"}),(0,Z.jsx)("option",{value:"1",children:"Debug"}),(0,Z.jsx)("option",{value:"2",children:"Info"}),(0,Z.jsx)("option",{value:"3",children:"Warning"}),(0,Z.jsx)("option",{value:"4",children:"Error"}),(0,Z.jsx)("option",{value:"5",children:"Critical"})]})]})]})]}),ae="container_R89I",te="summaryGrid_ag2i",ne="energyCard_YXOX",le="statusCard_RoU8",re="propertiesCard_AHmH",ie="primaryEnergy_Xokq",oe="secondaryEnergy_Gl5x",ce="propertyItem_grVF",de="exportSection_Tufw",ue="exportButtons_Op6D",me="exportButton_Xvg9",he="energyValues_pzt_",pe="statusInfo_hd1b",xe="convergenceStatus_AYcc",ve="converged_xwWE",je="notConverged_Y8IO",ge="timing_HvIZ",be="propertyList_aAAD",fe="propertyLabel_Acxr",Ne="propertyValue_OR5o",_e="exportButtonDisabled_HPmD",ye="noResults_jWfa",Se=({results:e})=>{if(!e)return(0,Z.jsxs)("div",{className:ye,children:[(0,Z.jsx)("h3",{children:"No Results Yet"}),(0,Z.jsx)("p",{children:"Run a calculation to see results here."})]});const s=s=>{if(!e.wavefunctionData)return;let a,t,n;switch(s){case"fchk":if(!e.wavefunctionData.fchk)return void alert("FCHK data not available.");a=e.wavefunctionData.fchk,t="wavefunction.fchk",n="text/plain";break;case"json":a=JSON.stringify({energy:e.energy,energyInEV:e.energyInEV,properties:e.properties,numBasisFunctions:e.wavefunctionData.numBasisFunctions,numAtoms:e.wavefunctionData.numAtoms,calculationTime:e.elapsedMs},null,2),t="wavefunction.json",n="application/json"}const l=new Blob([a],{type:n}),r=URL.createObjectURL(l),i=document.createElement("a");i.href=r,i.download=t,i.click(),URL.revokeObjectURL(r)};return(0,Z.jsxs)("div",{className:ae,children:[(0,Z.jsxs)("div",{className:te,children:[(0,Z.jsxs)("div",{className:ne,children:[(0,Z.jsx)("h4",{children:"Total Energy"}),(0,Z.jsxs)("div",{className:he,children:[(0,Z.jsxs)("div",{className:ie,children:[e.energy.toFixed(8)," Eh"]}),(0,Z.jsxs)("div",{className:oe,children:[e.energyInEV.toFixed(6)," eV"]})]})]}),(0,Z.jsxs)("div",{className:le,children:[(0,Z.jsx)("h4",{children:"Status"}),(0,Z.jsxs)("div",{className:pe,children:[(0,Z.jsx)("div",{className:`${xe} ${e.converged?ve:je}`,children:e.converged?"\u2713 Converged":"\u2717 Not Converged"}),(0,Z.jsx)("div",{className:ge,children:(a=e.elapsedMs,`${Math.floor(a/1e3)}s ${Math.round(a%1e3)}ms`)})]})]}),e.properties&&(0,Z.jsxs)("div",{className:re,children:[(0,Z.jsx)("h4",{children:"Key Properties"}),(0,Z.jsxs)("div",{className:be,children:[void 0!==e.properties.homo&&(0,Z.jsxs)("div",{className:ce,children:[(0,Z.jsx)("span",{className:fe,children:"HOMO:"}),(0,Z.jsxs)("span",{className:Ne,children:[e.properties.homo.toFixed(6)," Eh"]})]}),void 0!==e.properties.lumo&&(0,Z.jsxs)("div",{className:ce,children:[(0,Z.jsx)("span",{className:fe,children:"LUMO:"}),(0,Z.jsxs)("span",{className:Ne,children:[e.properties.lumo.toFixed(6)," Eh"]})]}),void 0!==e.properties.gap&&(0,Z.jsxs)("div",{className:ce,children:[(0,Z.jsx)("span",{className:fe,children:"Gap:"}),(0,Z.jsxs)("span",{className:Ne,children:[e.properties.gap.toFixed(6)," Eh"]})]})]})]})]}),e.wavefunctionData&&(0,Z.jsxs)("div",{className:de,children:[(0,Z.jsx)("h4",{children:"Export Wavefunction"}),(0,Z.jsxs)("div",{className:ue,children:[(0,Z.jsx)("button",{className:me,onClick:()=>s("json"),children:"\u2193 JSON"}),(0,Z.jsxs)("button",{className:e.wavefunctionData.fchk?me:`${me} ${_e}`,onClick:()=>e.wavefunctionData.fchk?s("fchk"):alert("FCHK data not available. Check the calculation logs for details."),disabled:!e.wavefunctionData.fchk,title:e.wavefunctionData.fchk?"Download FCHK file":"FCHK generation failed - see logs",children:["\u2193 FCHK ",!e.wavefunctionData.fchk&&"(unavailable)"]})]})]})]});var a},Ce={container:"container_BYXD",header:"header_RGzB",controls:"controls_Rvup",button:"button_YEOU",buttonActive:"buttonActive_nb5D",logOutput:"logOutput_RpAa",noLogs:"noLogs_oYTM",logEntry:"logEntry_Oa3L",timestamp:"timestamp__Tyr",message:"message_A8Nt","log-debug":"log-debug_cHxc","log-info":"log-info_Lwm5","log-warn":"log-warn_SwuY","log-error":"log-error_TdP2"},we=({logs:e})=>{const[s,a]=(0,t.useState)(!0),n=(0,t.useRef)(null);(0,t.useEffect)((()=>{s&&n.current&&(n.current.scrollTop=n.current.scrollHeight)}),[e,s]);return(0,Z.jsxs)("div",{className:Ce.container,children:[(0,Z.jsxs)("div",{className:Ce.header,children:[(0,Z.jsx)("h3",{children:"Calculation Output"}),(0,Z.jsx)("div",{className:Ce.controls,children:(0,Z.jsx)("button",{className:`${Ce.button} ${s?Ce.buttonActive:""}`,onClick:()=>a(!s),children:s?"Auto-scroll ON":"Auto-scroll OFF"})})]}),(0,Z.jsx)("div",{ref:n,className:Ce.logOutput,children:0===e.length?(0,Z.jsx)("div",{className:Ce.noLogs,children:"No output yet. Run a calculation to see logs."}):e.map(((e,s)=>{return(0,Z.jsxs)("div",{className:`${Ce.logEntry} ${Ce[`log-${e.level}`]}`,children:[(0,Z.jsxs)("span",{className:Ce.timestamp,children:["[",(a=e.timestamp,a.toLocaleTimeString()),"]"]}),(0,Z.jsx)("span",{className:Ce.message,children:e.message})]},s);var a}))})]})},$e="matrixContainer__RiK",ke="header_t7QL",Fe="controls_sj24",Ee="dimensions_G9Ce",Me="toggleButton_ziSy",Oe="downloadButton_yZ_5",Re="matrixWrapper_lIP_",Le="matrix_UPd_",Te="matrixElement_jLaA",De="infoContent_XCc5",He="fullMatrix_FIje",ze="zeroElement_VjgC",Ie="truncationNotice_Npk0",Be="matrixInfo_AD0u",Ae="infoToggle_sbWR",Ve=({matrix:e,title:s,precision:a=6,maxDisplaySize:n=8})=>{const[l,r]=(0,t.useState)(!1),[i,o]=(0,t.useState)(!1);if(!e||!e.data)return(0,Z.jsxs)("div",{className:$e,children:[(0,Z.jsx)("h4",{children:s}),(0,Z.jsx)("p",{children:"Matrix data not available"})]});const{rows:c,cols:d,data:u}=e,m=c>n||d>n,h=i?c:Math.min(c,n),p=i?d:Math.min(d,n),x=e=>Math.abs(e)<1e-10?"\xb7":e.toFixed(a);return(0,Z.jsxs)("div",{className:$e,children:[(0,Z.jsxs)("div",{className:ke,children:[(0,Z.jsx)("h4",{children:s}),(0,Z.jsxs)("div",{className:Fe,children:[(0,Z.jsxs)("span",{className:Ee,children:[c," \xd7 ",d]}),m&&(0,Z.jsx)("button",{className:Me,onClick:()=>o(!i),children:i?"Show Preview":"Show Full"}),(0,Z.jsx)("button",{className:Oe,onClick:()=>{const e=u.map((e=>e.map((e=>x(e))).join(","))).join("\n"),a=new Blob([e],{type:"text/csv"}),t=URL.createObjectURL(a),n=document.createElement("a");n.href=t,n.download=`${s.toLowerCase().replace(/\s+/g,"_")}_matrix.csv`,n.click(),URL.revokeObjectURL(t)},title:"Download as CSV",children:"\u2193 CSV"})]})]}),(0,Z.jsxs)("div",{className:Re,children:[(0,Z.jsx)("div",{className:`${Le} ${i?He:""}`,style:{gridTemplateColumns:`repeat(${p}, 1fr)`},children:Array.from({length:h},((e,s)=>Array.from({length:p},((e,a)=>{const t=u[s]?.[a]||0,n=x(t),l=Math.abs(t)<1e-10;return(0,Z.jsx)("div",{className:`${Te} ${l?ze:""}`,title:`[${s+1},${a+1}] = ${t}`,children:n},`${s}-${a}`)}))))}),m&&!i&&(0,Z.jsxs)("div",{className:Ie,children:["Showing ",h," \xd7 ",p," of ",c," \xd7 ",d," matrix"]})]}),(0,Z.jsxs)("div",{className:Be,children:[(0,Z.jsxs)("button",{className:Ae,onClick:()=>r(!l),children:[l?"\u25bc":"\u25b6"," Matrix Information"]}),l&&(0,Z.jsxs)("div",{className:De,children:[(0,Z.jsxs)("div",{children:[(0,Z.jsx)("strong",{children:"Dimensions:"})," ",c," rows \xd7 ",d," columns"]}),(0,Z.jsxs)("div",{children:[(0,Z.jsx)("strong",{children:"Total elements:"})," ",c*d]}),u.length>0&&u[0]&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{children:[(0,Z.jsx)("strong",{children:"Max value:"})," ",Math.max(...u.flat()).toFixed(a)]}),(0,Z.jsxs)("div",{children:[(0,Z.jsx)("strong",{children:"Min value:"})," ",Math.min(...u.flat()).toFixed(a)]}),(0,Z.jsxs)("div",{children:[(0,Z.jsx)("strong",{children:"Trace (diagonal sum):"})," ",u.reduce(((e,s,a)=>e+(s[a]||0)),0).toFixed(a)]})]})]})]})]})};var Pe=a(7851);const Ge="container_BTtL",We="header_Zg_R",Ue="controls_krEJ",Xe="controlButton_kE_9",qe="viewer_MOiN",Ye="representationControls_JFkt",Ze="controlGroup_advN",Ke="inlineControlGroup_p0fZ",Qe="controlLabel_p9ac",Je="controlSelect_wf9l",es="checkboxLabel_O6nm",ss="checkbox_vb0q",as="numberInput_NZEF",ts="slicePositionControls_XcJh",ns="collapsibleControl_f2QI",ls="controlToggle_IHht",rs="controlContent_BMT8",is="colorRangeGrid_zP5d",os="computingIndicator_nVPU",cs="mainContent_hmUM",ds="viewerContainer_HOsW",us="orbitalSidebar_Sjw1",ms="open_VSem",hs="orbitalToggleButton_zhVa",ps="orbitalSidebarHeader_sOPI",xs="orbitalCloseButton_PBas",vs="moControls_QuQW",js="collapsibleSection_wCEA",gs="lightSectionHeader_RRMY",bs="chevron_qy2f",fs="chevronExpanded_o9bu",Ns="sectionContent_L8gO",_s="orbitalList_q8AK",ys="placeholder_XAIu",Ss="loading_XCE6",Cs="error_fQgs",ws="orbitalItem_coIp",$s="orbitalOccupied_2McF",ks="orbitalVirtual_y4gy",Fs="orbitalSelected_kMgf",Es="orbitalContent_ff1A",Ms="orbitalEnergy_svnX",Os="orbitalEnergyEV_OrpY",Rs="orbitalLabel_q_Pv",Ls="orbitalIndicators_GNGS",Ts="occupationBadge_DFgd",Ds="orbitalColorIndicator_WBpC",Hs=({orbital:e,isHOMO:s=!1,isLUMO:a=!1,isSelected:t=!1,colorIndicator:n,onClick:l,className:r=""})=>{const i=e.energy/27.2114;return(0,Z.jsxs)("div",{className:`${ws} ${e.isOccupied?$s:ks} ${t?Fs:""} ${r}`,onClick:l,title:`MO ${e.index}: ${e.energy.toFixed(3)} eV (occupation: ${e.occupation})`,style:{cursor:l?"pointer":"default"},children:[(0,Z.jsxs)("div",{className:Es,children:[(0,Z.jsxs)("div",{className:Ms,children:[i.toFixed(6)," Eh"]}),(0,Z.jsxs)("div",{className:Os,children:[e.energy.toFixed(3)," eV"]}),(s||a)&&(0,Z.jsx)("div",{className:Rs,children:s?"HOMO":"LUMO"})]}),(0,Z.jsxs)("div",{className:Ls,children:[e.occupation>0&&(0,Z.jsx)("div",{className:Ts,children:2===e.occupation?"\u2191\u2193":1===e.occupation?"\u2191":""}),n&&(0,Z.jsx)("div",{className:Ds,style:{backgroundColor:n},title:`Plotted in ${n}`})]})]})},zs=({xyzData:e,moleculeName:s="Molecule",wavefunctionResults:a,cubeResults:n,cubeGridInfo:l,onRequestCubeComputation:r})=>{const i=(0,t.useRef)(null),o=(0,t.useRef)(null),c=(0,t.useRef)(null),d=(0,t.useRef)(null),[u,m]=(0,t.useState)(!1),[h,p]=(0,t.useState)(""),[x,v]=(0,t.useState)("ball+stick"),[j,g]=(0,t.useState)(!0),[b,f]=(0,t.useState)("element"),[N,_]=(0,t.useState)(new Set),[y,S]=(0,t.useState)(.01),[C,w]=(0,t.useState)(!1),[$,k]=(0,t.useState)(1),[F,E]=(0,t.useState)(!1),[M,O]=(0,t.useState)(new Map),[R,L]=(0,t.useState)(40),T=(0,t.useRef)(null),[D,H]=(0,t.useState)(!0),[z,I]=(0,t.useState)(!1),B=(0,t.useRef)(null),[A,V]=(0,t.useState)(null),[P,G]=(0,t.useState)("surface"),[W,U]=(0,t.useState)(!1),[X,q]=(0,t.useState)("z"),[Y,K]=(0,t.useState)(0),[Q,J]=(0,t.useState)("rwb"),[ee,se]=(0,t.useState)([0,.05]),[ae,te]=(0,t.useState)(!1);(0,t.useEffect)((()=>{if(!i.current)return;o.current=new Pe.BI(i.current,{backgroundColor:"white",quality:"medium",clipNear:1e-6,clipFar:100,clipDist:10,fogNear:100,fogFar:100});const e=()=>{o.current&&o.current.handleResize()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e),o.current&&o.current.dispose()}}),[]);const ne=()=>{if(!c.current)return;c.current.removeAllRepresentations();const e={colorScheme:b,sele:j?"all":"not hydrogen"};switch(x){case"ball+stick":e.radiusScale=.8,e.bondScale=.3;break;case"line":e.linewidth=2;break;case"spacefill":e.radiusScale=1;break;case"licorice":e.bondScale=.5,e.multipleBond=!0;break;case"surface":e.opacity=.8,e.surfaceType="vws"}c.current.addRepresentation(x,e),o.current?.autoView()};(0,t.useEffect)((()=>{ne()}),[x,j,b]),(0,t.useEffect)((()=>{if(!e||!o.current)return;(async()=>{m(!0),p("");try{o.current.removeAllComponents();const a=((e,s)=>{const a=e.trim().split("\n"),t=parseInt(a[0]),n=a[1]||s,l=[];for(let m=2;m<2+t;m++){const e=a[m].trim().split(/\s+/);l.push({element:e[0],x:parseFloat(e[1]),y:parseFloat(e[2]),z:parseFloat(e[3])})}const r={"H-H":.74,"H-C":1.09,"H-N":1.01,"H-O":.96,"H-S":1.34,"C-C":1.54,"C-N":1.47,"C-O":1.43,"C-S":1.82,"N-N":1.45,"N-O":1.4,"N-S":1.68,"O-O":1.48,"O-S":1.66,"S-S":2.05},i=(e,s)=>{const a=e.x-s.x,t=e.y-s.y,n=e.z-s.z;return Math.sqrt(a*a+t*t+n*n)},o=[];for(let m=0;m<l.length;m++)for(let e=m+1;e<l.length;e++){const s=i(l[m],l[e]),a=r[`${c=l[m].element}-${d=l[e].element}`]||r[`${d}-${c}`]||2;if(s<=1.3*a){let t=1;s<.85*a&&(t=2),s<.75*a&&(t=3),o.push({atom1:m+1,atom2:e+1,order:t})}}var c,d;let u=`${n}\n`;return u+="  Generated from XYZ with bond guessing\n",u+="\n",u+=`${t.toString().padStart(3," ")}${o.length.toString().padStart(3," ")}  0  0  0  0  0  0  0  0999 V2000\n`,l.forEach((e=>{const s=e.x.toFixed(4).padStart(10," "),a=e.y.toFixed(4).padStart(10," "),t=e.z.toFixed(4).padStart(10," ");u+=`${s}${a}${t} ${e.element.padEnd(3," ")} 0  0  0  0  0  0  0  0  0  0  0  0\n`})),o.forEach((e=>{u+=`${e.atom1.toString().padStart(3," ")}${e.atom2.toString().padStart(3," ")}${e.order.toString().padStart(3," ")}  0  0  0  0\n`})),u+="M  END\n$$$$\n",u})(e,s),t=new Blob([a],{type:"text/plain"}),n=await o.current.loadFile(t,{ext:"sdf",name:s});c.current=n,ne(),m(!1)}catch(a){console.error("Error loading molecule:",a),p("Failed to load molecule structure"),m(!1)}})()}),[e,s]);const le=t.useMemo((()=>{if(!a?.orbitalEnergies||!a?.orbitalOccupations)return[];const e=[];for(let s=0;s<a.orbitalEnergies.length;s++){const t=a.orbitalEnergies[s],n=a.orbitalOccupations[s]||0;e.push({index:s,energy:27.2114*t,occupation:n,isOccupied:n>0})}return e}),[a]),re=le;(0,t.useEffect)((()=>{if(le.length>0&&r&&N.size>0){const e=[];for(const s of N){const a=`molecular_orbital_${s}_${R}`,t=n?.get(a);t||e.push(s)}e.length>0&&(T.current&&clearTimeout(T.current),T.current=setTimeout((()=>{ie(e)}),300))}return()=>{T.current&&clearTimeout(T.current)}}),[N,le.length,n,R]);const ie=async e=>{if(r&&o.current){E(!0),p("");try{const s=le.length-1;for(const a of e){if(a<0||a>s)throw new Error(`Invalid orbital index ${a}. Valid range: 0-${s}`);r("molecular_orbital",a,R)}}catch(h){console.error("Error requesting MO computation:",h),p("Failed to request molecular orbital computation: "+h.message),E(!1)}}};(0,t.useEffect)((()=>{if(console.log("MO visualization effect triggered:",{selectedOrbitals:N.size,cubeResults:n.size,orbitalRenderStyle:P,sliceDirection:X,slicePosition:Y}),!o.current)return;if(0===N.size)return void oe();if(!n)return;Array.from(N).every((e=>{const s=`molecular_orbital_${e}_${R}`;return n.get(s)}))&&(oe(),F&&E(!1))}),[n,N,y,C,$,P,X,Y,Q,ee]);const oe=async()=>{var e,s;if(o.current)try{d.current&&(Array.isArray(d.current)?d.current.forEach((e=>{e&&o.current&&o.current.removeComponent(e)})):o.current&&o.current.removeComponent(d.current),d.current=null);const a=[],t=["#4A90E2","#FF8C42","#7B68EE","#32CD32","#FF6B6B","#9B59B6"],l=new Map;if(0===N.size)return d.current=[],O(l),void o.current.autoView();for(const[r,i]of Array.from(N).entries()){const c=`molecular_orbital_${i}_${R}`,d=n?.get(c);if(d){const n=new Blob([d],{type:"text/plain"}),c=await o.current.loadFile(n,{ext:"cube",name:`MO_${i}`});if(c){const n=t[r%t.length];if(l.set(i,n),"surface"===P)c.addRepresentation("surface",{visible:!0,isolevelType:"value",isolevel:y,color:n,opacity:$,opaqueBack:!1}),C&&c.addRepresentation("surface",{visible:!0,isolevelType:"value",isolevel:-y,color:"red",opacity:$,opaqueBack:!1});else if("wireframe"===P)c.addRepresentation("surface",{visible:!0,isolevelType:"value",isolevel:y,color:n,opacity:$,wireframe:!0,linewidth:2}),C&&c.addRepresentation("surface",{visible:!0,isolevelType:"value",isolevel:-y,color:"red",opacity:$,wireframe:!0,linewidth:2});else if("dot"===P)c.addRepresentation("dot",{visible:!0,color:n,opacity:$,dotType:"square",dotSpacing:2,threshold:.001});else if("slice"===P){const a=(e=X,s=Y,console.log(`Slice position: direction=${e}, position=${s}`),s);console.log(`Adding slice representation: direction=${X}, normalizedPos=${Y}, coordinatePos=${a}`),c.addRepresentation("slice",{visible:!0,opacity:$,dimension:X,positionType:"coordinate",position:a,thresholdMin:ee[0],thresholdMax:ee[1],thresholdType:"value",colorScheme:Q,colorDomain:ee})}a.push(c)}}}d.current=a,O(l),o.current.autoView()}catch(h){console.error("Error visualizing molecular orbitals:",h),p("Failed to visualize molecular orbitals: "+h.message)}};return(0,t.useEffect)((()=>{(async()=>{if(!o.current)return;if(B.current&&(o.current.removeComponent(B.current),B.current=null),!z)return;let e=null;if(l){const s=l.origin,a=l.steps,t=l.nx,n=l.ny,r=l.nz,i=l.basis;if(s&&a&&t&&n&&r&&i){const a=[[i[0],i[1],i[2]],[i[3],i[4],i[5]],[i[6],i[7],i[8]]],l=[s[0],s[1],s[2]],o=[s[0]+(t-1)*a[0][0]+(n-1)*a[1][0]+(r-1)*a[2][0],s[1]+(t-1)*a[0][1]+(n-1)*a[1][1]+(r-1)*a[2][1],s[2]+(t-1)*a[0][2]+(n-1)*a[1][2]+(r-1)*a[2][2]],c=.529177;e={min:[l[0]*c,l[1]*c,l[2]*c],max:[o[0]*c,o[1]*c,o[2]*c]},console.log("Grid bounds (converted to Angstrom):",e)}}if(e)try{const[s,a,t]=e.min,[n,l,r]=e.max,i=[[s,a,t],[n,a,t],[n,l,t],[s,l,t],[s,a,r],[n,a,r],[n,l,r],[s,l,r]],c=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];let d=`Grid Bounds\n  Generated\n  \n${i.length.toString().padStart(3," ")}${c.length.toString().padStart(3," ")}  0  0  0  0  0  0  0  0999 V2000\n`;i.forEach((([e,s,a])=>{d+=`${e.toFixed(4).padStart(10," ")}${s.toFixed(4).padStart(10," ")}${a.toFixed(4).padStart(10," ")} C   0  0  0  0  0  0  0  0  0  0  0  0\n`})),c.forEach((([e,s])=>{d+=`${(e+1).toString().padStart(3," ")}${(s+1).toString().padStart(3," ")}  1  0  0  0  0\n`})),d+="M  END\n$$$$\n";const u=new Blob([d],{type:"text/plain"}),m=await o.current.loadFile(u,{ext:"mol",name:"Grid_Bounds"});m&&(m.addRepresentation("line",{colorScheme:"uniform",colorValue:"#ff6b6b",linewidth:2,opacity:.7}),B.current=m)}catch(h){console.error("Error creating grid bounds visualization:",h),p("Failed to create grid bounds visualization: "+h.message)}else console.log("No cube grid info available - cannot show accurate grid bounds")})()}),[z,l]),e?(0,Z.jsxs)("div",{className:Ge,children:[(0,Z.jsxs)("div",{className:We,children:[(0,Z.jsx)("h4",{children:"3D Structure & Molecular Orbitals"}),(0,Z.jsxs)("div",{className:Ue,children:[(0,Z.jsx)("button",{className:Xe,onClick:()=>{o.current&&o.current.autoView()},title:"Reset view",children:"\u2302"}),(0,Z.jsx)("button",{className:Xe,onClick:()=>{o.current&&o.current.toggleFullscreen(i.current)},title:"Toggle fullscreen",children:"\u26f6"})]})]}),(0,Z.jsxs)("div",{className:Ye,children:[(0,Z.jsxs)("div",{className:Ke,children:[(0,Z.jsx)("label",{className:Qe,children:"Style"}),(0,Z.jsxs)("select",{value:x,onChange:e=>v(e.target.value),className:Je,children:[(0,Z.jsx)("option",{value:"ball+stick",children:"Ball & Stick"}),(0,Z.jsx)("option",{value:"line",children:"Line"}),(0,Z.jsx)("option",{value:"spacefill",children:"Space Fill"}),(0,Z.jsx)("option",{value:"licorice",children:"Licorice"}),(0,Z.jsx)("option",{value:"surface",children:"Surface"})]})]}),(0,Z.jsxs)("div",{className:Ke,children:[(0,Z.jsx)("label",{className:Qe,children:"Color"}),(0,Z.jsxs)("select",{value:b,onChange:e=>f(e.target.value),className:Je,children:[(0,Z.jsx)("option",{value:"element",children:"By Element"}),(0,Z.jsx)("option",{value:"uniform",children:"Uniform"}),(0,Z.jsx)("option",{value:"chainname",children:"By Chain"}),(0,Z.jsx)("option",{value:"random",children:"Random"})]})]})]}),(0,Z.jsxs)("div",{className:cs,children:[(0,Z.jsxs)("div",{className:ds,children:[h&&(0,Z.jsx)("div",{className:Cs,children:(0,Z.jsx)("p",{children:h})}),u&&(0,Z.jsx)("div",{className:Ss,children:(0,Z.jsx)("p",{children:"Loading molecule..."})}),(0,Z.jsx)("div",{ref:i,className:qe,style:{opacity:u?.5:1}}),a&&le.length>0&&(0,Z.jsx)("button",{className:hs,onClick:()=>U(!W),children:W?"Hide":"Orbitals"})]}),a&&le.length>0&&(0,Z.jsxs)("div",{className:`${us} ${W?ms:""}`,children:[(0,Z.jsxs)("div",{className:ps,children:[(0,Z.jsx)("h5",{children:"Molecular Orbitals"}),(0,Z.jsx)("button",{className:xs,onClick:()=>U(!1),title:"Close orbital panel",children:"\xd7"})]}),(0,Z.jsxs)("div",{className:js,children:[(0,Z.jsxs)("button",{className:gs,onClick:()=>H(!D),children:[(0,Z.jsx)("span",{children:"Settings"}),(0,Z.jsx)("span",{className:`${bs} ${D?fs:""}`,children:"\u25bc"})]}),D&&(0,Z.jsx)("div",{className:Ns,children:(0,Z.jsxs)("div",{className:vs,children:[(0,Z.jsxs)("div",{className:Ze,children:[(0,Z.jsx)("label",{className:Qe,children:"Style"}),(0,Z.jsxs)("select",{value:P,onChange:e=>G(e.target.value),className:Je,children:[(0,Z.jsx)("option",{value:"surface",children:"Surface"}),(0,Z.jsx)("option",{value:"wireframe",children:"Wireframe"}),(0,Z.jsx)("option",{value:"dot",children:"Dot Volume"}),(0,Z.jsx)("option",{value:"slice",children:"Slice Volume"})]})]}),("surface"===P||"wireframe"===P)&&(0,Z.jsxs)("div",{className:Ze,children:[(0,Z.jsx)("label",{className:Qe,children:"Isovalue"}),(0,Z.jsx)("input",{type:"number",min:"0.001",max:"0.2",step:"0.001",value:y,onChange:e=>S(parseFloat(e.target.value)||.01),className:as})]}),"slice"===P&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:Ze,children:[(0,Z.jsx)("label",{className:Qe,children:"Slice Direction"}),(0,Z.jsxs)("select",{value:X,onChange:e=>q(e.target.value),className:Je,children:[(0,Z.jsx)("option",{value:"x",children:"X-axis"}),(0,Z.jsx)("option",{value:"y",children:"Y-axis"}),(0,Z.jsx)("option",{value:"z",children:"Z-axis"})]})]}),(0,Z.jsxs)("div",{className:Ze,children:[(0,Z.jsx)("label",{className:Qe,children:"Slice Position"}),(0,Z.jsxs)("div",{className:ts,children:[(0,Z.jsx)("button",{onClick:()=>K(Y-.5),className:Xe,title:"Move slice by -0.5",children:"-"}),(0,Z.jsx)("input",{type:"number",step:"0.1",value:Y,onChange:e=>K(parseFloat(e.target.value)||0),className:as,title:"Slice position in Angstroms"}),(0,Z.jsx)("button",{onClick:()=>K(Y+.5),className:Xe,title:"Move slice by +0.5",children:"+"})]})]}),(0,Z.jsxs)("div",{className:ns,children:[(0,Z.jsxs)("button",{className:ls,onClick:()=>te(!ae),children:[(0,Z.jsx)("span",{className:Qe,children:"Color Range"}),(0,Z.jsx)("span",{className:`${bs} ${ae?fs:""}`,children:"\u25bc"})]}),ae&&(0,Z.jsx)("div",{className:rs,children:(0,Z.jsxs)("div",{className:is,children:[(0,Z.jsxs)("div",{className:Ze,children:[(0,Z.jsx)("label",{className:Qe,children:"Minimum"}),(0,Z.jsx)("input",{type:"number",step:"0.01",value:ee[0],onChange:e=>se([parseFloat(e.target.value)||0,ee[1]]),className:as,title:"Minimum value for color scale"})]}),(0,Z.jsxs)("div",{className:Ze,children:[(0,Z.jsx)("label",{className:Qe,children:"Maximum"}),(0,Z.jsx)("input",{type:"number",step:"0.01",value:ee[1],onChange:e=>se([ee[0],parseFloat(e.target.value)||.05]),className:as,title:"Maximum value for color scale"})]})]})})]})]}),(0,Z.jsxs)("div",{className:Ze,children:[(0,Z.jsx)("label",{className:Qe,children:"Opacity"}),(0,Z.jsx)("input",{type:"number",min:"0",max:"1",step:"0.05",value:$,onChange:e=>k(parseFloat(e.target.value)||1),className:as,title:"Orbital surface opacity (0 = transparent, 1 = opaque)"})]}),(0,Z.jsxs)("div",{className:Ze,children:[(0,Z.jsx)("label",{className:Qe,children:"Grid Steps"}),(0,Z.jsx)("input",{type:"number",min:"20",max:"60",step:"5",value:R,onChange:e=>L(parseInt(e.target.value)||40),className:as,title:"Number of grid points per dimension (higher = more detail, slower)"}),l&&(0,Z.jsxs)("label",{className:es,children:[(0,Z.jsx)("input",{type:"checkbox",checked:z,onChange:e=>I(e.target.checked),className:ss}),"Bounds"]})]}),F&&(0,Z.jsx)("div",{className:Ze,children:(0,Z.jsx)("span",{className:os,children:"Computing MO..."})})]})})]}),(0,Z.jsx)("div",{className:_s,children:re.map(((e,s)=>{const a=le.findIndex(((e,s)=>e.isOccupied&&(!le[s+1]||!le[s+1].isOccupied))),t=a>=0?a+1:-1,n=e.index===a,l=e.index===t,r=N.has(e.index),i=M.get(e.index);return(0,Z.jsx)(Hs,{orbital:e,isHOMO:n,isLUMO:l,isSelected:r,colorIndicator:r?i:void 0,onClick:()=>{return s=e.index,void _((e=>{const a=new Set(e);return a.has(s)?a.delete(s):a.add(s),a}));var s}},e.index)}))})]})]})]}):(0,Z.jsx)("div",{className:Ge,children:(0,Z.jsxs)("div",{className:ys,children:[(0,Z.jsx)("h4",{children:"Molecule Viewer"}),(0,Z.jsx)("p",{children:"Load a molecule to see its 3D structure"})]})})},Is=()=>{const[e,s]=(0,t.useState)(null),[n,H]=(0,t.useState)(!1),[z,I]=(0,t.useState)(""),[B,A]=(0,t.useState)(null),[V,P]=(0,t.useState)(!1),[G,W]=(0,t.useState)(null),[U,X]=(0,t.useState)([]),[q,Y]=(0,t.useState)("structure"),[K,J]=(0,t.useState)(""),[ee,ae]=(0,t.useState)(new Map),[te,ne]=(0,t.useState)(null),[le,re]=(0,t.useState)(!0),[ie,oe]=(0,t.useState)(!0),[ce,de]=(0,t.useState)("dft-wb97x"),[ue,me]=(0,t.useState)("6-31g(d,p)"),[he,pe]=(0,t.useState)(100),[xe,ve]=(0,t.useState)(1e-8),[je,ge]=(0,t.useState)(2);(0,t.useEffect)((()=>(be(),()=>{e&&e.terminate()})),[]);const be=async()=>{try{const e=new Worker(new URL(a.p+a.u(842),a.b),{type:void 0});e.onmessage=fe,e.onerror=e=>{console.error("Worker error:",e),J("Worker error: "+e.message),H(!1)},s(e),e.postMessage({type:"init",data:{}})}catch(K){console.error("Failed to initialize worker:",K),J("Failed to initialize Web Worker: "+K.message)}},fe=e=>{const{type:s,...a}=e.data;switch(s){case"initialized":a.success?(H(!0),_e("Worker initialized successfully","info")):(H(!1),J("Worker initialization failed: "+a.error));break;case"log":_e(a.message,Ne(a.level));break;case"progress":_e(a.message,"info"),"complete"===a.stage&&P(!1);break;case"result":ye(a);break;case"cubeResult":Ce(a);break;case"error":console.error("Worker error:",a.error),J("Calculation error: "+a.error),P(!1)}},Ne=e=>{switch(e){case 0:case 1:return"debug";case 2:default:return"info";case 3:return"warn";case 4:case 5:return"error"}},_e=(e,s)=>{X((a=>[...a,{message:e,level:s,timestamp:new Date}]))},ye=e=>{P(!1),e.success?(W(e.results),Y("results"),_e("Calculation completed successfully!","info")):J("Calculation failed: "+e.error)},Ce=e=>{if(e.success){const s="molecular_orbital"===e.cubeType?`${e.cubeType}_${e.orbitalIndex}_${e.gridSteps||40}`:e.cubeType;ae((a=>new Map(a.set(s,e.cubeData)))),e.gridInfo&&ne(e.gridInfo),_e(`Cube computation completed: ${e.cubeType}${void 0!==e.orbitalIndex?` (orbital ${e.orbitalIndex})`:""} [${e.gridSteps||40} steps]`,"info")}else J(`Cube computation failed: ${e.error}`),_e(`Cube computation failed: ${e.error}`,"error")};return(0,Z.jsxs)("div",{className:l,children:[(0,Z.jsxs)("div",{className:r,children:[(0,Z.jsxs)("div",{className:i,children:[(0,Z.jsx)("div",{className:`${g} ${n?f:b}`,children:n?"\u2713 Ready":"\u23f3 Loading..."}),(0,Z.jsxs)("div",{className:m,children:[(0,Z.jsxs)("button",{className:h,onClick:()=>re(!le),children:[(0,Z.jsx)("span",{className:p,children:"Molecule Input"}),(0,Z.jsx)("span",{className:`${x} ${le?j:""}`,children:"\u25bc"})]}),le&&(0,Z.jsxs)("div",{className:v,children:[(0,Z.jsx)(Q,{onFileLoad:e=>{I(e),ae(new Map),W(null);try{const s=e.trim().split("\n"),a=parseInt(s[0]),t=s[1]||"Loaded Molecule",n=new Map;for(let e=2;e<2+a;e++){const a=s[e].trim().split(/\s+/)[0];n.set(a,(n.get(a)||0)+1)}const l=Array.from(n.entries()).map((([e,s])=>s>1?`${e}${s}`:e)).join("");A({name:t,formula:l,numAtoms:a}),_e(`Molecule loaded: ${l} (${a} atoms) - cleared orbital cache`,"info")}catch(K){console.error("Error parsing XYZ:",K),J("Failed to parse XYZ data: "+K.message)}}}),B&&(0,Z.jsx)("div",{className:N,children:(0,Z.jsxs)("div",{children:[(0,Z.jsx)("strong",{children:B.formula})," (",B.numAtoms," atoms)"]})})]})]}),z&&(0,Z.jsxs)("div",{className:m,children:[(0,Z.jsxs)("button",{className:h,onClick:()=>oe(!ie),children:[(0,Z.jsx)("span",{className:p,children:"Calculation Settings"}),(0,Z.jsx)("span",{className:`${x} ${ie?j:""}`,children:"\u25bc"})]}),ie&&(0,Z.jsx)("div",{className:v,children:(0,Z.jsx)(se,{method:ce,setMethod:de,basisSet:ue,setBasisSet:me,maxIterations:he,setMaxIterations:pe,energyTolerance:xe,setEnergyTolerance:ve,logLevel:je,setLogLevel:ge})})]}),z&&(0,Z.jsxs)("div",{className:y,children:[(0,Z.jsx)("button",{className:`${_} ${S}`,onClick:()=>{if(!z)return void J("Please load a molecule first.");if(!e||!n)return void J("Web Worker not ready.");W(null),X([]),Y("output"),P(!0),e.postMessage({type:"setLogLevel",data:{level:je}});const s={xyzData:z,method:ce,basisSet:ue,maxIterations:he,energyTolerance:xe};_e("Starting calculation...","info"),e.postMessage({type:"calculate",data:s})},disabled:V||!n,children:V?"Calculating...":"Run Calculation"}),V&&(0,Z.jsx)("button",{className:`${_} ${C}`,onClick:()=>{e&&V&&(e.terminate(),_e("Calculation cancelled. Restarting worker...","warn"),be(),P(!1))},children:"Cancel"})]})]}),(0,Z.jsxs)("div",{className:o,children:[z&&(0,Z.jsxs)("div",{className:c,children:[(0,Z.jsx)("button",{className:`${d} ${"output"===q?w:""}`,onClick:()=>Y("output"),children:"Output"}),(0,Z.jsx)("button",{className:`${d} ${"results"===q?w:""}`,onClick:()=>Y("results"),children:"Results"}),(0,Z.jsx)("button",{className:`${d} ${"structure"===q?w:""}`,onClick:()=>Y("structure"),children:"Structure"}),(0,Z.jsx)("button",{className:`${d} ${"properties"===q?w:""}`,onClick:()=>Y("properties"),children:"Properties"})]}),(0,Z.jsxs)("div",{className:u,children:["output"===q&&(0,Z.jsx)(we,{logs:U}),"results"===q&&(0,Z.jsx)(Se,{results:G}),"structure"===q&&(0,Z.jsx)("div",{className:k,children:z?(0,Z.jsx)(zs,{xyzData:z,moleculeName:B?.name||"Molecule",wavefunctionResults:G,cubeResults:ee,cubeGridInfo:te,onRequestCubeComputation:(s,a,t)=>{e&&n?G&&G.wavefunctionData?(_e(`Requesting ${s} cube computation...`,"info"),e.postMessage({type:"computeCube",data:{cubeType:s,orbitalIndex:a,gridSteps:t||40}})):J("No wavefunction data available for cube computation."):J("Web Worker not ready for cube computation.")}}):(0,Z.jsxs)("div",{className:F,children:[(0,Z.jsx)("h3",{children:"No Structure Loaded"}),(0,Z.jsx)("p",{children:"Load a molecule to see its 3D structure visualization."})]})}),"properties"===q&&G&&(0,Z.jsxs)("div",{className:$,children:[G.orbitalEnergies&&G.orbitalEnergies.length>0&&(0,Z.jsxs)("div",{className:O,children:[(0,Z.jsx)("h4",{children:"Orbital Energies"}),(0,Z.jsx)("div",{className:R,children:G.orbitalEnergies.slice(0,20).map(((e,s)=>{const a=G.orbitalOccupations?.[s]??0,t={index:s,energy:27.2114*e,occupation:a,isOccupied:a>0};return(0,Z.jsx)(Hs,{orbital:t},s)}))}),G.orbitalEnergies.length>20&&(0,Z.jsxs)("div",{className:L,children:["... and ",G.orbitalEnergies.length-20," more orbitals"]})]}),G.matrices&&Object.keys(G.matrices).length>0?(0,Z.jsx)("div",{className:E,children:Object.entries(G.matrices).map((([e,s])=>s?(0,Z.jsx)(Ve,{matrix:s,title:`${e.charAt(0).toUpperCase()}${e.slice(1)} Matrix`,precision:6,maxDisplaySize:6},e):null))}):(0,Z.jsx)("div",{className:M,children:(0,Z.jsx)("p",{children:"No matrix data available. Matrices are generated during SCF calculations and may depend on the calculation method and settings."})})]})]})]})]}),K&&(0,Z.jsx)("div",{className:T,children:(0,Z.jsxs)("div",{className:D,children:[(0,Z.jsx)("h3",{children:"Error"}),(0,Z.jsx)("p",{children:K}),(0,Z.jsx)("button",{onClick:()=>J(""),children:"Close"})]})})]})};function Bs(){return(0,Z.jsx)(n.A,{title:"Wavefunction Calculator",description:"Quantum Chemistry Calculations in Your Browser",children:(0,Z.jsx)("main",{style:{minHeight:"calc(100vh - 60px)"},children:(0,Z.jsx)(Is,{})})})}}}]);