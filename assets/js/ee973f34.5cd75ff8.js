"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[979],{643:(e,t,r)=>{r.d(t,{A:()=>n});const n={lead:"lead_kUWS",card:"card_KBDS",card__body:"card__body_nIS1",row:"row_cPIp",utilityPage:"utilityPage_jfjb",container:"container_W1LS",mainLayout:"mainLayout_Vq2n",leftColumn:"leftColumn_RKh5",rightColumn:"rightColumn_SRw5",inputSection:"inputSection_vYbF",dragOver:"dragOver_FKFh",trajectoryInput:"trajectoryInput_BWnR",fileControls:"fileControls_RnoX",dragHint:"dragHint_oLc8",inputControls:"inputControls_do9o",errorMessage:"errorMessage_xmAz",formatHelp:"formatHelp_SSdV",formatExample:"formatExample_XLQ0",formatNote:"formatNote_LyvY",placeholderViewer:"placeholderViewer_pXBD",placeholderContent:"placeholderContent_LY28"}},5998:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var n=r(6540),a=r(1656),s=r(643),l=r(6370),c=r(4848);const o=function(){const[e,t]=(0,n.useState)(""),[r,o]=(0,n.useState)(""),[i,u]=(0,n.useState)(!1),d=(0,n.useRef)(null),m="3\nStep 0 Energy=-75.576566960\nO     0.000000     0.000000     0.000000\nH     0.900000     0.000000     0.000000\nH    -0.300000     0.850000     0.000000\n3\nStep 1 Energy=-75.584772914\nO    -0.007706    -0.010230     0.000000\nH     0.934579    -0.016478     0.000000\nH    -0.326873     0.876708     0.000000\n3\nStep 2 Energy=-75.585838726\nO    -0.014077    -0.019071     0.000000\nH     0.946513    -0.018211     0.000000\nH    -0.332435     0.887282     0.000000\n3\nStep 3 Energy=-75.585944869\nO    -0.017729    -0.024187     0.000000\nH     0.948447    -0.015719     0.000000\nH    -0.330718     0.889906     0.000000\n3\nStep 4 Energy=-75.585957726\nO    -0.019253    -0.026339     0.000000\nH     0.947775    -0.013628     0.000000\nH    -0.328522     0.889966     0.000000\n3\nStep 5 Energy=-75.585959662\nO    -0.019726    -0.027015     0.000000\nH     0.947039    -0.012603     0.000000\nH    -0.327313     0.889618     0.000000\n3\nStep 6 Energy=-75.585959757\nO    -0.019728    -0.027022     0.000000\nH     0.946851    -0.012467     0.000000\nH    -0.327123     0.889489     0.000000",p=e=>{const r=new FileReader;r.onload=e=>{const r=e.target?.result;t(r)},r.onerror=()=>{o("Failed to read file")},r.readAsText(e)};return(0,c.jsx)(a.A,{title:"XYZ Trajectory Viewer",description:"Visualize molecular trajectories",children:(0,c.jsx)("main",{className:s.A.utilityPage,children:(0,c.jsxs)("div",{className:s.A.container,children:[(0,c.jsx)("h1",{children:"XYZ Trajectory Viewer"}),(0,c.jsx)("p",{children:"Visualize molecular trajectories and dynamics from multi-frame XYZ data using NGL's trajectory capabilities."}),(0,c.jsxs)("div",{className:s.A.mainLayout,children:[(0,c.jsx)("div",{className:s.A.leftColumn,children:(0,c.jsxs)("div",{className:`${s.A.inputSection} ${i?s.A.dragOver:""}`,onDragOver:e=>{e.preventDefault(),u(!0)},onDragLeave:e=>{e.preventDefault(),u(!1)},onDrop:e=>{e.preventDefault(),u(!1);const t=e.dataTransfer.files;if(t.length>0){const e=t[0];p(e)}},children:[(0,c.jsx)("h3",{children:"XYZ Trajectory Input"}),(0,c.jsx)("input",{ref:d,type:"file",accept:".xyz,.txt",onChange:e=>{const t=e.target.files?.[0];t&&p(t)},style:{display:"none"}}),(0,c.jsxs)("div",{className:s.A.fileControls,children:[(0,c.jsx)("button",{onClick:()=>{d.current?.click()},className:"button button--primary button--sm",children:"Open File"}),(0,c.jsx)("span",{className:s.A.dragHint,children:"or drag & drop XYZ file here"})]}),(0,c.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),placeholder:"Paste multi-frame XYZ data here or drag & drop a file...",className:s.A.trajectoryInput}),(0,c.jsxs)("div",{className:s.A.inputControls,children:[(0,c.jsx)("button",{onClick:()=>t(m),className:"button button--primary button--sm",children:"Load Example"}),(0,c.jsx)("button",{onClick:()=>t(""),className:"button button--outline button--sm",children:"Clear"})]}),r&&(0,c.jsx)("div",{className:s.A.errorMessage,children:r}),(0,c.jsxs)("div",{className:s.A.formatHelp,children:[(0,c.jsx)("h4",{children:"Format Guide"}),(0,c.jsx)("pre",{className:s.A.formatExample,children:"3\nFrame 1\nO  0.000  0.000  0.000\nH  0.757  0.586  0.000\nH -0.757  0.586  0.000\n3\nFrame 2\nO  0.000  0.000  0.010\n..."}),(0,c.jsx)("p",{className:s.A.formatNote,children:"Each frame: atom count \u2192 comment \u2192 coordinates"})]})]})}),(0,c.jsx)("div",{className:s.A.rightColumn,children:e.trim()&&!r?(0,c.jsx)(l.A,{trajectoryData:e,moleculeName:"XYZ Trajectory",autoPlay:!1}):(0,c.jsx)("div",{className:s.A.placeholderViewer,children:(0,c.jsxs)("div",{className:s.A.placeholderContent,children:[(0,c.jsx)("h3",{children:"Trajectory Viewer"}),(0,c.jsx)("p",{children:"Load XYZ trajectory data to visualize molecular dynamics"}),(0,c.jsx)("button",{onClick:()=>t(m),className:"button button--primary",children:"Try Example"})]})})})]})]})})})}},6370:(e,t,r)=>{r.d(t,{A:()=>I});var n=r(6540),a=r(7851);const s="container_kZ5w",l="header_HEr1",c="controls_ixvO",o="controlButton_GDgO",i="viewer_WviD",u="loadingOverlay_lwCV",d="errorOverlay_rmFC",m="loadingSpinner_PLZ5",p="errorMessage_qkbu",h="frameInfoOverlay_vX3K",y="frameNumber_EMUy",j="frameComment_F9wg",f="frameEnergy_RPyN",v="displayControlsOverlay_fIES",g="overlayControls_EEtd",x="overlayControlGroup_E9WC",N="overlayLabel_tcBl",S="overlaySelect_UZvO",b="overlayCheckbox_jtWY",C="overlaySlider_ifAA",_="overlayValue_f7JJ",E="trajectoryControls_t0nZ",w="compactControls_H6OY",k="frameControls_R8UR",A="playerControls_ukm9",F="playerButton_Mfw8",H="playPauseButton_PlTX",L="frameSlider_B4ss";var O=r(4848);const I=({trajectoryData:e,xyzFrames:t,moleculeName:r="Trajectory",autoPlay:I=!1,initialSpeed:R=100})=>{const D=(0,n.useRef)(null),M=(0,n.useRef)(null),T=(0,n.useRef)(null),$=(0,n.useRef)(null),V=(0,n.useRef)(null),[P,B]=(0,n.useState)(!1),[X,Y]=(0,n.useState)(""),[Z,z]=(0,n.useState)(0),[W,G]=(0,n.useState)(0),[K,U]=(0,n.useState)(!1),[q,J]=(0,n.useState)(30),[Q,ee]=(0,n.useState)("ball+stick"),[te,re]=(0,n.useState)(!0),[ne,ae]=(0,n.useState)("element"),[se,le]=(0,n.useState)([]),[ce,oe]=(0,n.useState)([]),[ie,ue]=(0,n.useState)(null),[de,me]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(!D.current)return;M.current=new a.BI(D.current,{backgroundColor:"white",quality:"medium",clipNear:1e-6,clipFar:100,clipDist:10});const e=()=>{M.current&&M.current.handleResize()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e),M.current&&M.current.dispose()}}),[]);const pe=e=>{if(e.includes("cm\u207b\xb9")||e.includes("cm-1")||e.toLowerCase().includes("mode"))return null;const t=[/Energy\s*=\s*(-?\d+\.?\d*)/i,/E\s*=\s*(-?\d+\.?\d*)/i,/E\s+(-?\d+\.?\d*)/i,/energy:\s*(-?\d+\.?\d*)/i,/(-?\d+\.\d+)\s*(?:hartree|ha|au)/i];for(const r of t){const t=e.match(r);if(t){const e=parseFloat(t[1]);if(!isNaN(e))return e}}return null},he=async e=>{if(M.current){B(!0),Y("");try{M.current.removeAllComponents(),$.current=null,V.current=null;const t=(e=>{let t="";return e.forEach(((e,r)=>{t+=`MODEL     ${(r+1).toString().padStart(4," ")}\n`;const n=e.trim().split("\n"),a=parseInt(n[0]);for(let s=0;s<a;s++){const e=n[s+2].trim().split(/\s+/),r=e[0],a=parseFloat(e[1]),l=parseFloat(e[2]),c=parseFloat(e[3]),o=(s+1).toString().padStart(5," "),i=r.padEnd(4," "),u="MOL",d="A",m="1".padStart(4," "),p=a.toFixed(3).padStart(8," "),h=l.toFixed(3).padStart(8," "),y=c.toFixed(3).padStart(8," "),j="1.00".padStart(6," "),f="0.00".padStart(6," "),v=r.padStart(2," ");t+=`ATOM  ${o} ${i} ${u} ${d}${m}    ${p}${h}${y}${j}${f}          ${v}\n`}t+="ENDMDL\n"})),t+="END\n",t})(e),n=new Blob([t],{type:"text/plain"}),a=await M.current.loadFile(n,{ext:"pdb",name:r,asTrajectory:!0});T.current=a,G(e.length),ye();const s=a.addTrajectory();if($.current=s,s.trajectory&&s.trajectory.player){const e=s.trajectory.player;V.current=e;const t=Math.round(1e3/q);e.parameters&&(e.parameters.timeout=t,e.parameters.mode="loop",e.parameters.step=1,e.parameters.direction="forward"),e.signals&&(e.signals.startedRunning&&e.signals.startedRunning.add((()=>{U(!0)})),e.signals.haltedRunning&&e.signals.haltedRunning.add((()=>{U(!1)})))}s.trajectory&&s.trajectory.signals&&s.trajectory.signals.frameChanged&&s.trajectory.signals.frameChanged.add((e=>{z(e)})),M.current.autoView(),I&&V.current&&setTimeout((()=>V.current.play()),500),B(!1)}catch(t){console.error("Error loading trajectory:",t),Y(`Failed to load trajectory: ${t.message}`),B(!1)}}},ye=()=>{if(!T.current)return;T.current.removeAllRepresentations();const e={colorScheme:ne,sele:te?"all":"not hydrogen"};switch(Q){case"ball+stick":e.radiusScale=.8,e.bondScale=.3;break;case"line":e.linewidth=2;break;case"spacefill":e.radiusScale=1;break;case"licorice":e.bondScale=.5,e.multipleBond=!0}T.current.addRepresentation(Q,e),M.current?.autoView()};(0,n.useEffect)((()=>{const r=()=>{if(V.current)if("function"==typeof V.current.pause)try{V.current.pause()}catch(e){}else V.current.intervalId&&clearInterval(V.current.intervalId);U(!1)};if(e){const t=(e=>{const t=e.trim().split("\n"),r=[],n=[],a=[];let s=0;for(;s<t.length;){const e=parseInt(t[s]);if(isNaN(e)){s++;continue}const l=t.slice(s,s+e+2);r.push(l.join("\n"));const c=t[s+1]||"";a.push(c);const o=pe(c);console.log(`Comment: "${c}" -> Energy: ${o}`),n.push(o),s+=e+2}console.log("Parsed energies:",n),console.log("Comments:",a),le(n),oe(a);const l=n.filter((e=>null!==e));return console.log("Valid energies:",l),l.length>0?(ue(Math.min(...l)),console.log("Set minEnergy to:",Math.min(...l))):(ue(null),console.log("Set minEnergy to: null")),r})(e);t.length>0&&(r(),setTimeout((()=>he(t)),50))}else t&&t.length>0&&(r(),setTimeout((()=>he(t)),50));return r}),[e,t]),(0,n.useEffect)((()=>{ye()}),[Q,te,ne]);const je=()=>{if(V.current&&"function"==typeof V.current.play)V.current.play();else if($.current&&$.current.trajectory&&W>1){U(!0);let e=Z;const t=setInterval((()=>{try{$.current&&$.current.trajectory?(e=(e+1)%W,$.current.trajectory.setFrame(e),z(e)):(clearInterval(t),U(!1))}catch(r){console.warn("Trajectory disposed during playback, stopping:",r.message),clearInterval(t),U(!1)}}),Math.round(1e3/q));V.current={intervalId:t}}},fe=()=>{V.current&&("function"==typeof V.current.pause?V.current.pause():V.current.intervalId&&(clearInterval(V.current.intervalId),V.current=null)),U(!1)},ve=e=>{try{$.current&&$.current.trajectory&&$.current.trajectory.setFrame(e)}catch(t){console.warn("Cannot set frame on disposed trajectory:",t.message)}};return(0,n.useEffect)((()=>{const e=e=>{if(!(W<=1||e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLSelectElement))switch(e.code){case"Space":e.preventDefault(),K?fe():je();break;case"ArrowLeft":e.preventDefault(),ve(Math.max(0,Z-1));break;case"ArrowRight":e.preventDefault(),ve(Math.min(W-1,Z+1));break;case"Home":e.preventDefault(),ve(0);break;case"End":e.preventDefault(),ve(W-1)}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[W,Z,K]),(0,O.jsxs)("div",{className:s,children:[(0,O.jsxs)("div",{className:l,children:[(0,O.jsx)("h4",{children:r}),(0,O.jsxs)("div",{className:c,children:[(0,O.jsx)("button",{onClick:()=>me(!de),className:o,title:"Toggle display options",children:"Options"}),(0,O.jsx)("button",{onClick:()=>{M.current&&M.current.autoView(1e3)},className:o,children:"Reset View"}),(0,O.jsx)("button",{onClick:()=>{M.current&&M.current.toggleFullscreen(D.current)},className:o,children:"Fullscreen"})]})]}),(0,O.jsxs)("div",{className:i,ref:D,children:[P&&(0,O.jsx)("div",{className:u,children:(0,O.jsx)("div",{className:m,children:"Loading trajectory..."})}),X&&(0,O.jsx)("div",{className:d,children:(0,O.jsx)("div",{className:p,children:X})}),W>0&&(0,O.jsxs)("div",{className:h,children:[(0,O.jsxs)("div",{className:y,children:["Frame ",Z+1,"/",W]}),ce[Z]&&(0,O.jsx)("div",{className:j,children:ce[Z]}),(console.log("Energy display check:",{currentFrameEnergy:se[Z],minEnergy:ie,shouldShow:null!==se[Z]&&void 0!==se[Z]&&null!==ie}),null!==se[Z]&&void 0!==se[Z]&&null!==ie&&(0,O.jsx)("div",{className:f,children:(()=>{const e=se[Z]-ie;return`${e>=0?"+":""}${(2625.5*e).toFixed(2)} kJ/mol`})()}))]}),de&&(0,O.jsx)("div",{className:v,children:(0,O.jsxs)("div",{className:g,children:[(0,O.jsxs)("div",{className:x,children:[(0,O.jsx)("label",{className:N,children:"Style:"}),(0,O.jsxs)("select",{value:Q,onChange:e=>ee(e.target.value),className:S,children:[(0,O.jsx)("option",{value:"ball+stick",children:"Ball & Stick"}),(0,O.jsx)("option",{value:"line",children:"Line"}),(0,O.jsx)("option",{value:"spacefill",children:"Spacefill"}),(0,O.jsx)("option",{value:"licorice",children:"Licorice"}),(0,O.jsx)("option",{value:"cartoon",children:"Cartoon"})]})]}),(0,O.jsxs)("div",{className:x,children:[(0,O.jsx)("label",{className:N,children:"Color:"}),(0,O.jsxs)("select",{value:ne,onChange:e=>ae(e.target.value),className:S,children:[(0,O.jsx)("option",{value:"element",children:"Element"}),(0,O.jsx)("option",{value:"chainname",children:"Chain"}),(0,O.jsx)("option",{value:"residueindex",children:"Residue"}),(0,O.jsx)("option",{value:"bfactor",children:"B-factor"})]})]}),(0,O.jsxs)("div",{className:x,children:[(0,O.jsx)("input",{type:"checkbox",checked:te,onChange:e=>re(e.target.checked),id:"showH-overlay",className:b}),(0,O.jsx)("label",{htmlFor:"showH-overlay",className:N,children:"Show Hydrogens"})]}),(0,O.jsxs)("div",{className:x,children:[(0,O.jsx)("label",{className:N,children:"FPS:"}),(0,O.jsx)("input",{type:"range",min:"10",max:"60",step:"5",value:q,onChange:e=>(e=>{if(J(e),V.current&&V.current.parameters){const t=Math.round(1e3/e);V.current.parameters.timeout=t,K&&"function"==typeof V.current.pause&&"function"==typeof V.current.play&&(V.current.pause(),V.current.play())}})(parseInt(e.target.value)),className:C}),(0,O.jsx)("span",{className:_,children:q})]})]})})]}),W>1&&(0,O.jsx)("div",{className:E,children:(0,O.jsxs)("div",{className:w,children:[(0,O.jsxs)("div",{className:A,children:[(0,O.jsx)("button",{onClick:()=>ve(Math.max(0,Z-1)),className:F,disabled:0===Z,title:"Previous frame",children:"\u23ee"}),(0,O.jsx)("button",{onClick:K?fe:je,className:`${F} ${H}`,title:K?"Pause":"Play",children:K?"\u23f8":"\u23f5"}),(0,O.jsx)("button",{onClick:()=>ve(Math.min(W-1,Z+1)),className:F,disabled:Z===W-1,title:"Next frame",children:"\u23ed"})]}),(0,O.jsx)("div",{className:k,children:(0,O.jsx)("input",{type:"range",min:"0",max:W-1,value:Z,onChange:e=>ve(parseInt(e.target.value)),className:L})})]})})]})}}}]);